<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Gecode: gecode/search/cpprofiler/connector.hpp (Revision: 16525) Source File</title>
<link href="stylesheet.css" rel="stylesheet" type="text/css">
<!--[if IE]><style type="text/css">
  @media screen {
    html, body {
      height: 100%; overflow-y: hidden;
      background:#FFFFFF url(back.png) repeat-y;
      font-family:Arial,Helvetica,sans-serif;
      color:#000000;
      margin:0;
      padding:0;
    }
    #scrollable {
      height: 100%; width: 100%; overflow: auto;
    }
  }
</style><![endif]-->
</head>

<body>

<div id="logo">
<img src='gecode-logo-100.png' alt="Gecode logo" /></div>

<div id="navigation">
  <div id="navigation2">
    <a class="navigation" href="index.html">main page</a>
    <a class="navigation" href="modules.html">modules</a>
    <a class="navigation" href="namespaces.html">namespaces</a>
    <a class="navigation" href="annotated.html">classes</a>
    <a class="navigation" href="files.html">files</a>
    <br>
    <a class="navigation" href="http://www.gecode.org/index.html">Gecode home</a>
<form action="search.php" method="get"><a class="navigation" title="Search for keywords in the entire documentation">search&nbsp;for&nbsp;<input type="text" name="query" value="" size="20" accesskey="s"/></a></form>
    </div>
</div>

<div id="footline">
<address style="text-align: right;"><small>
Generated on Wed Feb 7 10:28:09 2018 for Gecode by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.3</small></address>
</div>

  <script type="text/javascript">
    function showInfo(i, show) {
      var moreinfo = "moreinfo"+i;
      var morelink = "morelink"+i;
      var lesslink = "lesslink"+i;
      var linkstyle = "inline";
      var infostyle = "block";
      if (show) {
        document.getElementById(lesslink).style.display="none";
        document.getElementById(morelink).style.display=linkstyle;
        document.getElementById(moreinfo).style.display=infostyle;
      } else {
        document.getElementById(lesslink).style.display=linkstyle;
        document.getElementById(morelink).style.display="none";
        document.getElementById(moreinfo).style.display="none";
      }
    }
  </script>


<div id="scrollable">
<div id="content">
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
  <div class="navpath"><a class="el" href="dir_8592da5f960010ec8921bf6752045e3d.html">gecode</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_e864eedd42ebeb29d0b8fbc9841c804d.html">search</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_c71a7daf9f3b4e02510e48480c2d9a43.html">cpprofiler</a>
  </div>
<div class="contents">
<h1>connector.hpp</h1><a href="connector_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* -*- mode: C++; c-basic-offset: 2; indent-tabs-mode: nil -*- */</span>
<a name="l00002"></a>00002 <span class="comment">/*</span>
<a name="l00003"></a>00003 <span class="comment"> *  Main authors:</span>
<a name="l00004"></a>00004 <span class="comment"> *     Maxim Shishmarev &lt;maxim.shishmarev@monash.edu&gt;</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> *  Contributing authors:</span>
<a name="l00007"></a>00007 <span class="comment"> *     Kevin Leo &lt;kevin.leo@monash.edu&gt;</span>
<a name="l00008"></a>00008 <span class="comment"> *     Christian Schulte &lt;schulte@gecode.org&gt;</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> *  Copyright:</span>
<a name="l00011"></a>00011 <span class="comment"> *     Kevin Leo, 2017</span>
<a name="l00012"></a>00012 <span class="comment"> *     Christian Schulte, 2017</span>
<a name="l00013"></a>00013 <span class="comment"> *     Maxim Shishmarev, 2017</span>
<a name="l00014"></a>00014 <span class="comment"> *</span>
<a name="l00015"></a>00015 <span class="comment"> *  Last modified:</span>
<a name="l00016"></a>00016 <span class="comment"> *     $Date: 2017-11-06 15:23:38 +0100 (Mon, 06 Nov 2017) $ by $Author: schulte $</span>
<a name="l00017"></a>00017 <span class="comment"> *     $Revision: 16525 $</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> *  This file is part of Gecode, the generic constraint</span>
<a name="l00020"></a>00020 <span class="comment"> *  development environment:</span>
<a name="l00021"></a>00021 <span class="comment"> *     http://www.gecode.org</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> *  Permission is hereby granted, free of charge, to any person obtaining</span>
<a name="l00024"></a>00024 <span class="comment"> *  a copy of this software and associated documentation files (the</span>
<a name="l00025"></a>00025 <span class="comment"> *  &quot;Software&quot;), to deal in the Software without restriction, including</span>
<a name="l00026"></a>00026 <span class="comment"> *  without limitation the rights to use, copy, modify, merge, publish,</span>
<a name="l00027"></a>00027 <span class="comment"> *  distribute, sublicense, and/or sell copies of the Software, and to</span>
<a name="l00028"></a>00028 <span class="comment"> *  permit persons to whom the Software is furnished to do so, subject to</span>
<a name="l00029"></a>00029 <span class="comment"> *  the following conditions:</span>
<a name="l00030"></a>00030 <span class="comment"> *</span>
<a name="l00031"></a>00031 <span class="comment"> *  The above copyright notice and this permission notice shall be</span>
<a name="l00032"></a>00032 <span class="comment"> *  included in all copies or substantial portions of the Software.</span>
<a name="l00033"></a>00033 <span class="comment"> *</span>
<a name="l00034"></a>00034 <span class="comment"> *  THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,</span>
<a name="l00035"></a>00035 <span class="comment"> *  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span>
<a name="l00036"></a>00036 <span class="comment"> *  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</span>
<a name="l00037"></a>00037 <span class="comment"> *  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE</span>
<a name="l00038"></a>00038 <span class="comment"> *  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION</span>
<a name="l00039"></a>00039 <span class="comment"> *  OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION</span>
<a name="l00040"></a>00040 <span class="comment"> *  WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span>
<a name="l00041"></a>00041 <span class="comment"> *</span>
<a name="l00042"></a>00042 <span class="comment"> */</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;cstring&gt;</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;winsock2.h&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;ws2tcpip.h&gt;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#pragma comment(lib, &quot;Ws2_32.lib&quot;)</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span><span class="preprocessor">#pragma comment(lib, &quot;Mswsock.lib&quot;)</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span><span class="preprocessor">#pragma comment(lib, &quot;AdvApi32.lib&quot;)</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &lt;basetsd.h&gt;</span>
<a name="l00058"></a>00058 <span class="keyword">typedef</span> SSIZE_T ssize_t;
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="preprocessor">#else</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &lt;netdb.h&gt;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &lt;unistd.h&gt;</span>
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="preprocessor">#endif</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>
<a name="l00067"></a><a class="code" href="namespaceGecode_1_1CPProfiler.html">00067</a> <span class="keyword">namespace </span>Gecode { <span class="keyword">namespace </span>CPProfiler {
<a name="l00068"></a>00068 
<a name="l00069"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">00069</a>   <span class="keyword">class </span><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a> {
<a name="l00070"></a>00070     <a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a> node_;
<a name="l00071"></a>00071     <a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a> parent_;
<a name="l00072"></a>00072     <span class="keywordtype">int</span> alt_;
<a name="l00073"></a>00073     <span class="keywordtype">int</span> kids_;
<a name="l00074"></a>00074     
<a name="l00075"></a>00075     <a class="code" href="namespaceGecode_1_1CPProfiler.html#a6cd5b4d4e96714b0341a9640b0fda3c5" title="Types of nodes for CP Profiler.">NodeStatus</a> status_;
<a name="l00076"></a>00076     
<a name="l00077"></a>00077     <a class="code" href="classGecode_1_1CPProfiler_1_1Option.html">Option&lt;std::string&gt;</a> label_;
<a name="l00078"></a>00078     <a class="code" href="classGecode_1_1CPProfiler_1_1Option.html">Option&lt;std::string&gt;</a> nogood_;
<a name="l00079"></a>00079     <a class="code" href="classGecode_1_1CPProfiler_1_1Option.html">Option&lt;std::string&gt;</a> info_;
<a name="l00080"></a>00080     
<a name="l00081"></a>00081   <span class="keyword">public</span>:
<a name="l00082"></a>00082     <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a4f53d0842ea430e1a8998da3e3cee763">Node</a>(<a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a> node, <a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a> parent,
<a name="l00083"></a>00083          <span class="keywordtype">int</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a15f60486ee85c2b02c213dae539850ac">alt</a>, <span class="keywordtype">int</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a7e92b7d3ac501fa41e03f6024391553c">kids</a>, <a class="code" href="namespaceGecode_1_1CPProfiler.html#a6cd5b4d4e96714b0341a9640b0fda3c5" title="Types of nodes for CP Profiler.">NodeStatus</a> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#aa960f71055a9941763b477a7a12cb122">status</a>);
<a name="l00084"></a>00084     <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a>&amp; <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#acfa127737b78dbb38fc2220b9c13a9ed">set_node_thread_id</a>(<span class="keywordtype">int</span> tid);
<a name="l00085"></a>00085     <span class="keyword">const</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Option.html">Option&lt;std::string&gt;</a>&amp; <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a2c1c1a36a834712d320d10fbf2023272">label</a>() <span class="keyword">const</span>;
<a name="l00086"></a>00086     <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a>&amp; <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#ae9d3fdd3ae16d0d9ea78c924ad29923b">set_label</a>(<span class="keyword">const</span> std::string&amp; label);
<a name="l00087"></a>00087     <span class="keyword">const</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Option.html">Option&lt;std::string&gt;</a>&amp; <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a8efb470743692b0b69d2af8d44f6aeab">nogood</a>() <span class="keyword">const</span>;
<a name="l00088"></a>00088     <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a>&amp; <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a21b0c10593cfe2f7698e4fa84f9e20cf">set_nogood</a>(<span class="keyword">const</span> std::string&amp; nogood);
<a name="l00089"></a>00089     <span class="keyword">const</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Option.html">Option&lt;std::string&gt;</a>&amp; <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a04f54d73025c2bde71d26e13ff3e13ee">info</a>() <span class="keyword">const</span>;
<a name="l00090"></a>00090     <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a>&amp; <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a5dbe69e7858b8bbbe8df7c5558da004a">set_info</a>(<span class="keyword">const</span> std::string&amp; info);
<a name="l00091"></a>00091     <span class="keywordtype">int</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a15f60486ee85c2b02c213dae539850ac">alt</a>() <span class="keyword">const</span>;
<a name="l00092"></a>00092     <span class="keywordtype">int</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a7e92b7d3ac501fa41e03f6024391553c">kids</a>() <span class="keyword">const</span>;
<a name="l00093"></a>00093     <a class="code" href="namespaceGecode_1_1CPProfiler.html#a6cd5b4d4e96714b0341a9640b0fda3c5" title="Types of nodes for CP Profiler.">NodeStatus</a> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#aa960f71055a9941763b477a7a12cb122">status</a>() <span class="keyword">const</span>;
<a name="l00094"></a>00094     <a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a76db135978b24fd413ba3b7d4f92e779">nodeUID</a>() <span class="keyword">const</span>;
<a name="l00095"></a>00095     <a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a01c4fea5b3ac989638ff33c66b881691">parentUID</a>() <span class="keyword">const</span>;
<a name="l00096"></a>00096     <span class="keywordtype">int</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a7f2324bbb795c0f9fcad464d489b5846">node_id</a>() <span class="keyword">const</span>;
<a name="l00097"></a>00097     <span class="keywordtype">int</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a0a61b1e93757574d9f2abf664ca3e4ea">parent_id</a>() <span class="keyword">const</span>;
<a name="l00098"></a>00098     <span class="keywordtype">int</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a68425faa83331ed394811e245000ee68">node_thread_id</a>() <span class="keyword">const</span>;
<a name="l00099"></a>00099     <span class="keywordtype">int</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a8b88681126e0818bde8fe001bb872409">node_restart_id</a>() <span class="keyword">const</span>;
<a name="l00100"></a>00100     <span class="keywordtype">int</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#acfb79c4e452f38cb5dec27c83f0c44cd">parent_thread_id</a>() <span class="keyword">const</span>;
<a name="l00101"></a>00101     <span class="keywordtype">int</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a4b65ea1be30059785f01065490719096">parent_restart_id</a>() <span class="keyword">const</span>;
<a name="l00102"></a>00102   };
<a name="l00103"></a>00103 
<a name="l00104"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html">00104</a>   <span class="keyword">class </span><a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html">Connector</a> {
<a name="l00105"></a>00105   <span class="keyword">private</span>:
<a name="l00106"></a>00106     <a class="code" href="classGecode_1_1CPProfiler_1_1MessageMarshalling.html">MessageMarshalling</a> marshalling;
<a name="l00107"></a>00107     
<a name="l00108"></a>00108     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> port;
<a name="l00109"></a>00109     
<a name="l00110"></a>00110     <span class="keywordtype">int</span> sockfd;
<a name="l00111"></a>00111     <span class="keywordtype">bool</span> _connected;
<a name="l00112"></a>00112     
<a name="l00113"></a>00113     <span class="keyword">static</span> <span class="keywordtype">int</span> sendall(<span class="keywordtype">int</span> s, <span class="keyword">const</span> <span class="keywordtype">char</span>* buf, <span class="keywordtype">int</span>* len);
<a name="l00114"></a>00114     <span class="keywordtype">void</span> sendOverSocket(<span class="keywordtype">void</span>);
<a name="l00115"></a>00115     <span class="keywordtype">void</span> sendRawMsg(<span class="keyword">const</span> std::vector&lt;char&gt;&amp; buf);
<a name="l00116"></a>00116   <span class="keyword">public</span>:    
<a name="l00117"></a>00117     <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a9ac926b0046ecb477e949bf1a35c69a3">Connector</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> port);
<a name="l00118"></a>00118     
<a name="l00119"></a>00119     <span class="keywordtype">bool</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#aee8fd4b954166ca753b36147cf7d6e52">connected</a>() <span class="keyword">const</span>;
<a name="l00120"></a>00120     
<a name="l00123"></a>00123     <span class="keywordtype">void</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a9e5a5a1e5570465d0769f517dfb609e5" title="connect to a socket via port specified in the construction (6565 by default)">connect</a>(<span class="keywordtype">void</span>);
<a name="l00124"></a>00124     
<a name="l00125"></a>00125     <span class="comment">// sends START_SENDING message to the Profiler with a model name</span>
<a name="l00126"></a>00126     <span class="keywordtype">void</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a55f731d7f2530b76ff60dd6bb6da9d12">start</a>(<span class="keyword">const</span> std::string&amp; file_path = <span class="stringliteral">&quot;&quot;</span>,
<a name="l00127"></a>00127                <span class="keywordtype">int</span> execution_id = -1, <span class="keywordtype">bool</span> has_restarts = <span class="keyword">false</span>);
<a name="l00128"></a>00128     <span class="keywordtype">void</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#ae15461643b8fde02c772b38cba928e10">restart</a>(<span class="keywordtype">int</span> restart_id = -1);
<a name="l00129"></a>00129     <span class="keywordtype">void</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a2f16e4b019af6acdf82af49c78c3f9d3">done</a>();
<a name="l00130"></a>00130     
<a name="l00132"></a>00132     <span class="keywordtype">void</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a7a97f7548e49ffc5d8ff3cbf9786bb0a" title="disconnect from a socket">disconnect</a>(<span class="keywordtype">void</span>);
<a name="l00133"></a>00133     
<a name="l00134"></a>00134     <span class="keywordtype">void</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a45844fa89f6aeb5b07090afac7ccebf9">sendNode</a>(<span class="keyword">const</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a>&amp; node);
<a name="l00135"></a>00135     <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a> <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a408c1b85937dd74ca1409aa54239c85c">createNode</a>(<a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a> node, <a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a> parent,
<a name="l00136"></a>00136                     <span class="keywordtype">int</span> alt, <span class="keywordtype">int</span> kids, <a class="code" href="namespaceGecode_1_1CPProfiler.html#a6cd5b4d4e96714b0341a9640b0fda3c5" title="Types of nodes for CP Profiler.">NodeStatus</a> status);
<a name="l00137"></a>00137   };
<a name="l00138"></a>00138   
<a name="l00139"></a>00139 
<a name="l00140"></a>00140   <span class="comment">/*</span>
<a name="l00141"></a>00141 <span class="comment">   * Nodes</span>
<a name="l00142"></a>00142 <span class="comment">   */</span>
<a name="l00143"></a>00143   <span class="keyword">inline</span>
<a name="l00144"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a4f53d0842ea430e1a8998da3e3cee763">00144</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a4f53d0842ea430e1a8998da3e3cee763">Node::Node</a>(<a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a> node, <a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a> parent,
<a name="l00145"></a>00145              <span class="keywordtype">int</span> alt, <span class="keywordtype">int</span> kids, <a class="code" href="namespaceGecode_1_1CPProfiler.html#a6cd5b4d4e96714b0341a9640b0fda3c5" title="Types of nodes for CP Profiler.">NodeStatus</a> status)
<a name="l00146"></a>00146     : node_{node}, parent_{parent},
<a name="l00147"></a><a class="code" href="namespaceGecode_1_1CPProfiler.html#a417051adefe4d8c1f187b10031eceabe">00147</a>     <a class="code" href="namespaceGecode_1_1CPProfiler.html#aac98013a2a72ba35d77d36c61adcd6c2">alt_</a>(alt), <a class="code" href="namespaceGecode_1_1CPProfiler.html#aba9b3b7887d70fbce5334b3342163f37">kids_</a>(kids), <a class="code" href="namespaceGecode_1_1CPProfiler.html#a417051adefe4d8c1f187b10031eceabe">status_</a>(status) {}
<a name="l00148"></a>00148     
<a name="l00149"></a>00149   <span class="keyword">inline</span> Node&amp;
<a name="l00150"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#acfa127737b78dbb38fc2220b9c13a9ed">00150</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#acfa127737b78dbb38fc2220b9c13a9ed">Node::set_node_thread_id</a>(<span class="keywordtype">int</span> tid) {
<a name="l00151"></a>00151     node_.<a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html#aa453418e7cf61bcb58b72d5852ba152b" title="Thread id.">tid</a> = tid;
<a name="l00152"></a>00152     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00153"></a>00153   }
<a name="l00154"></a>00154     
<a name="l00155"></a>00155   <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Option.html">Option&lt;std::string&gt;</a>&amp;
<a name="l00156"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a2c1c1a36a834712d320d10fbf2023272">00156</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a2c1c1a36a834712d320d10fbf2023272">Node::label</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> label_; }
<a name="l00157"></a>00157     
<a name="l00158"></a>00158   <span class="keyword">inline</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a>&amp;
<a name="l00159"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#ae9d3fdd3ae16d0d9ea78c924ad29923b">00159</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#ae9d3fdd3ae16d0d9ea78c924ad29923b">Node::set_label</a>(<span class="keyword">const</span> std::string&amp; label) {
<a name="l00160"></a>00160     label_.<a class="code" href="classGecode_1_1CPProfiler_1_1Option.html#a3e268d78e7f2984be28a03890eef2313" title="Set value to t.">set</a>(label);
<a name="l00161"></a>00161     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00162"></a>00162   }
<a name="l00163"></a>00163     
<a name="l00164"></a>00164   <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Option.html">Option&lt;std::string&gt;</a>&amp;
<a name="l00165"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a8efb470743692b0b69d2af8d44f6aeab">00165</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a8efb470743692b0b69d2af8d44f6aeab">Node::nogood</a>()<span class="keyword"> const </span>{ 
<a name="l00166"></a>00166     <span class="keywordflow">return</span> nogood_;
<a name="l00167"></a>00167   }
<a name="l00168"></a>00168     
<a name="l00169"></a>00169   <span class="keyword">inline</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a>&amp;
<a name="l00170"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a21b0c10593cfe2f7698e4fa84f9e20cf">00170</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a21b0c10593cfe2f7698e4fa84f9e20cf">Node::set_nogood</a>(<span class="keyword">const</span> std::string&amp; nogood) {
<a name="l00171"></a>00171     nogood_.<a class="code" href="classGecode_1_1CPProfiler_1_1Option.html#a3e268d78e7f2984be28a03890eef2313" title="Set value to t.">set</a>(nogood);
<a name="l00172"></a>00172     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00173"></a>00173   }
<a name="l00174"></a>00174     
<a name="l00175"></a>00175   <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Option.html">Option&lt;std::string&gt;</a>&amp;
<a name="l00176"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a04f54d73025c2bde71d26e13ff3e13ee">00176</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a04f54d73025c2bde71d26e13ff3e13ee">Node::info</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> info_; }
<a name="l00177"></a>00177 
<a name="l00178"></a>00178   <span class="keyword">inline</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a>&amp;
<a name="l00179"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a5dbe69e7858b8bbbe8df7c5558da004a">00179</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a5dbe69e7858b8bbbe8df7c5558da004a">Node::set_info</a>(<span class="keyword">const</span> std::string&amp; info) {
<a name="l00180"></a>00180     info_.<a class="code" href="classGecode_1_1CPProfiler_1_1Option.html#a3e268d78e7f2984be28a03890eef2313" title="Set value to t.">set</a>(info);
<a name="l00181"></a>00181     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00182"></a>00182   }
<a name="l00183"></a>00183     
<a name="l00184"></a>00184   <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00185"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a15f60486ee85c2b02c213dae539850ac">00185</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a15f60486ee85c2b02c213dae539850ac">Node::alt</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> alt_; }
<a name="l00186"></a>00186   <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00187"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a7e92b7d3ac501fa41e03f6024391553c">00187</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a7e92b7d3ac501fa41e03f6024391553c">Node::kids</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> kids_; }
<a name="l00188"></a>00188     
<a name="l00189"></a>00189   <span class="keyword">inline</span> <a class="code" href="namespaceGecode_1_1CPProfiler.html#a6cd5b4d4e96714b0341a9640b0fda3c5" title="Types of nodes for CP Profiler.">NodeStatus</a>
<a name="l00190"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#aa960f71055a9941763b477a7a12cb122">00190</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#aa960f71055a9941763b477a7a12cb122">Node::status</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> status_; }
<a name="l00191"></a>00191     
<a name="l00192"></a>00192   <span class="keyword">inline</span> <a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a>
<a name="l00193"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a76db135978b24fd413ba3b7d4f92e779">00193</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a76db135978b24fd413ba3b7d4f92e779">Node::nodeUID</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> node_; }
<a name="l00194"></a>00194   <span class="keyword">inline</span> <a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a>
<a name="l00195"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a01c4fea5b3ac989638ff33c66b881691">00195</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a01c4fea5b3ac989638ff33c66b881691">Node::parentUID</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> parent_; }
<a name="l00196"></a>00196     
<a name="l00197"></a>00197   <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00198"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a7f2324bbb795c0f9fcad464d489b5846">00198</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a7f2324bbb795c0f9fcad464d489b5846">Node::node_id</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> node_.<a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html#a9b5eeeac922f53396bcfcbef3988bb8e" title="Node number.">nid</a>; }
<a name="l00199"></a>00199   <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00200"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a0a61b1e93757574d9f2abf664ca3e4ea">00200</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a0a61b1e93757574d9f2abf664ca3e4ea">Node::parent_id</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> parent_.<a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html#a9b5eeeac922f53396bcfcbef3988bb8e" title="Node number.">nid</a>; }
<a name="l00201"></a>00201   <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00202"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a68425faa83331ed394811e245000ee68">00202</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a68425faa83331ed394811e245000ee68">Node::node_thread_id</a>()<span class="keyword"> const </span>{  <span class="keywordflow">return</span> node_.<a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html#aa453418e7cf61bcb58b72d5852ba152b" title="Thread id.">tid</a>; }
<a name="l00203"></a>00203   <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00204"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a8b88681126e0818bde8fe001bb872409">00204</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a8b88681126e0818bde8fe001bb872409">Node::node_restart_id</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> node_.<a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html#a9bf4b2c6442551fede10927399b2c9ad" title="Restart id.">rid</a>; }
<a name="l00205"></a>00205   <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00206"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#acfb79c4e452f38cb5dec27c83f0c44cd">00206</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#acfb79c4e452f38cb5dec27c83f0c44cd">Node::parent_thread_id</a>()<span class="keyword"> const </span>{  <span class="keywordflow">return</span> parent_.<a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html#aa453418e7cf61bcb58b72d5852ba152b" title="Thread id.">tid</a>; }
<a name="l00207"></a>00207   <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00208"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a4b65ea1be30059785f01065490719096">00208</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a4b65ea1be30059785f01065490719096">Node::parent_restart_id</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> parent_.<a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html#a9bf4b2c6442551fede10927399b2c9ad" title="Restart id.">rid</a>; }
<a name="l00209"></a>00209 
<a name="l00210"></a>00210   
<a name="l00211"></a>00211   <span class="comment">/*</span>
<a name="l00212"></a>00212 <span class="comment">   * Connector</span>
<a name="l00213"></a>00213 <span class="comment">   */</span>
<a name="l00214"></a>00214   <span class="keyword">inline</span>
<a name="l00215"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a9ac926b0046ecb477e949bf1a35c69a3">00215</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a9ac926b0046ecb477e949bf1a35c69a3">Connector::Connector</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> port) : port(port), _connected(false) {}
<a name="l00216"></a>00216 
<a name="l00217"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#aee8fd4b954166ca753b36147cf7d6e52">00217</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#aee8fd4b954166ca753b36147cf7d6e52">Connector::connected</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _connected; }
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 
<a name="l00220"></a>00220   <span class="comment">/*</span>
<a name="l00221"></a>00221 <span class="comment">   * The following code is taken from:</span>
<a name="l00222"></a>00222 <span class="comment">   *   Beej&#39;s Guide to Network Programming</span>
<a name="l00223"></a>00223 <span class="comment">   *   http://beej.us/guide/bgnet/</span>
<a name="l00224"></a>00224 <span class="comment">   * with the folloiwng license:</span>
<a name="l00225"></a>00225 <span class="comment">   *</span>
<a name="l00226"></a>00226 <span class="comment">   * Beej&#39;s Guide to Network Programming is Copyright © 2015 Brian &quot;Beej Jorgensen&quot; Hall.</span>
<a name="l00227"></a>00227 <span class="comment">   * With specific exceptions for source code and translations, below, this work is licensed under the Creative Commons Attribution- Noncommercial- No Derivative Works 3.0 License. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-nd/3.0/ or send a letter to Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.</span>
<a name="l00228"></a>00228 <span class="comment">   * One specific exception to the &quot;No Derivative Works&quot; portion of the license is as follows: this guide may be freely translated into any language, provided the translation is accurate, and the guide is reprinted in its entirety. The same license restrictions apply to the translation as to the original guide. The translation may also include the name and contact information for the translator.</span>
<a name="l00229"></a>00229 <span class="comment">   * The C source code presented in this document is hereby granted to the public domain, and is completely free of any license restriction.</span>
<a name="l00230"></a>00230 <span class="comment">   * Educators are freely encouraged to recommend or supply copies of this guide to their students.</span>
<a name="l00231"></a>00231 <span class="comment">   * Contact beej@beej.us for more information. </span>
<a name="l00232"></a>00232 <span class="comment">   */</span>
<a name="l00233"></a>00233   <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00234"></a>00234   Connector::sendall(<span class="keywordtype">int</span> s, <span class="keyword">const</span> <span class="keywordtype">char</span>* buf, <span class="keywordtype">int</span>* len) {
<a name="l00235"></a>00235     <span class="keywordtype">int</span> total = 0;         <span class="comment">// how many bytes we&#39;ve sent</span>
<a name="l00236"></a>00236     <span class="keywordtype">int</span> bytesleft = *len;  <span class="comment">// how many we have left to send</span>
<a name="l00237"></a>00237     ssize_t <a class="code" href="bool-expr_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240" title="Number of negative literals for node type.">n</a>;
<a name="l00238"></a>00238     
<a name="l00239"></a>00239     <span class="keywordflow">while</span> (total &lt; *len) {
<a name="l00240"></a>00240       n = send(s, buf + total, static_cast&lt;size_t&gt;(bytesleft), 0);
<a name="l00241"></a>00241       <span class="keywordflow">if</span> (n == -1) {
<a name="l00242"></a>00242         <span class="keywordflow">break</span>;
<a name="l00243"></a>00243       }
<a name="l00244"></a>00244       total += n;
<a name="l00245"></a>00245       bytesleft -= n;
<a name="l00246"></a>00246     }
<a name="l00247"></a>00247 
<a name="l00248"></a>00248     *len = total;  <span class="comment">// return number actually sent here</span>
<a name="l00249"></a>00249     
<a name="l00250"></a>00250     <span class="keywordflow">return</span> n == -1 ? -1 : 0;  <span class="comment">// return -1 on failure, 0 on success</span>
<a name="l00251"></a>00251   }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253   <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00254"></a>00254   Connector::sendRawMsg(<span class="keyword">const</span> std::vector&lt;char&gt;&amp; buf) {
<a name="l00255"></a>00255     uint32_t bufSize = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(buf.size());
<a name="l00256"></a>00256     <span class="keywordtype">int</span> bufSizeLen = <span class="keyword">sizeof</span>(uint32_t);
<a name="l00257"></a>00257     sendall(sockfd, reinterpret_cast&lt;char*&gt;(&amp;bufSize), &amp;bufSizeLen);
<a name="l00258"></a>00258     <span class="keywordtype">int</span> bufSizeInt = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(bufSize);
<a name="l00259"></a>00259     sendall(sockfd, reinterpret_cast&lt;const char*&gt;(buf.data()), &amp;bufSizeInt);
<a name="l00260"></a>00260   }
<a name="l00261"></a>00261     
<a name="l00262"></a>00262   <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00263"></a>00263   Connector::sendOverSocket(<span class="keywordtype">void</span>) {
<a name="l00264"></a>00264     <span class="keywordflow">if</span> (!_connected) <span class="keywordflow">return</span>;
<a name="l00265"></a>00265       
<a name="l00266"></a>00266     std::vector&lt;char&gt; buf = marshalling.serialize();
<a name="l00267"></a>00267       
<a name="l00268"></a>00268     sendRawMsg(buf);
<a name="l00269"></a>00269   }
<a name="l00270"></a>00270     
<a name="l00271"></a>00271   <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00272"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a9e5a5a1e5570465d0769f517dfb609e5">00272</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a9e5a5a1e5570465d0769f517dfb609e5" title="connect to a socket via port specified in the construction (6565 by default)">Connector::connect</a>(<span class="keywordtype">void</span>) {
<a name="l00273"></a>00273     <span class="keyword">struct </span>addrinfo hints, *servinfo, *<a class="code" href="bool-expr_8cpp.html#a533391314665d6bf1b5575e9a9cd8552" title="Number of positive literals for node type.">p</a>;
<a name="l00274"></a>00274     <span class="keywordtype">int</span> rv;
<a name="l00275"></a>00275       
<a name="l00276"></a>00276 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00277"></a>00277 <span class="preprocessor"></span>    <span class="comment">// Initialise Winsock.</span>
<a name="l00278"></a>00278     WSADATA wsaData;
<a name="l00279"></a>00279     <span class="keywordtype">int</span> startupResult = WSAStartup(MAKEWORD(2, 2), &amp;wsaData);
<a name="l00280"></a>00280     <span class="keywordflow">if</span> (startupResult != 0) {
<a name="l00281"></a>00281       printf(<span class="stringliteral">&quot;WSAStartup failed with error: %d\n&quot;</span>, startupResult);
<a name="l00282"></a>00282     }
<a name="l00283"></a>00283 <span class="preprocessor">#endif</span>
<a name="l00284"></a>00284 <span class="preprocessor"></span>    
<a name="l00285"></a>00285     memset(&amp;hints, 0, <span class="keyword">sizeof</span> hints);
<a name="l00286"></a>00286     hints.ai_family = AF_UNSPEC;
<a name="l00287"></a>00287     hints.ai_socktype = SOCK_STREAM;
<a name="l00288"></a>00288     
<a name="l00289"></a>00289     <span class="keywordflow">if</span> ((rv = getaddrinfo(<span class="stringliteral">&quot;localhost&quot;</span>, std::to_string(port).c_str(), &amp;hints,
<a name="l00290"></a>00290                           &amp;servinfo)) != 0) {
<a name="l00291"></a>00291       std::cerr &lt;&lt; <span class="stringliteral">&quot;getaddrinfo: &quot;</span> &lt;&lt; gai_strerror(rv) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00292"></a>00292       <span class="keywordflow">goto</span> giveup;
<a name="l00293"></a>00293     }
<a name="l00294"></a>00294     
<a name="l00295"></a>00295     <span class="comment">// loop through all the results and connect to the first we can</span>
<a name="l00296"></a>00296     <span class="keywordflow">for</span> (p = servinfo; p != NULL; p = p-&gt;ai_next) {
<a name="l00297"></a>00297       <span class="keywordflow">if</span> ((sockfd = socket(p-&gt;ai_family, p-&gt;ai_socktype, p-&gt;ai_protocol)) == -1) {
<a name="l00298"></a>00298         <span class="comment">// errno is set here, but we don&#39;t examine it.</span>
<a name="l00299"></a>00299         <span class="keywordflow">continue</span>;
<a name="l00300"></a>00300       }
<a name="l00301"></a>00301       
<a name="l00302"></a>00302       <span class="keywordflow">if</span> (::<a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a9e5a5a1e5570465d0769f517dfb609e5" title="connect to a socket via port specified in the construction (6565 by default)">connect</a>(sockfd, p-&gt;ai_addr, p-&gt;ai_addrlen) == -1) {
<a name="l00303"></a>00303 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00304"></a>00304 <span class="preprocessor"></span>        closesocket(sockfd);
<a name="l00305"></a>00305 <span class="preprocessor">#else</span>
<a name="l00306"></a>00306 <span class="preprocessor"></span>        close(sockfd);
<a name="l00307"></a>00307 <span class="preprocessor">#endif</span>
<a name="l00308"></a>00308 <span class="preprocessor"></span>        <span class="comment">// errno is set here, but we don&#39;t examine it.</span>
<a name="l00309"></a>00309         <span class="keywordflow">continue</span>;
<a name="l00310"></a>00310       }
<a name="l00311"></a>00311       
<a name="l00312"></a>00312       <span class="keywordflow">break</span>;
<a name="l00313"></a>00313     }
<a name="l00314"></a>00314     
<a name="l00315"></a>00315     <span class="comment">// Connection failed; give up.</span>
<a name="l00316"></a>00316     <span class="keywordflow">if</span> (p == NULL) {
<a name="l00317"></a>00317       <span class="keywordflow">goto</span> giveup;
<a name="l00318"></a>00318     }
<a name="l00319"></a>00319       
<a name="l00320"></a>00320     freeaddrinfo(servinfo);  <span class="comment">// all done with this structure</span>
<a name="l00321"></a>00321     
<a name="l00322"></a>00322     _connected = <span class="keyword">true</span>;
<a name="l00323"></a>00323     
<a name="l00324"></a>00324     <span class="keywordflow">return</span>;
<a name="l00325"></a>00325   giveup:
<a name="l00326"></a>00326     _connected = <span class="keyword">false</span>;
<a name="l00327"></a>00327     <span class="keywordflow">return</span>;
<a name="l00328"></a>00328     
<a name="l00329"></a>00329   }
<a name="l00330"></a>00330   
<a name="l00331"></a>00331   <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00332"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a55f731d7f2530b76ff60dd6bb6da9d12">00332</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a55f731d7f2530b76ff60dd6bb6da9d12">Connector::start</a>(<span class="keyword">const</span> std::string&amp; file_path,
<a name="l00333"></a>00333                    <span class="keywordtype">int</span> execution_id, <span class="keywordtype">bool</span> has_restarts) {
<a name="l00335"></a>00335     std::string base_name(file_path);
<a name="l00336"></a>00336     {
<a name="l00337"></a>00337       <span class="keywordtype">size_t</span> <a class="code" href="namespaceGecode_1_1Float_1_1Arithmetic.html#a4247116b552338bc9db16d146cd23d85" title="Test whether x is postive.">pos</a> = base_name.find_last_of(<span class="charliteral">&#39;/&#39;</span>);
<a name="l00338"></a>00338       <span class="keywordflow">if</span> (pos != static_cast&lt;size_t&gt;(-1)) {
<a name="l00339"></a>00339         base_name = base_name.substr(pos + 1, base_name.length() - pos - 1);
<a name="l00340"></a>00340       }
<a name="l00341"></a>00341     }
<a name="l00342"></a>00342     
<a name="l00343"></a>00343     std::string info{<span class="stringliteral">&quot;&quot;</span>};
<a name="l00344"></a>00344     {
<a name="l00345"></a>00345       std::stringstream ss;
<a name="l00346"></a>00346       ss &lt;&lt; <span class="stringliteral">&quot;{&quot;</span>;
<a name="l00347"></a>00347       ss &lt;&lt; <span class="stringliteral">&quot;\&quot;has_restarts\&quot;: &quot;</span> &lt;&lt; (has_restarts ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>)  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00348"></a>00348       ss &lt;&lt; <span class="stringliteral">&quot;,\&quot;name\&quot;: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; base_name &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00349"></a>00349       <span class="keywordflow">if</span> (execution_id != -1) {
<a name="l00350"></a>00350         ss &lt;&lt; <span class="stringliteral">&quot;,\&quot;execution_id\&quot;: &quot;</span> &lt;&lt; execution_id;
<a name="l00351"></a>00351       }
<a name="l00352"></a>00352       ss &lt;&lt; <span class="stringliteral">&quot;}&quot;</span>;
<a name="l00353"></a>00353       info = ss.str();
<a name="l00354"></a>00354     }
<a name="l00355"></a>00355     
<a name="l00356"></a>00356     marshalling.<a class="code" href="classGecode_1_1CPProfiler_1_1MessageMarshalling.html#abb3a32ccca4b93d10a3f8293e5392238">makeStart</a>(info);
<a name="l00357"></a>00357     sendOverSocket();
<a name="l00358"></a>00358   }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360   <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00361"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#ae15461643b8fde02c772b38cba928e10">00361</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#ae15461643b8fde02c772b38cba928e10">Connector::restart</a>(<span class="keywordtype">int</span> restart_id) {
<a name="l00362"></a>00362       
<a name="l00363"></a>00363     std::string info{<span class="stringliteral">&quot;&quot;</span>};
<a name="l00364"></a>00364     {
<a name="l00365"></a>00365       std::stringstream ss;
<a name="l00366"></a>00366       ss &lt;&lt; <span class="stringliteral">&quot;{&quot;</span>;
<a name="l00367"></a>00367       ss &lt;&lt; <span class="stringliteral">&quot;\&quot;restart_id\&quot;: &quot;</span> &lt;&lt; restart_id &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00368"></a>00368       ss &lt;&lt; <span class="stringliteral">&quot;}&quot;</span>;
<a name="l00369"></a>00369       info = ss.str();
<a name="l00370"></a>00370     }
<a name="l00371"></a>00371     
<a name="l00372"></a>00372     marshalling.<a class="code" href="classGecode_1_1CPProfiler_1_1MessageMarshalling.html#ae19fabd7c7c45d7be0be018b1dc2d01d">makeRestart</a>(info);
<a name="l00373"></a>00373     sendOverSocket();
<a name="l00374"></a>00374   }
<a name="l00375"></a>00375   
<a name="l00376"></a>00376   <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00377"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a2f16e4b019af6acdf82af49c78c3f9d3">00377</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a2f16e4b019af6acdf82af49c78c3f9d3">Connector::done</a>() {
<a name="l00378"></a>00378     marshalling.<a class="code" href="classGecode_1_1CPProfiler_1_1MessageMarshalling.html#ac2f79994c32df0e9f994869d4f0c22c2">makeDone</a>();
<a name="l00379"></a>00379     sendOverSocket();
<a name="l00380"></a>00380   }
<a name="l00381"></a>00381   
<a name="l00382"></a>00382   <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00383"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a7a97f7548e49ffc5d8ff3cbf9786bb0a">00383</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a7a97f7548e49ffc5d8ff3cbf9786bb0a" title="disconnect from a socket">Connector::disconnect</a>() {
<a name="l00384"></a>00384 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00385"></a>00385 <span class="preprocessor"></span>    closesocket(sockfd);
<a name="l00386"></a>00386 <span class="preprocessor">#else</span>
<a name="l00387"></a>00387 <span class="preprocessor"></span>    close(sockfd);
<a name="l00388"></a>00388 <span class="preprocessor">#endif</span>
<a name="l00389"></a>00389 <span class="preprocessor"></span>  }
<a name="l00390"></a>00390   
<a name="l00391"></a>00391   <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00392"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a45844fa89f6aeb5b07090afac7ccebf9">00392</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a45844fa89f6aeb5b07090afac7ccebf9">Connector::sendNode</a>(<span class="keyword">const</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a>&amp; node) {
<a name="l00393"></a>00393     <span class="keywordflow">if</span> (!_connected) <span class="keywordflow">return</span>;
<a name="l00394"></a>00394     
<a name="l00395"></a>00395     <span class="keyword">auto</span>&amp; msg = marshalling.<a class="code" href="classGecode_1_1CPProfiler_1_1MessageMarshalling.html#aa7eec088fab5da6777c272dece86ef18">makeNode</a>(node.<a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a76db135978b24fd413ba3b7d4f92e779">nodeUID</a>(), node.<a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a01c4fea5b3ac989638ff33c66b881691">parentUID</a>(),
<a name="l00396"></a>00396                                      node.<a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a15f60486ee85c2b02c213dae539850ac">alt</a>(), node.<a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a7e92b7d3ac501fa41e03f6024391553c">kids</a>(), node.<a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#aa960f71055a9941763b477a7a12cb122">status</a>());
<a name="l00397"></a>00397     
<a name="l00398"></a>00398     <span class="keywordflow">if</span> (node.<a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a2c1c1a36a834712d320d10fbf2023272">label</a>().<a class="code" href="classGecode_1_1CPProfiler_1_1Option.html#aeedac82e7659b8e5ec2ba0508a54138d" title="Whether value is present.">valid</a>()) msg.<a class="code" href="classGecode_1_1CPProfiler_1_1Message.html#a12d5d76848a92a2dcf5d1ac339690d0e">set_label</a>(node.<a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a2c1c1a36a834712d320d10fbf2023272">label</a>().<a class="code" href="classGecode_1_1CPProfiler_1_1Option.html#aad9474219453479a791419628d62e1fd" title="Access value.">value</a>());
<a name="l00399"></a>00399     <span class="keywordflow">if</span> (node.<a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a8efb470743692b0b69d2af8d44f6aeab">nogood</a>().<a class="code" href="classGecode_1_1CPProfiler_1_1Option.html#aeedac82e7659b8e5ec2ba0508a54138d" title="Whether value is present.">valid</a>()) msg.set_nogood(node.<a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a8efb470743692b0b69d2af8d44f6aeab">nogood</a>().<a class="code" href="classGecode_1_1CPProfiler_1_1Option.html#aad9474219453479a791419628d62e1fd" title="Access value.">value</a>());
<a name="l00400"></a>00400     <span class="keywordflow">if</span> (node.<a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a04f54d73025c2bde71d26e13ff3e13ee">info</a>().<a class="code" href="classGecode_1_1CPProfiler_1_1Option.html#aeedac82e7659b8e5ec2ba0508a54138d" title="Whether value is present.">valid</a>()) msg.set_info(node.<a class="code" href="classGecode_1_1CPProfiler_1_1Node.html#a04f54d73025c2bde71d26e13ff3e13ee">info</a>().<a class="code" href="classGecode_1_1CPProfiler_1_1Option.html#aad9474219453479a791419628d62e1fd" title="Access value.">value</a>());
<a name="l00401"></a>00401     
<a name="l00402"></a>00402     sendOverSocket();
<a name="l00403"></a>00403   }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405   <span class="keyword">inline</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a>
<a name="l00406"></a><a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a408c1b85937dd74ca1409aa54239c85c">00406</a>   <a class="code" href="classGecode_1_1CPProfiler_1_1Connector.html#a408c1b85937dd74ca1409aa54239c85c">Connector::createNode</a>(<a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a> node, <a class="code" href="structGecode_1_1CPProfiler_1_1NodeUID.html" title="Unique identifier for a node.">NodeUID</a> parent,
<a name="l00407"></a>00407                         <span class="keywordtype">int</span> alt, <span class="keywordtype">int</span> kids, <a class="code" href="namespaceGecode_1_1CPProfiler.html#a6cd5b4d4e96714b0341a9640b0fda3c5" title="Types of nodes for CP Profiler.">NodeStatus</a> status) {
<a name="l00408"></a>00408     <span class="keywordflow">return</span> <a class="code" href="classGecode_1_1CPProfiler_1_1Node.html">Node</a>(node, parent, alt, kids, status);
<a name="l00409"></a>00409   }
<a name="l00410"></a>00410   
<a name="l00411"></a>00411 }}
<a name="l00412"></a>00412 
<a name="l00413"></a>00413 <span class="comment">// STATISTICS: search-trace</span>
</pre></div></div>
</div></div>
</body>
</html>
