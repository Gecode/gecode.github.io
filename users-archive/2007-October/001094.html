<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [gecode-users] Help:How to compute Autocorrelation of	a	v-length sequence
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:users%40gecode.org?Subject=Re%3A%20%5Bgecode-users%5D%20Help%3AHow%20to%20compute%20Autocorrelation%20of%0A%09a%09v-length%20sequence&In-Reply-To=%3C000001c81359%2420214ed0%246063ec70%24%40se%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001093.html">
   <LINK REL="Next"  HREF="001095.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[gecode-users] Help:How to compute Autocorrelation of	a	v-length sequence</H1>
    <B>Christian Schulte</B> 
    <A HREF="mailto:users%40gecode.org?Subject=Re%3A%20%5Bgecode-users%5D%20Help%3AHow%20to%20compute%20Autocorrelation%20of%0A%09a%09v-length%20sequence&In-Reply-To=%3C000001c81359%2420214ed0%246063ec70%24%40se%3E"
       TITLE="[gecode-users] Help:How to compute Autocorrelation of	a	v-length sequence">cschulte at kth.se
       </A><BR>
    <I>Sat Oct 20 22:38:02 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001093.html">[gecode-users] Help:How to compute Autocorrelation of a	v-length sequence
</A></li>
        <LI>Next message: <A HREF="001095.html">[gecode-users] gecode autoconf setting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1094">[ date ]</a>
              <a href="thread.html#1094">[ thread ]</a>
              <a href="subject.html#1094">[ subject ]</a>
              <a href="author.html#1094">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear George,

I am sorry but I have to refrain from answering: to me, this is a modeling
issue and not a Gecode-specific issue. Sorry, but I think that we as Gecode
developers have to stick to Gecode-specific issues (time is a limited
resource).

On the other hand, any takers from the community?

Cheers
Christian

-----Original Message-----
From: <A HREF="https://www.ps.uni-sb.de/mailman/listinfo/users">users-bounces at gecode.org</A> [mailto:<A HREF="https://www.ps.uni-sb.de/mailman/listinfo/users">users-bounces at gecode.org</A>] On Behalf
Of George Rudolph
Sent: Friday, October 19, 2007 4:49 PM
To: <A HREF="https://www.ps.uni-sb.de/mailman/listinfo/users">cschulte at kth.se</A>; <A HREF="https://www.ps.uni-sb.de/mailman/listinfo/users">users at gecode.org</A>
Subject: Re: [gecode-users] Help:How to compute Autocorrelation of a
v-length sequence

The gecode-specific question is this:
What have I done wrong?
How do I specify periodic autocorrelation on a binary sequence 
using Gecode/J?
The code I have written does not match the constraints
I think I am writing--when I run the program for v=13,
for example, I am expecting exactly two solutions,
but I get more than two. And the additional solutions don't match the
constraints I am trying to specify.
Yet, It is not obvious to me what I have done wrong.

--------------------
George Rudolph
Assistant Professor
Thompson Hall 225
Math &amp; Computer Science Dept.
The Citadel
171 Moultrie St.
Charleston, SC 29409

&gt;<i> -----Original Message-----
</I>&gt;<i> From: Christian Schulte [mailto:<A HREF="https://www.ps.uni-sb.de/mailman/listinfo/users">cschulte at kth.se</A>]
</I>&gt;<i> Sent: Friday, October 19, 2007 7:12 AM
</I>&gt;<i> To: George Rudolph; <A HREF="https://www.ps.uni-sb.de/mailman/listinfo/users">users at gecode.org</A>
</I>&gt;<i> Subject: RE: [gecode-users] Help:How to compute Autocorrelation of a
</I>v-
&gt;<i> lengthsequence
</I>&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> what is the Gecode-specific question here?
</I>&gt;<i> 
</I>&gt;<i> Christian
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> Christian Schulte, <A HREF="http://www.imit.kth.se/~schulte/">http://www.imit.kth.se/~schulte/</A>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="https://www.ps.uni-sb.de/mailman/listinfo/users">users-bounces at gecode.org</A> [mailto:<A HREF="https://www.ps.uni-sb.de/mailman/listinfo/users">users-bounces at gecode.org</A>] On
</I>Behalf
&gt;<i> Of George Rudolph
</I>&gt;<i> Sent: Thursday, October 18, 2007 7:42 PM
</I>&gt;<i> To: <A HREF="https://www.ps.uni-sb.de/mailman/listinfo/users">users at gecode.org</A>
</I>&gt;<i> Subject: [gecode-users] Help:How to compute Autocorrelation of a
</I>&gt;<i> v-lengthsequence
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> As stated in the comments below, I need help figuring out
</I>&gt;<i> how to express constraints on the autocorrelation of a v-length
</I>sequence.
&gt;<i> I am sure there is an easier way to rotate a list,
</I>&gt;<i>  compare two lists for positional matches, count the member of
</I>matches,
&gt;<i> and constrain the number of matches to be a particular value,
</I>&gt;<i> and I need help finding it.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ------------- begin code --------------
</I>&gt;<i> package citadel;
</I>&gt;<i> 
</I>&gt;<i> import static org.gecode.Gecode.*;
</I>&gt;<i> import static org.gecode.GecodeEnumConstants.*;
</I>&gt;<i> 
</I>&gt;<i> import org.gecode.*;
</I>&gt;<i> 
</I>&gt;<i> /**
</I>&gt;<i>  * Script for computing 2-class association schemes, modified from the
</I>&gt;<i> Queens
</I>&gt;<i>  * example. The goal of this script is to generate (v-1)-length
</I>sequences
&gt;<i> with
</I>&gt;<i>  * the following properties:
</I>&gt;<i>  * 1. v is prime and v=4t+1, t &gt;=0.
</I>&gt;<i>  * 2. each sequence has n1 occurrences of lambda1 and n2 occurrences
</I>of
&gt;<i> lambda2.
</I>&gt;<i>  * 3. the sequence is a palindrome: element 0 and element v-2 have the
</I>&gt;<i> sane
</I>&gt;<i> value, element 1 and
</I>&gt;<i>  * element v-3 have the same value, element 2 and element 4-4 have the
</I>&gt;<i> same
</I>&gt;<i>  * value, etc.
</I>&gt;<i>  * 4. The autocorrelation sequence generated by this sequence is flat.
</I>&gt;<i> That
</I>&gt;<i> is,
</I>&gt;<i>  * if you prepend a 0 to the sequence, and then take the
</I>cross-correlation
&gt;<i> C
</I>&gt;<i> of
</I>&gt;<i>  * the extended sequence with rotated copies of itself for all shift
</I>&gt;<i> values
</I>&gt;<i> y=1...(v-1),
</I>&gt;<i>  * then c[i] = 2t-1.
</I>&gt;<i>  * Since 0 matched with non-zero value is a mismatch, it should be
</I>&gt;<i> possible
</I>&gt;<i>  * take the cross-correlation without prepending the 0.
</I>&gt;<i>  *
</I>&gt;<i>  * @author George Rudolph
</I>&gt;<i>  * @version 1.0 Sep 20, 2007
</I>&gt;<i>  */
</I>&gt;<i> public class AssociationScheme extends Space {
</I>&gt;<i>         /**
</I>&gt;<i>          * v is the size or length of the sequence,
</I>&gt;<i>          * must be prime.
</I>&gt;<i>          */
</I>&gt;<i>         public int v;
</I>&gt;<i> 
</I>&gt;<i>         /**
</I>&gt;<i>          * v = 4t + 1, so t = (v-1)/4, t &gt; 0
</I>&gt;<i>          */
</I>&gt;<i>         public int t;
</I>&gt;<i> 
</I>&gt;<i>         /**
</I>&gt;<i>          * the number of 1st associates of any element x.
</I>&gt;<i>          */
</I>&gt;<i>         public int n1;
</I>&gt;<i> 
</I>&gt;<i>         /**
</I>&gt;<i>          * The number of 2nd associates of any element x.
</I>&gt;<i>          */
</I>&gt;<i>         public int n2;
</I>&gt;<i> 
</I>&gt;<i>         /**
</I>&gt;<i>          *
</I>&gt;<i>          */
</I>&gt;<i>         public int lambda1;
</I>&gt;<i>         public int lambda2;
</I>&gt;<i>         public VarArray&lt;IntVar&gt; schemeCount;
</I>&gt;<i> 
</I>&gt;<i>         /**
</I>&gt;<i>          * @param opt
</I>&gt;<i>          *            Convenience object containing options
</I>&gt;<i>          * @see citadel.Options#toString()
</I>&gt;<i>          */
</I>&gt;<i>         public AssociationScheme(Options opt) {
</I>&gt;<i>                 super();
</I>&gt;<i>                 v = opt.size;
</I>&gt;<i>                 t = (v - 1) / 4;
</I>&gt;<i>                 n1 = (v - 1) / 2;
</I>&gt;<i>                 n2 = (v - 1) / 2;
</I>&gt;<i>                 lambda1 = 1;
</I>&gt;<i>                 lambda2 = 2;
</I>&gt;<i>                 schemeCount = new VarArray&lt;IntVar&gt;(this, v - 1,
</I>&gt;<i> IntVar.class, 1, 2);
</I>&gt;<i> 
</I>&gt;<i>                 // in the difference vector, constrain it so that
</I>&gt;<i>                 // the value of position i is the same as the value at
</I>&gt;<i> position v-i
</I>&gt;<i>                 // for a (v-1)-length array starting at (conceptual)
</I>index
&gt;<i> 1
</I>&gt;<i>                 // TODO: simplify the indexing in this constraint
</I>&gt;<i>                 for (int i = 1; i &lt;= v - 1; i++) {
</I>&gt;<i>                         rel(this, schemeCount.get(i - 1), IRT_EQ,
</I>&gt;<i> schemeCount
</I>&gt;<i>                                         .get(v - 1 - i), opt.icl);
</I>&gt;<i>                 }
</I>&gt;<i> 
</I>&gt;<i>                 // &quot;exactly n1 elements have the value lambda1 in
</I>&gt;<i> schemeCount&quot;
</I>&gt;<i>                 // &quot;exactly n2 elements have the value lambda2 in
</I>&gt;<i> schemeCount&quot;
</I>&gt;<i>                 count(this, schemeCount, lambda1, IRT_EQ, n1,
</I>opt.icl);
&gt;<i>                 count(this, schemeCount, lambda2, IRT_EQ, n2,
</I>opt.icl);
&gt;<i> 
</I>&gt;<i>                 /********************** begin autocorrelation code
</I>&gt;<i> ***************************/
</I>&gt;<i>                 /**                     what am I doing wrong below?
</I>&gt;<i> **/
</I>&gt;<i>                 /* each element of the autocorrelation sequence for
</I>&gt;<i> schemeCount
</I>&gt;<i>                 // must equal 2t-1 = ((v-1)/2) - 1
</I>&gt;<i>                 // autocorrelation is the cross-correlation of a
</I>sequence
&gt;<i> with a rotated copy
</I>&gt;<i>                 // of itself.
</I>&gt;<i>                 // An autocorrelation sequence is the sequence
</I>generated
&gt;<i> by
</I>&gt;<i> taking the
</I>&gt;<i>                 // cross-correlation for each rotation--the ith
</I>position
&gt;<i> in
</I>&gt;<i> the autocorrelation
</I>&gt;<i>                 // sequence is obtained by taking the
</I>cross-correlation of
&gt;<i> schemeCount with a
</I>&gt;<i>                 // copy of schemeCount rotated right i places (mod v).
</I>&gt;<i>                 // But I don't need a second copy of the sequence, I
</I>can
&gt;<i> just manipulate
</I>&gt;<i>                 // the indices. This is what I am trying to do below,
</I>but
&gt;<i> I
</I>&gt;<i> am  not getting
</I>&gt;<i>                  * the results I expect. Invalid solutions are being
</I>&gt;<i> accepted.
</I>&gt;<i>                  *
</I>&gt;<i>                  * The algorithm is to match schemeCount against a
</I>shifted
&gt;<i> copy of itself using
</I>&gt;<i>                  * the offset y, count the matches as 1, and the
</I>&gt;<i> mismatches
</I>&gt;<i> as 0,
</I>&gt;<i>                  * stored in the sequence Intersect0Y, then sum up all
</I>&gt;<i>                  *  the 1's in Intersect0Y, and finally,  constrain
</I>that
&gt;<i> the
</I>&gt;<i> sum must be 2t-1
</I>&gt;<i>                  *  for *each* shift 1...v-1.
</I>&gt;<i>                  * It works for v=5, but is broken for v=13.
</I>&gt;<i>                  * I suspect it only works for  v-5 because of the
</I>small
&gt;<i> space.
</I>&gt;<i>                  *
</I>&gt;<i>                  * If there is an easier way to write this constraint,
</I>&gt;<i>                  * I'm open to suggestions.
</I>&gt;<i>                  *
</I>&gt;<i>                  *  212211112212 is a valid solution for v=13.
</I>&gt;<i>                  *
</I>&gt;<i>                  *  Note, really the sequence is 0212211112212,
</I>&gt;<i>                  *  so rotated 5 places it looks like 1221202122111,
</I>&gt;<i>                  *  but since 0 matched with anything is 10, in this
</I>case,
&gt;<i>                  *  I'm trying to avoid prepending the 0 to
</I>schemeCount,
&gt;<i>                  *  which doesn't include it above.
</I>&gt;<i>                  *
</I>&gt;<i>                  */
</I>&gt;<i>                 for (int y = 1; y &lt; v; y++) {
</I>&gt;<i>                         VarArray&lt;BoolVar&gt; intersectY0 = new
</I>&gt;<i> VarArray&lt;BoolVar&gt;(this, v - 1,
</I>&gt;<i>                                         BoolVar.class);
</I>&gt;<i>                         for (int x = 1; x &lt; v; x++) {
</I>&gt;<i>                                 if (x == y) {
</I>&gt;<i>                                         continue;
</I>&gt;<i>                                 }
</I>&gt;<i>                                 int z = ((x - y + v) % v)-1;
</I>&gt;<i>                                 eq(this, schemeCount.get(y-1),
</I>&gt;<i> schemeCount.get(z), intersectY0
</I>&gt;<i>                                                 .get(x-1), opt.icl);
</I>&gt;<i>                         } // end for x
</I>&gt;<i> 
</I>&gt;<i>                         VarArray&lt;IntVar&gt; pijk = new
</I>&gt;<i> VarArray&lt;IntVar&gt;(intersectY0);
</I>&gt;<i>                         // exactly 2t-1 elements have the value 1 in
</I>pijk
&gt;<i>                         count(this, pijk, 1, IRT_EQ, 2 * t - 1,
</I>opt.icl);
&gt;<i>                 } // end for y
</I>&gt;<i> 
</I>&gt;<i>                 /*********************** end autocorrelation code
</I>&gt;<i> **************************/
</I>&gt;<i>                 branch(this, schemeCount, BVAR_SIZE_MIN, BVAL_MIN);
</I>&gt;<i>         }
</I>&gt;<i> 
</I>&gt;<i>         /**
</I>&gt;<i>          * Copy constructor.
</I>&gt;<i>          *
</I>&gt;<i>          * @param share
</I>&gt;<i>          * @param scheme
</I>&gt;<i>          */
</I>&gt;<i>         public AssociationScheme(Boolean share, AssociationScheme
</I>scheme)
&gt;<i> {
</I>&gt;<i>                 super(share, scheme);
</I>&gt;<i>                 v = scheme.v;
</I>&gt;<i>                 t= (v-1)/4;
</I>&gt;<i>                 n1 = (v - 1) / 2;
</I>&gt;<i>                 n2 = (v - 1) / 2;
</I>&gt;<i>                 lambda1 = 1;
</I>&gt;<i>                 lambda2 = 2;
</I>&gt;<i>                 schemeCount = new VarArray&lt;IntVar&gt;(this, share,
</I>&gt;<i> scheme.schemeCount);
</I>&gt;<i>         }
</I>&gt;<i> 
</I>&gt;<i>         /**
</I>&gt;<i>          *
</I>&gt;<i>          * @see org.gecode.Space#toString()
</I>&gt;<i>          */
</I>&gt;<i>         public String toString() {
</I>&gt;<i> 
</I>&gt;<i>                 return schemeCount.toString();
</I>&gt;<i>         }
</I>&gt;<i> 
</I>&gt;<i>         /**
</I>&gt;<i>          * Application startup
</I>&gt;<i>          *
</I>&gt;<i>          * @param args
</I>&gt;<i>          */
</I>&gt;<i>         public static void main(String[] args) {
</I>&gt;<i>                 Options opt = new Options();
</I>&gt;<i>                 opt.size = 5;
</I>&gt;<i>                 opt.gui = true;
</I>&gt;<i>                 opt.parse(args);
</I>&gt;<i>                 opt.name = &quot;&quot; + opt.size + &quot;-Schemes&quot;;
</I>&gt;<i> 
</I>&gt;<i>                 AssociationScheme schemes = new
</I>AssociationScheme(opt);
&gt;<i>                 opt.doSearch(schemes);
</I>&gt;<i>         }
</I>&gt;<i> }
</I>&gt;<i> --------------------- end code -------------------
</I>

_______________________________________________
Gecode users mailing list
<A HREF="https://www.ps.uni-sb.de/mailman/listinfo/users">users at gecode.org</A>
<A HREF="https://www.gecode.org/mailman/listinfo/gecode-users">https://www.gecode.org/mailman/listinfo/gecode-users</A>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001093.html">[gecode-users] Help:How to compute Autocorrelation of a	v-length sequence
</A></li>
	<LI>Next message: <A HREF="001095.html">[gecode-users] gecode autoconf setting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1094">[ date ]</a>
              <a href="thread.html#1094">[ thread ]</a>
              <a href="subject.html#1094">[ subject ]</a>
              <a href="author.html#1094">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://www.ps.uni-sb.de/mailman/listinfo/users">More information about the gecode-users
mailing list</a><br>
</body></html>
