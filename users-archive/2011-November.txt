From kisshen at cisco.com  Thu Nov  3 18:36:02 2011
From: kisshen at cisco.com (Kish Shen)
Date: Thu, 03 Nov 2011 17:36:02 +0000
Subject: [gecode-users] sorted constraint seg faults with empty arrays
Message-ID: <4EB2D102.2070405@cisco.com>

Hi,

I am getting a segmentation fault when using the sorted constraint with 
empty IntVarArgs arrays (i.e. size of the array is zero).

I found this when I was producing unit tests for the sorted constraint 
for the ECLiPSe Gecode interface. One of the thing I test for is for the 
variable array(s) being empty, because I expect the arguments to the 
constraints to be generated by the user's program, and it could be that 
this may result in no variables being involved in the constructed 
constraint. Originally I used to check if such arrays are empty, and 
raise an error at the ECLiPSe level if it is, so the Gecode constraint 
was never called with an empty array, but I was sent a program from one 
of our users who tried to call the lexicographical ordering constraints 
with empty arrays, and when I did pass the empty array to Gecode, it 
seem to cope without problems.

With the sorted constraint, I get a seg. fault. I am using

sort(home, x, y)

where both x and y are IntVarArgs of size 0, which should just succeed 
trivially, but it seems that the seg fault happens during the calling of 
sort().

This is the first constraint that I have run into problems with using 
size 0 IntVarArgs -- I have tested quite a few other constraints so far, 
and until now they have all worked.

I am using Gecode 3.7.1, and I tried on both 32 bit Linux and 64 bit 
Intel Mac.

Cheers,

Kish

-- 
This e-mail may contain confidential and privileged material for the
sole use of the intended recipient. Any review, use, distribution or
disclosure by others is strictly prohibited. If you are not the intended
recipient (or authorized to receive for the recipient), please contact
the sender by reply e-mail and delete all copies of this message.
Cisco Systems Limited (Company Number: 02558939), is registered in
England and Wales with its registered office at 1 Callaghan Square,
Cardiff, South Glamorgan CF10 5BT.


From filip.konvicka at logis.cz  Thu Nov  3 19:11:12 2011
From: filip.konvicka at logis.cz (=?UTF-8?B?RmlsaXAgS29udmnEjWth?=)
Date: Thu, 03 Nov 2011 19:11:12 +0100
Subject: [gecode-users] Gecode 4.0.0
In-Reply-To: <006b01cc8a72$69968a00$3cc39e00$@se>
References: <006501cc8a71$900c6250$b02526f0$@se>
	<006b01cc8a72$69968a00$3cc39e00$@se>
Message-ID: <j8ulfq$7i7$1@dough.gmane.org>

Christian,

Sorry to reply so late...

The list of features sounds great, especially the symmetry breaking 
(though I admit that I haven't looked at the propagator groups yet).

Gonzalo from the AVISPA team contacted me in May regarding the Float 
Vars work they were doing, but I haven't heard from them since.  Do you 
have any information on this? Are you counting on using their 
implementation? Or do you plan to do this yourself?

Thanks,
Filip

> Damn it, there are two pieces of information missing...
>
> Timeline: we aim at the second quarter of 2012 for Gecode 4.0.0. But today I
> went through some older emails (written when we discussed what Gecode 3.*
> should be) and there I wrote that Gecode 4 should be around end of 2009.
> Okay, still trust me! This time everything is much different ;-) Just
> kidding.
>
> Then, of course: Is there something that we absolutely must do for our
> users?
>
> Christian
>
> --
> Christian Schulte, www.ict.kth.se/~cschulte/
>
>
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
> Of Christian Schulte
> Sent: Friday, October 14, 2011 3:03 PM
> To: users at gecode.org
> Subject: [gecode-users] Gecode 4.0.0
>
> Dear all,
>
> As this year has already a number of releases of Gecode from the 3.* version
> series we have decided to slow the pace and prepare for Gecode 4.0.0 as the
> next major release.
>
> This mail is just to assure you that we are not dormant but that it will
> take longer before the next version appears. If there is the need for a bug
> fix release we will of course do that in the meantime.
>
> Our current plan is to include the following features:
>
> - Integrate propagator groups, see here:
> 	
> http://web.it.kth.se/~cschulte/paper.php?id=LagerkvistSchulte:CP:2009
>
> - Integrate lightweight dynamic symmetry breaking, see here:
> 	Lightweight Dynamic Symmetry Breaking.  C. Mears, M. Garcia de la
> Banda, B. Demoen, M. Wallace.
>       SymCon'08.
>     LDSB is a dynamic symmetry breaking method designed to handle
>     common symmetries efficiently under any variable and value
>     ordering.
>
> - Integrate float variables
>
> - Provide modeling layer for float variables
>
> - Support for restarts during search and large neighborhood search
>
> - Make randomized tie-breaking more flexible
>
> - Modeling layer for scheduling constraints
>
> - Branching for scheduling problems
>
>
> Some more speculative things that might or might not make it are:
>
> - Integrate discrepancy-based search that is not LDS (?)
>
> - Half-reification, see here:
> 	Thibaut Feydy, Zoltan Somogyi, Peter J. Stuckey: Half Reification
> and Flattening. CP 2011: 286-301
>
> - Redundancy analysis, see here:
> 	http://web.it.kth.se/~cschulte/paper.php?id=SchulteStuckey:PPDP:2008
>
> Best
> Christian
>
> --
> Christian Schulte, www.ict.kth.se/~cschulte/
>
>
>
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users




From tack at gecode.org  Thu Nov  3 20:16:17 2011
From: tack at gecode.org (Guido Tack)
Date: Thu, 3 Nov 2011 20:16:17 +0100
Subject: [gecode-users] sorted constraint seg faults with empty arrays
In-Reply-To: <4EB2D102.2070405@cisco.com>
References: <4EB2D102.2070405@cisco.com>
Message-ID: <42A699D3-DCA0-4642-89A4-C64669EF60E9@gecode.org>

Thanks, Kish.  I just fixed it in the svn trunk.

Cheers,
Guido

-- 
Guido Tack, http://people.cs.kuleuven.be/~guido.tack/




On 3 Nov 2011, at 18:36, Kish Shen wrote:

> Hi,
> 
> I am getting a segmentation fault when using the sorted constraint with empty IntVarArgs arrays (i.e. size of the array is zero).
> 
> I found this when I was producing unit tests for the sorted constraint for the ECLiPSe Gecode interface. One of the thing I test for is for the variable array(s) being empty, because I expect the arguments to the constraints to be generated by the user's program, and it could be that this may result in no variables being involved in the constructed constraint. Originally I used to check if such arrays are empty, and raise an error at the ECLiPSe level if it is, so the Gecode constraint was never called with an empty array, but I was sent a program from one of our users who tried to call the lexicographical ordering constraints with empty arrays, and when I did pass the empty array to Gecode, it seem to cope without problems.
> 
> With the sorted constraint, I get a seg. fault. I am using
> 
> sort(home, x, y)
> 
> where both x and y are IntVarArgs of size 0, which should just succeed trivially, but it seems that the seg fault happens during the calling of sort().
> 
> This is the first constraint that I have run into problems with using size 0 IntVarArgs -- I have tested quite a few other constraints so far, and until now they have all worked.
> 
> I am using Gecode 3.7.1, and I tried on both 32 bit Linux and 64 bit Intel Mac.
> 
> Cheers,
> 
> Kish
> 
> -- 
> This e-mail may contain confidential and privileged material for the
> sole use of the intended recipient. Any review, use, distribution or
> disclosure by others is strictly prohibited. If you are not the intended
> recipient (or authorized to receive for the recipient), please contact
> the sender by reply e-mail and delete all copies of this message.
> Cisco Systems Limited (Company Number: 02558939), is registered in
> England and Wales with its registered office at 1 Callaghan Square,
> Cardiff, South Glamorgan CF10 5BT.
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users



From serge.lemouton at ircam.fr  Thu Nov  3 22:23:51 2011
From: serge.lemouton at ircam.fr (serge lemouton)
Date: Thu, 3 Nov 2011 22:23:51 +0100
Subject: [gecode-users] still looking for an example of path constraints
In-Reply-To: <5D0E51F7-719C-4485-BD06-8933BCFD7FB2@ircam.fr>
References: <FCC2A572-8EC6-41DF-9C86-98A231AD791E@ircam.fr>
	<00c501cc930e$a51cb910$ef562b30$@se>
	<5D0E51F7-719C-4485-BD06-8933BCFD7FB2@ircam.fr>
Message-ID: <C91494DA-DD83-4C38-B589-4A09B85E1868@ircam.fr>

Hello,

I have slightly modified the tsp example to test the path constraint by adding a "model" option to the script.
No solution is found with the -model path option : why ?
Here is the modified code:

-------------- next part --------------
A non-text attachment was scrubbed...
Name: tsp2.cpp
Type: application/octet-stream
Size: 12612 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20111103/4c6dfecd/attachment.obj>
-------------- next part --------------


Thanks for any hint,

Yours,

Serge

On 25 oct. 2011, at 23:58, serge lemouton wrote:

> Hello, 
> 
> I know that, and that is exactly what I was looking for !
> But if it exists an hamiltonian circuit with n edges, it should exist at least n path with n-1 edges, right ?
> and I don't know how to search those with the Gecode "path" constraint ...
> Could you provide an example, please ?
> 
> Thanks in advance,
> 
> Serge
> 
> 
> 
> On 25 oct. 2011, at 14:07, Christian Schulte wrote:
> 
>> Hi,
>> 
>> Please check the meaning of path again in the documentation: it enforces a
>> path and not a circuit!
>> 
>> Christian
>> 
>> --
>> Christian Schulte, www.ict.kth.se/~cschulte/
>> 
>> 
>> -----Original Message-----
>> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
>> Of serge lemouton
>> Sent: Saturday, October 22, 2011 5:59 PM
>> To: users at gecode.org
>> Subject: [gecode-users] looking for an example of path constraints
>> 
>> Hi all,
>> 
>> I am trying to use the new path constraints with the cost matrix, but
>> without any success, yet.
>> 
>> In the TSP example script, why simply replacing the  
>> 
>> 	circuit(*this, c, succ, costs, total, opt.icl());
>> 		 by
>> 	 path(*this, c, succ, start, end,costs, total, opt.icl());
>> 
>> does'nt find any solution ?
>> 
>> Thanks for any hint,
>> 
>> Serge Lemouton
>> _______________________________________________
>> Gecode users mailing list
>> users at gecode.org
>> https://www.gecode.org/mailman/listinfo/gecode-users
>> 
>> 
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
> 


From cschulte at kth.se  Thu Nov  3 23:03:53 2011
From: cschulte at kth.se (Christian Schulte)
Date: Thu, 3 Nov 2011 23:03:53 +0100
Subject: [gecode-users] still looking for an example of path constraints
In-Reply-To: <C91494DA-DD83-4C38-B589-4A09B85E1868@ircam.fr>
References: <FCC2A572-8EC6-41DF-9C86-98A231AD791E@ircam.fr>
	<00c501cc930e$a51cb910$ef562b30$@se>
	<5D0E51F7-719C-4485-BD06-8933BCFD7FB2@ircam.fr>
	<C91494DA-DD83-4C38-B589-4A09B85E1868@ircam.fr>
Message-ID: <000601cc9a74$7a332dc0$6e998940$@kth.se>

Let me be plain here: there is no point in looking into this until you
understand the difference between a path and a cycle.

 

Sorry but I just do not have enough time for the obvious

Christian

 

--

Christian Schulte, KTH, web.it.kth.se/~cschulte/

 

From: serge lemouton [mailto:serge.lemouton at ircam.fr] 
Sent: Thursday, November 03, 2011 10:24 PM
To: users at gecode.org
Cc: Christian Schulte
Subject: Re: [gecode-users] still looking for an example of path constraints

 

Hello,

I have slightly modified the tsp example to test the path constraint by
adding a "model" option to the script.
No solution is found with the -model path option : why ?
Here is the modified code:



Thanks for any hint,

Yours,

Serge

On 25 oct. 2011, at 23:58, serge lemouton wrote:

> Hello, 
> 
> I know that, and that is exactly what I was looking for !
> But if it exists an hamiltonian circuit with n edges, it should exist at
least n path with n-1 edges, right ?
> and I don't know how to search those with the Gecode "path" constraint ...
> Could you provide an example, please ?
> 
> Thanks in advance,
> 
> Serge
> 
> 
> 
> On 25 oct. 2011, at 14:07, Christian Schulte wrote:
> 
>> Hi,
>> 
>> Please check the meaning of path again in the documentation: it enforces
a
>> path and not a circuit!
>> 
>> Christian
>> 
>> --
>> Christian Schulte, www.ict.kth.se/~cschulte/
>> 
>> 
>> -----Original Message-----
>> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On
Behalf
>> Of serge lemouton
>> Sent: Saturday, October 22, 2011 5:59 PM
>> To: users at gecode.org
>> Subject: [gecode-users] looking for an example of path constraints
>> 
>> Hi all,
>> 
>> I am trying to use the new path constraints with the cost matrix, but
>> without any success, yet.
>> 
>> In the TSP example script, why simply replacing the  
>> 
>>       circuit(*this, c, succ, costs, total, opt.icl());
>>                by
>>        path(*this, c, succ, start, end,costs, total, opt.icl());
>> 
>> does'nt find any solution ?
>> 
>> Thanks for any hint,
>> 
>> Serge Lemouton
>> _______________________________________________
>> Gecode users mailing list
>> users at gecode.org
>> https://www.gecode.org/mailman/listinfo/gecode-users
>> 
>> 
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20111103/c3f20afc/attachment-0001.htm>

From cschulte at kth.se  Fri Nov  4 11:29:17 2011
From: cschulte at kth.se (Christian Schulte)
Date: Fri, 4 Nov 2011 11:29:17 +0100
Subject: [gecode-users] Gecode 4.0.0
In-Reply-To: <j8ulfq$7i7$1@dough.gmane.org>
References: <006501cc8a71$900c6250$b02526f0$@se>	<006b01cc8a72$69968a00$3cc39e00$@se>
	<j8ulfq$7i7$1@dough.gmane.org>
Message-ID: <00b001cc9adc$9c7c82b0$d5758810$@se>

Hi Filip,

I started some time ago to look into the FloatVar stuff but then I got
contacted by Vincent Barichard about that. Vincent expressed his interest
and has already arrived at a second prototype. I am quite positive that this
will lead to a good module for 4.*.

Vincent, maybe you can describe the status so far.

Best
Christian


--
Christian Schulte, www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Filip Konvicka
Sent: Thursday, November 03, 2011 7:11 PM
To: users at gecode.org
Subject: Re: [gecode-users] Gecode 4.0.0

Christian,

Sorry to reply so late...

The list of features sounds great, especially the symmetry breaking (though
I admit that I haven't looked at the propagator groups yet).

Gonzalo from the AVISPA team contacted me in May regarding the Float Vars
work they were doing, but I haven't heard from them since.  Do you have any
information on this? Are you counting on using their implementation? Or do
you plan to do this yourself?

Thanks,
Filip

> Damn it, there are two pieces of information missing...
>
> Timeline: we aim at the second quarter of 2012 for Gecode 4.0.0. But 
> today I went through some older emails (written when we discussed what 
> Gecode 3.* should be) and there I wrote that Gecode 4 should be around end
of 2009.
> Okay, still trust me! This time everything is much different ;-) Just 
> kidding.
>
> Then, of course: Is there something that we absolutely must do for our 
> users?
>
> Christian
>
> --
> Christian Schulte, www.ict.kth.se/~cschulte/
>
>
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On 
> Behalf Of Christian Schulte
> Sent: Friday, October 14, 2011 3:03 PM
> To: users at gecode.org
> Subject: [gecode-users] Gecode 4.0.0
>
> Dear all,
>
> As this year has already a number of releases of Gecode from the 3.* 
> version series we have decided to slow the pace and prepare for Gecode 
> 4.0.0 as the next major release.
>
> This mail is just to assure you that we are not dormant but that it 
> will take longer before the next version appears. If there is the need 
> for a bug fix release we will of course do that in the meantime.
>
> Our current plan is to include the following features:
>
> - Integrate propagator groups, see here:
> 	
> http://web.it.kth.se/~cschulte/paper.php?id=LagerkvistSchulte:CP:2009
>
> - Integrate lightweight dynamic symmetry breaking, see here:
> 	Lightweight Dynamic Symmetry Breaking.  C. Mears, M. Garcia de la 
> Banda, B. Demoen, M. Wallace.
>       SymCon'08.
>     LDSB is a dynamic symmetry breaking method designed to handle
>     common symmetries efficiently under any variable and value
>     ordering.
>
> - Integrate float variables
>
> - Provide modeling layer for float variables
>
> - Support for restarts during search and large neighborhood search
>
> - Make randomized tie-breaking more flexible
>
> - Modeling layer for scheduling constraints
>
> - Branching for scheduling problems
>
>
> Some more speculative things that might or might not make it are:
>
> - Integrate discrepancy-based search that is not LDS (?)
>
> - Half-reification, see here:
> 	Thibaut Feydy, Zoltan Somogyi, Peter J. Stuckey: Half Reification
and 
> Flattening. CP 2011: 286-301
>
> - Redundancy analysis, see here:
> 	http://web.it.kth.se/~cschulte/paper.php?id=SchulteStuckey:PPDP:2008
>
> Best
> Christian
>
> --
> Christian Schulte, www.ict.kth.se/~cschulte/
>
>
>
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users



_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From David.Rijsman at quintiq.com  Fri Nov  4 11:43:46 2011
From: David.Rijsman at quintiq.com (David Rijsman)
Date: Fri, 04 Nov 2011 11:43:46 +0100
Subject: [gecode-users] assert in propagator cast
In-Reply-To: <015e01cc932d$71905ec0$54b11c40$@kth.se>
References: <4EA58552020000850001B23A@mail.quintiq.nl>
	<015e01cc932d$71905ec0$54b11c40$@kth.se>
Message-ID: <4EB3CFF2020000850001B647@mail.quintiq.nl>

Hi Christian,

a little bit delayed but yes you are pretty close with your guessing. I do step 1 and step 2 I do cancel the subscription. Also in the dispose method of the propagator I invoke the dispose method of the council. 

Should I also cancel all the subscriptions of the variables to the advisors in the propagators dispose although I invoke the dispose on the council? I checked the dispose of the council and it also invokes the dispose of the advisors which in my case do cancel the subscriptions.

In the example  in gecode/int/bool/or.hpp you are using the advisor type Advisor in which the cancellation does not take place (in my case it does in the specialized implementation of dispose) so I understand the need to explicitly do it in the dispose of the propagator in your case. But I do not see it in my case....

To give you a little more background, I have a propagator working on tasks, each task has five variables of which one is a boolean. When the boolean becomes false I want to dispose all the advisors on all the five variables associated with this task. When the boolean becomes false, in the advise of the propagator I iterate over all the advisors in the council, cast them to my advisor type, ask the advisor if it belongs to the same task as the boolean, if so it is disposed. I had made an optimization which would stop iterating over the advisors once it disposed  four, this is a mistake as it could have found the advisor of the boolean itself and dispose it, now if I exclude the explicit disposal of the advisor of the boolean variable the problem no longer occurs. I am a little puzzled here how this is related to the assert being raised (a double disposal also raises an assert and I do not see this), I will continue my search but if you have any suggestions that would be great,

Another question for my understanding, who is (responsible for) disposing the advisor when a variable becomes assigned?

thanks,

David Rijsman

>>> 
From: 	"Christian Schulte" <cschulte at kth.se>
To:	"'David Rijsman'" <David.Rijsman at quintiq.com>, <users at gecode.org>
Date: 	10/25/2011 5:48 PM
Subject: 	Re: [gecode-users] assert in propagator cast

Hi David,

Let me do some guessing here:

1) You are using a propagator that uses advisors.
2) The dispose method of your advisors does not unsubscribe the advisor from
the view.
3) The propagator's dispose method disposes the advisors' council without
deleting the advisors subscriptions

Bang! Is that correct?

If yes, there are two ways to fix it:
a) The dispose method of the advisors also unsubscribes, or
b) In the propagator's dispose method you iterate over all advisors and
unsubscribe (The iterator is called Advisors<A> where A is the type of the
advisor). You might want to search for Advisors in gecode/int/bool/or.hpp
for an example.

I hope that helps!

Best
Christian

PS: Sorry for the delay, I was travelling.

--
Christian Schulte, KTH, web.it.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of David Rijsman
Sent: Monday, October 24, 2011 3:34 PM
To: users at gecode.org 
Subject: [gecode-users] assert in propagator cast

I need some help with an assert being thrown by Gecode, hopefully by an
error I made in a propagator I have created. Is there an obvious candidate
for an error I made in my propagator when this assert is thrown?

The assert is thrown in core.hpp

  forceinline Propagator&
  Advisor::propagator(void) const {
    assert(!disposed());
    return *Propagator::cast(ActorLink::prev());
  }

as a result of an invocation of  Advisor::cast(*a)->propagator().afc() in:


  template<class VIC>
  forceinline double
  VarImp<VIC>::afc(void) const {
    if (degree() == 0)
      return 0.0;
    double d = degree();
    // Count the afc of each propagator
    {
      ActorLink** a = const_cast<VarImp<VIC>*>(this)->actor(0);
      ActorLink** e =
const_cast<VarImp<VIC>*>(this)->actorNonZero(pc_max+1);
      while (a < e) {
        d += Propagator::cast(*a)->afc(); a++;
      }
    }
    // Count the afc of each advisor's propagator
    {
      ActorLink** a =
const_cast<VarImp<VIC>*>(this)->actorNonZero(pc_max+1);
      ActorLink** e = const_cast<VarImp<VIC>*>(this)->base+entries;
      while (a < e) {
        d += Advisor::cast(*a)->propagator().afc(); a++;
      }
    }
    return d;
  }

thanks,

David Rijsman


_______________________________________________
Gecode users mailing list
users at gecode.org 
https://www.gecode.org/mailman/listinfo/gecode-users 


_______________________________________________
Gecode users mailing list
users at gecode.org 
https://www.gecode.org/mailman/listinfo/gecode-users 



From cschulte at kth.se  Fri Nov  4 12:48:17 2011
From: cschulte at kth.se (Christian Schulte)
Date: Fri, 4 Nov 2011 12:48:17 +0100
Subject: [gecode-users] assert in propagator cast
In-Reply-To: <4EB3CFF2020000850001B647@mail.quintiq.nl>
References: <4EA58552020000850001B23A@mail.quintiq.nl>	<015e01cc932d$71905ec0$54b11c40$@kth.se>
	<4EB3CFF2020000850001B647@mail.quintiq.nl>
Message-ID: <00c501cc9ae7$a5a94ac0$f0fbe040$@se>

Hi David,

Ok, let's see: when the Boolean variable becomes assigned you dispose the
advisors. But do you also cancel the subscriptions?

As you correctly observed, some advisors have a dispose function that also
does the cancel. If an advisor has a dispose function that does not cancel,
then the cancel has to be done manually.

For assigned views, subscriptions do not need to be cancelled but advisors
still must be disposed. You might do that in the advise() function or in the
dispose() function but have to be careful to only do it once!

Please let me know whether this helps.

Best
Christian

--
Christian Schulte, www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of David Rijsman
Sent: Friday, November 04, 2011 11:44 AM
To: users at gecode.org; cschulte at kth.se
Subject: Re: [gecode-users] assert in propagator cast

Hi Christian,

a little bit delayed but yes you are pretty close with your guessing. I do
step 1 and step 2 I do cancel the subscription. Also in the dispose method
of the propagator I invoke the dispose method of the council. 

Should I also cancel all the subscriptions of the variables to the advisors
in the propagators dispose although I invoke the dispose on the council? I
checked the dispose of the council and it also invokes the dispose of the
advisors which in my case do cancel the subscriptions.

In the example  in gecode/int/bool/or.hpp you are using the advisor type
Advisor in which the cancellation does not take place (in my case it does in
the specialized implementation of dispose) so I understand the need to
explicitly do it in the dispose of the propagator in your case. But I do not
see it in my case....

To give you a little more background, I have a propagator working on tasks,
each task has five variables of which one is a boolean. When the boolean
becomes false I want to dispose all the advisors on all the five variables
associated with this task. When the boolean becomes false, in the advise of
the propagator I iterate over all the advisors in the council, cast them to
my advisor type, ask the advisor if it belongs to the same task as the
boolean, if so it is disposed. I had made an optimization which would stop
iterating over the advisors once it disposed  four, this is a mistake as it
could have found the advisor of the boolean itself and dispose it, now if I
exclude the explicit disposal of the advisor of the boolean variable the
problem no longer occurs. I am a little puzzled here how this is related to
the assert being raised (a double disposal also raises an assert and I do
not see this), I will continue my search but if you have any suggestions
that would be great,

Another question for my understanding, who is (responsible for) disposing
the advisor when a variable becomes assigned?

thanks,

David Rijsman

>>> 
From: 	"Christian Schulte" <cschulte at kth.se>
To:	"'David Rijsman'" <David.Rijsman at quintiq.com>, <users at gecode.org>
Date: 	10/25/2011 5:48 PM
Subject: 	Re: [gecode-users] assert in propagator cast

Hi David,

Let me do some guessing here:

1) You are using a propagator that uses advisors.
2) The dispose method of your advisors does not unsubscribe the advisor from
the view.
3) The propagator's dispose method disposes the advisors' council without
deleting the advisors subscriptions

Bang! Is that correct?

If yes, there are two ways to fix it:
a) The dispose method of the advisors also unsubscribes, or
b) In the propagator's dispose method you iterate over all advisors and
unsubscribe (The iterator is called Advisors<A> where A is the type of the
advisor). You might want to search for Advisors in gecode/int/bool/or.hpp
for an example.

I hope that helps!

Best
Christian

PS: Sorry for the delay, I was travelling.

--
Christian Schulte, KTH, web.it.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of David Rijsman
Sent: Monday, October 24, 2011 3:34 PM
To: users at gecode.org
Subject: [gecode-users] assert in propagator cast

I need some help with an assert being thrown by Gecode, hopefully by an
error I made in a propagator I have created. Is there an obvious candidate
for an error I made in my propagator when this assert is thrown?

The assert is thrown in core.hpp

  forceinline Propagator&
  Advisor::propagator(void) const {
    assert(!disposed());
    return *Propagator::cast(ActorLink::prev());
  }

as a result of an invocation of  Advisor::cast(*a)->propagator().afc() in:


  template<class VIC>
  forceinline double
  VarImp<VIC>::afc(void) const {
    if (degree() == 0)
      return 0.0;
    double d = degree();
    // Count the afc of each propagator
    {
      ActorLink** a = const_cast<VarImp<VIC>*>(this)->actor(0);
      ActorLink** e =
const_cast<VarImp<VIC>*>(this)->actorNonZero(pc_max+1);
      while (a < e) {
        d += Propagator::cast(*a)->afc(); a++;
      }
    }
    // Count the afc of each advisor's propagator
    {
      ActorLink** a =
const_cast<VarImp<VIC>*>(this)->actorNonZero(pc_max+1);
      ActorLink** e = const_cast<VarImp<VIC>*>(this)->base+entries;
      while (a < e) {
        d += Advisor::cast(*a)->propagator().afc(); a++;
      }
    }
    return d;
  }

thanks,

David Rijsman


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users 


_______________________________________________
Gecode users mailing list
users at gecode.org 
https://www.gecode.org/mailman/listinfo/gecode-users 


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From tack at gecode.org  Fri Nov  4 13:32:13 2011
From: tack at gecode.org (Guido Tack)
Date: Fri, 4 Nov 2011 13:32:13 +0100
Subject: [gecode-users] still looking for an example of path constraints
In-Reply-To: <C91494DA-DD83-4C38-B589-4A09B85E1868@ircam.fr>
References: <FCC2A572-8EC6-41DF-9C86-98A231AD791E@ircam.fr>
	<00c501cc930e$a51cb910$ef562b30$@se>
	<5D0E51F7-719C-4485-BD06-8933BCFD7FB2@ircam.fr>
	<C91494DA-DD83-4C38-B589-4A09B85E1868@ircam.fr>
Message-ID: <FAAC8627-0EFF-41AC-B538-5C9C5D10F52B@gecode.org>

On 3 Nov 2011, at 22:23, serge lemouton wrote:

> Hello,
> 
> I have slightly modified the tsp example to test the path constraint by adding a "model" option to the script.
> No solution is found with the -model path option : why ?

Have a look at the documentation for path: succ[e]==succ.size(), so the domains must be 0..succ.size() instead of 0..succ.size()-1.

Cheers,
Guido

> Here is the modified code:
> 
> <tsp2.cpp>
> 
> Thanks for any hint,
> 
> Yours,
> 
> Serge
> 
> On 25 oct. 2011, at 23:58, serge lemouton wrote:
> 
>> Hello, 
>> 
>> I know that, and that is exactly what I was looking for !
>> But if it exists an hamiltonian circuit with n edges, it should exist at least n path with n-1 edges, right ?
>> and I don't know how to search those with the Gecode "path" constraint ...
>> Could you provide an example, please ?
>> 
>> Thanks in advance,
>> 
>> Serge
>> 
>> 
>> 
>> On 25 oct. 2011, at 14:07, Christian Schulte wrote:
>> 
>>> Hi,
>>> 
>>> Please check the meaning of path again in the documentation: it enforces a
>>> path and not a circuit!
>>> 
>>> Christian
>>> 
>>> --
>>> Christian Schulte, www.ict.kth.se/~cschulte/
>>> 
>>> 
>>> -----Original Message-----
>>> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
>>> Of serge lemouton
>>> Sent: Saturday, October 22, 2011 5:59 PM
>>> To: users at gecode.org
>>> Subject: [gecode-users] looking for an example of path constraints
>>> 
>>> Hi all,
>>> 
>>> I am trying to use the new path constraints with the cost matrix, but
>>> without any success, yet.
>>> 
>>> In the TSP example script, why simply replacing the  
>>> 
>>> 	circuit(*this, c, succ, costs, total, opt.icl());
>>> 		 by
>>> 	 path(*this, c, succ, start, end,costs, total, opt.icl());
>>> 
>>> does'nt find any solution ?
>>> 
>>> Thanks for any hint,
>>> 
>>> Serge Lemouton
>>> _______________________________________________
>>> Gecode users mailing list
>>> users at gecode.org
>>> https://www.gecode.org/mailman/listinfo/gecode-users
>>> 
>>> 
>> 
>> 
>> _______________________________________________
>> Gecode users mailing list
>> users at gecode.org
>> https://www.gecode.org/mailman/listinfo/gecode-users
>> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users

-- 
Guido Tack, http://people.cs.kuleuven.be/~guido.tack/







From David.Rijsman at quintiq.com  Fri Nov  4 14:53:51 2011
From: David.Rijsman at quintiq.com (David Rijsman)
Date: Fri, 04 Nov 2011 14:53:51 +0100
Subject: [gecode-users] assert in propagator cast
In-Reply-To: <00c501cc9ae7$a5a94ac0$f0fbe040$@se>
References: <4EA58552020000850001B23A@mail.quintiq.nl>
	<015e01cc932d$71905ec0$54b11c40$@kth.se>
	<4EB3CFF2020000850001B647@mail.quintiq.nl>
	<00c501cc9ae7$a5a94ac0$f0fbe040$@se>
Message-ID: <4EB3FC7F020000850001B660@mail.quintiq.nl>

Hi Christian,

in my case the dispose of the advisor is the one that cancels the subscription to the variable.  The dispose of the propagator is the one that disposes the council (and the council disposes the advisors still in the council). So I think I dispose (and cancel) enough. The assert was raised when I only disposed 4 (any subset) out of 5 of the advisors related to a task for which the boolean turned false. I fixed this to 5 and the problem no longer happens. I just can not figure out why the assert was raised especially it should not hurt to wait with disposing of an individual advisor until the council disposes. I will keep searching and post when I find something,

David Rijsman

>>> 
From: 	"Christian Schulte" <cschulte at kth.se>
To:	"'David Rijsman'" <David.Rijsman at quintiq.com>, <users at gecode.org>
Date: 	11/4/2011 12:50 PM
Subject: 	RE: [gecode-users] assert in propagator cast

Hi David,

Ok, let's see: when the Boolean variable becomes assigned you dispose the
advisors. But do you also cancel the subscriptions?

As you correctly observed, some advisors have a dispose function that also
does the cancel. If an advisor has a dispose function that does not cancel,
then the cancel has to be done manually.

For assigned views, subscriptions do not need to be cancelled but advisors
still must be disposed. You might do that in the advise() function or in the
dispose() function but have to be careful to only do it once!

Please let me know whether this helps.

Best
Christian

--
Christian Schulte, www.ict.kth.se/~cschulte/ 


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of David Rijsman
Sent: Friday, November 04, 2011 11:44 AM
To: users at gecode.org; cschulte at kth.se 
Subject: Re: [gecode-users] assert in propagator cast

Hi Christian,

a little bit delayed but yes you are pretty close with your guessing. I do
step 1 and step 2 I do cancel the subscription. Also in the dispose method
of the propagator I invoke the dispose method of the council. 

Should I also cancel all the subscriptions of the variables to the advisors
in the propagators dispose although I invoke the dispose on the council? I
checked the dispose of the council and it also invokes the dispose of the
advisors which in my case do cancel the subscriptions.

In the example  in gecode/int/bool/or.hpp you are using the advisor type
Advisor in which the cancellation does not take place (in my case it does in
the specialized implementation of dispose) so I understand the need to
explicitly do it in the dispose of the propagator in your case. But I do not
see it in my case....

To give you a little more background, I have a propagator working on tasks,
each task has five variables of which one is a boolean. When the boolean
becomes false I want to dispose all the advisors on all the five variables
associated with this task. When the boolean becomes false, in the advise of
the propagator I iterate over all the advisors in the council, cast them to
my advisor type, ask the advisor if it belongs to the same task as the
boolean, if so it is disposed. I had made an optimization which would stop
iterating over the advisors once it disposed  four, this is a mistake as it
could have found the advisor of the boolean itself and dispose it, now if I
exclude the explicit disposal of the advisor of the boolean variable the
problem no longer occurs. I am a little puzzled here how this is related to
the assert being raised (a double disposal also raises an assert and I do
not see this), I will continue my search but if you have any suggestions
that would be great,

Another question for my understanding, who is (responsible for) disposing
the advisor when a variable becomes assigned?

thanks,

David Rijsman

>>> 
From: 	"Christian Schulte" <cschulte at kth.se>
To:	"'David Rijsman'" <David.Rijsman at quintiq.com>, <users at gecode.org>
Date: 	10/25/2011 5:48 PM
Subject: 	Re: [gecode-users] assert in propagator cast

Hi David,

Let me do some guessing here:

1) You are using a propagator that uses advisors.
2) The dispose method of your advisors does not unsubscribe the advisor from
the view.
3) The propagator's dispose method disposes the advisors' council without
deleting the advisors subscriptions

Bang! Is that correct?

If yes, there are two ways to fix it:
a) The dispose method of the advisors also unsubscribes, or
b) In the propagator's dispose method you iterate over all advisors and
unsubscribe (The iterator is called Advisors<A> where A is the type of the
advisor). You might want to search for Advisors in gecode/int/bool/or.hpp
for an example.

I hope that helps!

Best
Christian

PS: Sorry for the delay, I was travelling.

--
Christian Schulte, KTH, web.it.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of David Rijsman
Sent: Monday, October 24, 2011 3:34 PM
To: users at gecode.org 
Subject: [gecode-users] assert in propagator cast

I need some help with an assert being thrown by Gecode, hopefully by an
error I made in a propagator I have created. Is there an obvious candidate
for an error I made in my propagator when this assert is thrown?

The assert is thrown in core.hpp

  forceinline Propagator&
  Advisor::propagator(void) const {
    assert(!disposed());
    return *Propagator::cast(ActorLink::prev());
  }

as a result of an invocation of  Advisor::cast(*a)->propagator().afc() in:


  template<class VIC>
  forceinline double
  VarImp<VIC>::afc(void) const {
    if (degree() == 0)
      return 0.0;
    double d = degree();
    // Count the afc of each propagator
    {
      ActorLink** a = const_cast<VarImp<VIC>*>(this)->actor(0);
      ActorLink** e =
const_cast<VarImp<VIC>*>(this)->actorNonZero(pc_max+1);
      while (a < e) {
        d += Propagator::cast(*a)->afc(); a++;
      }
    }
    // Count the afc of each advisor's propagator
    {
      ActorLink** a =
const_cast<VarImp<VIC>*>(this)->actorNonZero(pc_max+1);
      ActorLink** e = const_cast<VarImp<VIC>*>(this)->base+entries;
      while (a < e) {
        d += Advisor::cast(*a)->propagator().afc(); a++;
      }
    }
    return d;
  }

thanks,

David Rijsman


_______________________________________________
Gecode users mailing list
users at gecode.org 
https://www.gecode.org/mailman/listinfo/gecode-users 


_______________________________________________
Gecode users mailing list
users at gecode.org 
https://www.gecode.org/mailman/listinfo/gecode-users 


_______________________________________________
Gecode users mailing list
users at gecode.org 
https://www.gecode.org/mailman/listinfo/gecode-users 




From Vincent.Barichard at univ-angers.fr  Fri Nov  4 14:55:21 2011
From: Vincent.Barichard at univ-angers.fr (Vincent Barichard)
Date: Fri, 04 Nov 2011 14:55:21 +0100
Subject: [gecode-users] Gecode 4.0.0
In-Reply-To: <00b001cc9adc$9c7c82b0$d5758810$@se>
References: <006501cc8a71$900c6250$b02526f0$@se>
	<006b01cc8a72$69968a00$3cc39e00$@se> <j8ulfq$7i7$1@dough.gmane.org>
	<00b001cc9adc$9c7c82b0$d5758810$@se>
Message-ID: <20111104145521.21095g0puvf4w4g0@imp.info.univ-angers.fr>

Hi,

As Christian said, I am interested in having FloatVar in Gecode. I  
contacted him last Spring and started work during Summer.
I try to follow Gecode standards as close as possible. All interval'  
stuff are based on boost intervals.
Up to now, I designed FloatVar and views (FloatView, MinusView and  
OffSetView) and a bunch of propagators :
- Linear (Lg, Gq, Eq)
- Arithmetic (Square, Sqrt, Abs, Pow, NthRoot, Mult, Div, Min, Max)
- Trigonometric (Sin, Cos, Tan, ASin, ACos, ATan)
- Transcendental (Exp, Log)
- Channel (to int)

For a first release it may be enough, so I concentrate on tests to  
remove bugs. I plan to add tools for modeling (like other Gecode  
Variables and constraints), but I must first solve an issue about the  
rounding for trigonometric and transcendental functions. Indeed, boost  
doesn't provide full rounding functions for trigonometric and  
transcendental functions. To achieve correct rounding, it relies on  
other libraries like MPFR. If I can't rely on standard C maths  
functions to get a correct rounding, I have to investigate on other  
alternatives. MPFR is not a good choice for Windows users, so maybe  
another library (CRLibm ? others ?). I'd appreciate any advice on  
this. Does someone known a good "light" maths library which gives  
exact rounding ?

If you have any questions or remarks, don't hesitate to contact me!

Cheers,
Vincent

Christian Schulte <cschulte at kth.se> a ?crit?:

> Hi Filip,
>
> I started some time ago to look into the FloatVar stuff but then I got
> contacted by Vincent Barichard about that. Vincent expressed his interest
> and has already arrived at a second prototype. I am quite positive that this
> will lead to a good module for 4.*.
>
> Vincent, maybe you can describe the status so far.
>
> Best
> Christian
>
>
> --
> Christian Schulte, www.ict.kth.se/~cschulte/
>
>
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
> Of Filip Konvicka
> Sent: Thursday, November 03, 2011 7:11 PM
> To: users at gecode.org
> Subject: Re: [gecode-users] Gecode 4.0.0
>
> Christian,
>
> Sorry to reply so late...
>
> The list of features sounds great, especially the symmetry breaking (though
> I admit that I haven't looked at the propagator groups yet).
>
> Gonzalo from the AVISPA team contacted me in May regarding the Float Vars
> work they were doing, but I haven't heard from them since.  Do you have any
> information on this? Are you counting on using their implementation? Or do
> you plan to do this yourself?
>
> Thanks,
> Filip
>
>> Damn it, there are two pieces of information missing...
>>
>> Timeline: we aim at the second quarter of 2012 for Gecode 4.0.0. But
>> today I went through some older emails (written when we discussed what
>> Gecode 3.* should be) and there I wrote that Gecode 4 should be around end
> of 2009.
>> Okay, still trust me! This time everything is much different ;-) Just
>> kidding.
>>
>> Then, of course: Is there something that we absolutely must do for our
>> users?
>>
>> Christian
>>
>> --
>> Christian Schulte, www.ict.kth.se/~cschulte/
>>
>>
>> -----Original Message-----
>> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On
>> Behalf Of Christian Schulte
>> Sent: Friday, October 14, 2011 3:03 PM
>> To: users at gecode.org
>> Subject: [gecode-users] Gecode 4.0.0
>>
>> Dear all,
>>
>> As this year has already a number of releases of Gecode from the 3.*
>> version series we have decided to slow the pace and prepare for Gecode
>> 4.0.0 as the next major release.
>>
>> This mail is just to assure you that we are not dormant but that it
>> will take longer before the next version appears. If there is the need
>> for a bug fix release we will of course do that in the meantime.
>>
>> Our current plan is to include the following features:
>>
>> - Integrate propagator groups, see here:
>>
>> http://web.it.kth.se/~cschulte/paper.php?id=LagerkvistSchulte:CP:2009
>>
>> - Integrate lightweight dynamic symmetry breaking, see here:
>> 	Lightweight Dynamic Symmetry Breaking.  C. Mears, M. Garcia de la
>> Banda, B. Demoen, M. Wallace.
>>       SymCon'08.
>>     LDSB is a dynamic symmetry breaking method designed to handle
>>     common symmetries efficiently under any variable and value
>>     ordering.
>>
>> - Integrate float variables
>>
>> - Provide modeling layer for float variables
>>
>> - Support for restarts during search and large neighborhood search
>>
>> - Make randomized tie-breaking more flexible
>>
>> - Modeling layer for scheduling constraints
>>
>> - Branching for scheduling problems
>>
>>
>> Some more speculative things that might or might not make it are:
>>
>> - Integrate discrepancy-based search that is not LDS (?)
>>
>> - Half-reification, see here:
>> 	Thibaut Feydy, Zoltan Somogyi, Peter J. Stuckey: Half Reification
> and
>> Flattening. CP 2011: 286-301
>>
>> - Redundancy analysis, see here:
>> 	http://web.it.kth.se/~cschulte/paper.php?id=SchulteStuckey:PPDP:2008
>>
>> Best
>> Christian
>>
>> --
>> Christian Schulte, www.ict.kth.se/~cschulte/
>>
>>
>>
>>
>> _______________________________________________
>> Gecode users mailing list
>> users at gecode.org
>> https://www.gecode.org/mailman/listinfo/gecode-users
>
>
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>



-- 
Vincent Barichard        Universit? d'Angers (LERIA)
Tel: 02 41 73 52 06      D?partement Informatique
Fax: 02 41 73 50 73      H203


From gutierrez.gustavo at uclouvain.be  Fri Nov  4 15:27:20 2011
From: gutierrez.gustavo at uclouvain.be (Gustavo Gutierrez)
Date: Fri, 4 Nov 2011 15:27:20 +0100
Subject: [gecode-users] Gecode 4.0.0
In-Reply-To: <20111104145521.21095g0puvf4w4g0@imp.info.univ-angers.fr>
References: <006501cc8a71$900c6250$b02526f0$@se>
	<006b01cc8a72$69968a00$3cc39e00$@se> <j8ulfq$7i7$1@dough.gmane.org>
	<00b001cc9adc$9c7c82b0$d5758810$@se>
	<20111104145521.21095g0puvf4w4g0@imp.info.univ-angers.fr>
Message-ID: <CAFcfiNW+8QEewNe_xDtW-SfBuvDLV2xsHs2EYsb3jbxz0NVUmQ@mail.gmail.com>

Hi Vincent,

2011/11/4 Vincent Barichard <Vincent.Barichard at univ-angers.fr>

> e about the rounding for trigonometric and transcendental functions.
> Indeed, boost doesn't provide full rounding functions for trigonometric and
> transcendental functions. To achieve correct rounding, it relies on other
> libraries like MPFR. If I can't rely on standard C maths functions to get a
> correct rounding, I have to investigate on other alternatives. MPFR is not
> a good choice for Windows users, so maybe another library (CRLibm ? others
> ?).
>

I think that if you have something like cygwin or mingw you can install
MPFR in an easy way. The nice think about that library is that is very well
tested and brings support for different architectures. GCC uses it and this
is a good sign (?). I don't know if the library can be distributed with
gecode or at least statically linked in the future libgecodefloat. I don't
know too much about windows, tough.

I'd appreciate any advice on this. Does someone known a good "light" maths
> library which gives exact rounding ?
>
> If you have any questions or remarks, don't hesitate to contact me!
>

It will be nice if you can get some ideas from smathlib:
http://interval.sourceforge.net/interval/C/smathlib/README.html

this library was developed by Timothy Hickey but is pure C and I am not
very sure about its portability. It provides its own rounding methods
without relying in something else.

Another good library that perform constraint programming
on continuous domains is:

http://sourceforge.net/projects/elisa/

But I think you already had a look at that one. It provides nice interval
arithmetic constraint that make use of the Newton method to offer better
pruning.

Regards,
-- 
Gustavo Gutierrez
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20111104/cd0751af/attachment-0001.htm>

From texitoi+news at texitoi.eu  Fri Nov  4 15:33:13 2011
From: texitoi+news at texitoi.eu (TeXitoi)
Date: 04 Nov 2011 15:33:13 +0100
Subject: [gecode-users] Gecode 4.0.0
References: <006501cc8a71$900c6250$b02526f0$@se>
	<006b01cc8a72$69968a00$3cc39e00$@se> <j8ulfq$7i7$1@dough.gmane.org>
	<00b001cc9adc$9c7c82b0$d5758810$@se>
	<20111104145521.21095g0puvf4w4g0@imp.info.univ-angers.fr>
Message-ID: <87r51ot0t2.fsf@epiano.texitoi.eu>

Vincent Barichard writes:

> alternatives. MPFR is not a good choice for Windows users, so maybe
> another library (CRLibm ? others ?). I'd appreciate any advice on
> this. Does someone known a good "light" maths library which gives
> exact rounding ?
> 
> If you have any questions or remarks, don't hesitate to contact me!

Maybe you can have a look at Gaol:
http://sourceforge.net/projects/gaol/

You can also write to the author Frederic Goualard to talk about the
subject.

-- 
Guillaume Pinot                               http://www.texitoi.eu

? Il semble que la perfection soit atteinte non quand il n'y a plus
rien ? ajouter, mais quand il n'y a plus rien ? retrancher. ?
                      -- Antoine de Saint-Exup?ry, Terre des hommes

()  ASCII ribbon campaign      -- Against HTML e-mail
/\  http://www.asciiribbon.org -- Against proprietary attachments



From filip.konvicka at logis.cz  Fri Nov  4 15:53:33 2011
From: filip.konvicka at logis.cz (=?UTF-8?B?RmlsaXAgS29udmnEjWth?=)
Date: Fri, 04 Nov 2011 15:53:33 +0100
Subject: [gecode-users] Gecode 4.0.0
In-Reply-To: <CAFcfiNW+8QEewNe_xDtW-SfBuvDLV2xsHs2EYsb3jbxz0NVUmQ@mail.gmail.com>
References: <006501cc8a71$900c6250$b02526f0$@se>
	<006b01cc8a72$69968a00$3cc39e00$@se> <j8ulfq$7i7$1@dough.gmane.org>
	<00b001cc9adc$9c7c82b0$d5758810$@se>
	<20111104145521.21095g0puvf4w4g0@imp.info.univ-angers.fr>
	<CAFcfiNW+8QEewNe_xDtW-SfBuvDLV2xsHs2EYsb3jbxz0NVUmQ@mail.gmail.com>
Message-ID: <4EB3FC6D.4040407@logis.cz>

All,

Thanks for the update.  This all sounds very good to me.

Vincent, I haven't experimented much with low-level libraries for 
rounding and controlling the FPU on Windows.  But I'd say if there are 
issues with the trigonometric functions then just don't include them in 
the first release.  Once more people can get their hands on this it 
could be you get the solution for free :-)

I was looking into smath some time ago but I think this is not much 
portable (and probably not maintained anymore).  And the subject is so 
tricky that I think it is not a good idea to start some new 
implementation.  I think it's better to have a configuration option to 
include any library available and supported by Boost.Interval, and as a 
consequence enabling/disabling some constraints implementations in 
Gecode based on the capabilities.  The point is, some people (like me) 
may not need Trigonometric and Transcendental functions at all...  But 
this is also for Christian to decide whether this approach is acceptable 
(sometimes having a constraint available and sometimes not).

Best Regards,
Filip

> Hi Vincent,
>
> 2011/11/4 Vincent Barichard <Vincent.Barichard at univ-angers.fr 
> <mailto:Vincent.Barichard at univ-angers.fr>>
>
>     e about the rounding for trigonometric and transcendental
>     functions. Indeed, boost doesn't provide full rounding functions
>     for trigonometric and transcendental functions. To achieve correct
>     rounding, it relies on other libraries like MPFR. If I can't rely
>     on standard C maths functions to get a correct rounding, I have to
>     investigate on other alternatives. MPFR is not a good choice for
>     Windows users, so maybe another library (CRLibm ? others ?).
>
>
> I think that if you have something like cygwin or mingw you can 
> install MPFR in an easy way. The nice think about that library is that 
> is very well tested and brings support for different architectures. 
> GCC uses it and this is a good sign (?). I don't know if the library 
> can be distributed with gecode or at least statically linked in the 
> future libgecodefloat. I don't know too much about windows, tough.
>
>     I'd appreciate any advice on this. Does someone known a good
>     "light" maths library which gives exact rounding ?
>
>     If you have any questions or remarks, don't hesitate to contact me!
>
>
> It will be nice if you can get some ideas from smathlib:
> http://interval.sourceforge.net/interval/C/smathlib/README.html
>
> this library was developed by Timothy Hickey but is pure C and I am 
> not very sure about its portability. It provides its own rounding 
> methods without relying in something else.
>
> Another good library that perform constraint programming 
> on continuous domains is:
>
> http://sourceforge.net/projects/elisa/
>
> But I think you already had a look at that one. It provides nice 
> interval arithmetic constraint that make use of the Newton method to 
> offer better pruning.
>
> Regards,
> -- 
> Gustavo Gutierrez

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20111104/6bc8dd2a/attachment.htm>

From filip.konvicka at logis.cz  Fri Nov  4 15:58:03 2011
From: filip.konvicka at logis.cz (=?UTF-8?B?RmlsaXAgS29udmnEjWth?=)
Date: Fri, 04 Nov 2011 15:58:03 +0100
Subject: [gecode-users] Gecode 4.0.0
In-Reply-To: <87r51ot0t2.fsf@epiano.texitoi.eu>
References: <006501cc8a71$900c6250$b02526f0$@se>
	<006b01cc8a72$69968a00$3cc39e00$@se> <j8ulfq$7i7$1@dough.gmane.org>
	<00b001cc9adc$9c7c82b0$d5758810$@se>
	<20111104145521.21095g0puvf4w4g0@imp.info.univ-angers.fr>
	<87r51ot0t2.fsf@epiano.texitoi.eu>
Message-ID: <j90uhj$b2a$1@dough.gmane.org>

> Maybe you can have a look at Gaol:
> http://sourceforge.net/projects/gaol/
>
> You can also write to the author Frederic Goualard to talk about the
> subject.
>

One issue will probably be the license - both Gaol and MPFR are LGPL, so 
including them in a Gecode distribution would make that Gecode package 
also LGPL, I guess.  Again, if a user decides to build their own Gecode 
with this included, it's fine, so it's great to have the option.  But 
for a standard Gecode release my understanding was that the ideal 
license would be MIT-style.

Best,
Filip



From Vincent.Barichard at univ-angers.fr  Fri Nov  4 16:59:22 2011
From: Vincent.Barichard at univ-angers.fr (Vincent Barichard)
Date: Fri, 04 Nov 2011 16:59:22 +0100
Subject: [gecode-users] Gecode 4.0.0
In-Reply-To: <j90uhj$b2a$1@dough.gmane.org>
References: <006501cc8a71$900c6250$b02526f0$@se>
	<006b01cc8a72$69968a00$3cc39e00$@se> <j8ulfq$7i7$1@dough.gmane.org>
	<00b001cc9adc$9c7c82b0$d5758810$@se>
	<20111104145521.21095g0puvf4w4g0@imp.info.univ-angers.fr>
	<87r51ot0t2.fsf@epiano.texitoi.eu> <j90uhj$b2a$1@dough.gmane.org>
Message-ID: <20111104165922.19295q16b6gach44@imp.info.univ-angers.fr>

Hi Filip,

I don't know smathlib, but as you said, it seems to be not maintained anymore.
Elisa is based on Gaol which is based on the IBM mathematical library,  
so it also relies on
another external library.

I agree to not start a new implementation, it will be painfull. I  
don't think that Gecode will
become LGPL if it links with a LGPL library. But users should have the  
choice to not embed such a dependency.
I didn't find a mathematical library which fit all our needs (license,  
multi platforms, small, reliable).
So I see no choice but to use an external dependency which will be  
LGPL. Up to now, I retained two possibilities which
are MPFR or CRlibm. Maybe CRLibm is easier to build under windows than  
MPFR? (I am not a Windows user so I have no feedback on this)

I also think that a build-option should be used to decide if  
transcendental constraints must be included. But we still have
to provide a fully functional implementation of FloatVar, and to  
achieve it, we must choose a library. I prefer a library
which works on Linux and Windows. I think it's up to Gecode  
maintainers to decide which choice has to be made, I will follow
their conlusions. But in the meantime, I will continue to dig the  
topic, so thank you very much for all your remarks and
advices :) If a Windows user has ever used an exact mathematical  
library, feel free to share your comments.

Best,
Vincent

Filip Konvi?ka <filip.konvicka at logis.cz> a ?crit?:

>> Maybe you can have a look at Gaol:
>> http://sourceforge.net/projects/gaol/
>>
>> You can also write to the author Frederic Goualard to talk about the
>> subject.
>>
>
> One issue will probably be the license - both Gaol and MPFR are  
> LGPL, so including them in a Gecode distribution would make that  
> Gecode package also LGPL, I guess.  Again, if a user decides to  
> build their own Gecode with this included, it's fine, so it's great  
> to have the option.  But for a standard Gecode release my  
> understanding was that the ideal license would be MIT-style.
>
> Best,
> Filip
>
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>



-- 
Vincent Barichard        Universit? d'Angers (LERIA)
Tel: 02 41 73 52 06      D?partement Informatique
Fax: 02 41 73 50 73      H203


From filip.konvicka at logis.cz  Sun Nov  6 08:41:35 2011
From: filip.konvicka at logis.cz (=?UTF-8?B?RmlsaXAgS29udmnEjWth?=)
Date: Sun, 06 Nov 2011 08:41:35 +0100
Subject: [gecode-users] Gecode 4.0.0
In-Reply-To: <20111104165922.19295q16b6gach44@imp.info.univ-angers.fr>
References: <006501cc8a71$900c6250$b02526f0$@se>
	<006b01cc8a72$69968a00$3cc39e00$@se> <j8ulfq$7i7$1@dough.gmane.org>
	<00b001cc9adc$9c7c82b0$d5758810$@se>
	<20111104145521.21095g0puvf4w4g0@imp.info.univ-angers.fr>
	<87r51ot0t2.fsf@epiano.texitoi.eu> <j90uhj$b2a$1@dough.gmane.org>
	<20111104165922.19295q16b6gach44@imp.info.univ-angers.fr>
Message-ID: <4EB63A2F.3090704@logis.cz>

Hi Vincent,

I agree.  Regarding LGPL - I should have said that it would make the 
Gecode package include LGPL code, which might be problematic for some.  
But it's still OK for many.  I was briefly looking at the Internet on 
Friday and I haven't seen a usable math library that is not LGPL.

Best,
Filip

> Hi Filip,
>
> I don't know smathlib, but as you said, it seems to be not maintained 
> anymore.
> Elisa is based on Gaol which is based on the IBM mathematical library, 
> so it also relies on
> another external library.
>
> I agree to not start a new implementation, it will be painfull. I 
> don't think that Gecode will
> become LGPL if it links with a LGPL library. But users should have the 
> choice to not embed such a dependency.
> I didn't find a mathematical library which fit all our needs (license, 
> multi platforms, small, reliable).
> So I see no choice but to use an external dependency which will be 
> LGPL. Up to now, I retained two possibilities which
> are MPFR or CRlibm. Maybe CRLibm is easier to build under windows than 
> MPFR? (I am not a Windows user so I have no feedback on this)
>
> I also think that a build-option should be used to decide if 
> transcendental constraints must be included. But we still have
> to provide a fully functional implementation of FloatVar, and to 
> achieve it, we must choose a library. I prefer a library
> which works on Linux and Windows. I think it's up to Gecode 
> maintainers to decide which choice has to be made, I will follow
> their conlusions. But in the meantime, I will continue to dig the 
> topic, so thank you very much for all your remarks and
> advices :) If a Windows user has ever used an exact mathematical 
> library, feel free to share your comments.
>
> Best,
> Vincent
>
> Filip Konvi?ka <filip.konvicka at logis.cz> a ?crit :
>
>>> Maybe you can have a look at Gaol:
>>> http://sourceforge.net/projects/gaol/
>>>
>>> You can also write to the author Frederic Goualard to talk about the
>>> subject.
>>>
>>
>> One issue will probably be the license - both Gaol and MPFR are LGPL, 
>> so including them in a Gecode distribution would make that Gecode 
>> package also LGPL, I guess.  Again, if a user decides to build their 
>> own Gecode with this included, it's fine, so it's great to have the 
>> option.  But for a standard Gecode release my understanding was that 
>> the ideal license would be MIT-style.
>>
>> Best,
>> Filip
>>
>>
>> _______________________________________________
>> Gecode users mailing list
>> users at gecode.org
>> https://www.gecode.org/mailman/listinfo/gecode-users
>>
>
>
>



From tack at gecode.org  Sun Nov  6 10:51:47 2011
From: tack at gecode.org (Guido Tack)
Date: Sun, 6 Nov 2011 10:51:47 +0100
Subject: [gecode-users] Gecode 4.0.0
In-Reply-To: <4EB63A2F.3090704@logis.cz>
References: <006501cc8a71$900c6250$b02526f0$@se>
	<006b01cc8a72$69968a00$3cc39e00$@se> <j8ulfq$7i7$1@dough.gmane.org>
	<00b001cc9adc$9c7c82b0$d5758810$@se>
	<20111104145521.21095g0puvf4w4g0@imp.info.univ-angers.fr>
	<87r51ot0t2.fsf@epiano.texitoi.eu> <j90uhj$b2a$1@dough.gmane.org>
	<20111104165922.19295q16b6gach44@imp.info.univ-angers.fr>
	<4EB63A2F.3090704@logis.cz>
Message-ID: <F55E27F7-1B36-423D-8A3A-588D946BEAF4@gecode.org>


-- 
Guido Tack, http://people.cs.kuleuven.be/~guido.tack/




Hi guys,

we wouldn't be worried at all about having code that uses an LGPL library within Gecode - actually, we already have, as Gist uses Qt.  This doesn't mean Gecode, or any part of it, needs to be LGPL.
As far as I can see, it's possible to build MPIR and MPFR using Visual Studio.  I haven't checked how easy it is, though.  What we'd really need is someone to build Windows binary packages for these two libraries (or a combined one), which install all the libraries and header files somewhere ready to compile and link against.  We'd be very happy to help with the packaging, we have enough experience with the wix toolkit, e.g.

Vincent, as far as I can see, a core version of FloatVars could be an integral part of Gecode without linking to MPFR.  Then a separate DLL could provide the constraints for trigonometric and transcendental functions, and link to MPFR.

Cheers,
Guido

On 6 Nov 2011, at 08:41, Filip Konvi?ka wrote:

> Hi Vincent,
> 
> I agree.  Regarding LGPL - I should have said that it would make the Gecode package include LGPL code, which might be problematic for some.  But it's still OK for many.  I was briefly looking at the Internet on Friday and I haven't seen a usable math library that is not LGPL.
> 
> Best,
> Filip
> 
>> Hi Filip,
>> 
>> I don't know smathlib, but as you said, it seems to be not maintained anymore.
>> Elisa is based on Gaol which is based on the IBM mathematical library, so it also relies on
>> another external library.
>> 
>> I agree to not start a new implementation, it will be painfull. I don't think that Gecode will
>> become LGPL if it links with a LGPL library. But users should have the choice to not embed such a dependency.
>> I didn't find a mathematical library which fit all our needs (license, multi platforms, small, reliable).
>> So I see no choice but to use an external dependency which will be LGPL. Up to now, I retained two possibilities which
>> are MPFR or CRlibm. Maybe CRLibm is easier to build under windows than MPFR? (I am not a Windows user so I have no feedback on this)
>> 
>> I also think that a build-option should be used to decide if transcendental constraints must be included. But we still have
>> to provide a fully functional implementation of FloatVar, and to achieve it, we must choose a library. I prefer a library
>> which works on Linux and Windows. I think it's up to Gecode maintainers to decide which choice has to be made, I will follow
>> their conlusions. But in the meantime, I will continue to dig the topic, so thank you very much for all your remarks and
>> advices :) If a Windows user has ever used an exact mathematical library, feel free to share your comments.
>> 
>> Best,
>> Vincent
>> 
>> Filip Konvi?ka <filip.konvicka at logis.cz> a ?crit :
>> 
>>>> Maybe you can have a look at Gaol:
>>>> http://sourceforge.net/projects/gaol/
>>>> 
>>>> You can also write to the author Frederic Goualard to talk about the
>>>> subject.
>>>> 
>>> 
>>> One issue will probably be the license - both Gaol and MPFR are LGPL, so including them in a Gecode distribution would make that Gecode package also LGPL, I guess.  Again, if a user decides to build their own Gecode with this included, it's fine, so it's great to have the option.  But for a standard Gecode release my understanding was that the ideal license would be MIT-style.
>>> 
>>> Best,
>>> Filip
>>> 
>>> 
>>> _______________________________________________
>>> Gecode users mailing list
>>> users at gecode.org
>>> https://www.gecode.org/mailman/listinfo/gecode-users
>>> 
>> 
>> 
>> 
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users



From texitoi+news at texitoi.eu  Sun Nov  6 12:58:28 2011
From: texitoi+news at texitoi.eu (TeXitoi)
Date: 06 Nov 2011 12:58:28 +0100
Subject: [gecode-users] Memory problem using Gecode for local search
Message-ID: <87ipmxtqcb.fsf@epiano.texitoi.eu>

Hi!

I'm trying to use Gecode 3.7.1 to do local search.  My decision
variables are in a IntVarArray machine_m.

I do about that :

  /* constraints... */
  IntArgs sol_l(machine_m.size());
  /* creating sol_l with sol_l[i] = ...; */
  count(*this, machine_m, sol_l, IRT_EQ, machine_m.size() - 1);
  branch(*this, machine_m, INT_VAR_RND, INT_VAL_MIN);

if I am correct, the tree will be totally balanced on the right,
e.g. choice(0) will always be a solution, and choice(1) will be the
rest of the solutions. I use INT_VAL_MIN to limit the fragmentation of
my decision variables.

I enumerate the different solutions about like that:

  Search::Options options_l;
  options_l.c_d = 1;
  options_l.clone = false;
  DFS<GecodeSpace> search_l(pSpace_l, options_l);
  GecodeSpace *pSpace_l = 0;
  while ((pSol_l = search_l.next()) != 0) {
      /* working with pSol_l */
      delete pSol_l;
  }

I use c_d = 1 because my tree have this special shape that make
choice(0) always be a solution.  I thought that the search tree will
be memory efficient because only 2 Gecode::Space must be stored at the
same time because of the shape of the search tree, but I can see that
it takes a lot of memory on big instances (even if I comment
c_d=...).  I can see on "top" the memory growing about linearly with
time.

It seems that I do not have any memory problem in my program because
if I use Search::MemoryStop(256 * 1024 * 1024) and let my local search
running all the night, my program is only growing between about 30MB
and 270MB.

Why do I have this behavior? What did I do wrong? How to solve my
problem (enumerating every solutions that have only 1 variable
different from a given solution in constant memory)?

Thanks in advance.

-- 
Guillaume Pinot                               http://www.texitoi.eu

? Il semble que la perfection soit atteinte non quand il n'y a plus
rien ? ajouter, mais quand il n'y a plus rien ? retrancher. ?
                      -- Antoine de Saint-Exup?ry, Terre des hommes

()  ASCII ribbon campaign      -- Against HTML e-mail
/\  http://www.asciiribbon.org -- Against proprietary attachments



From tack at gecode.org  Sun Nov  6 16:17:46 2011
From: tack at gecode.org (Guido Tack)
Date: Sun, 6 Nov 2011 16:17:46 +0100
Subject: [gecode-users] Memory problem using Gecode for local search
In-Reply-To: <87ipmxtqcb.fsf@epiano.texitoi.eu>
References: <87ipmxtqcb.fsf@epiano.texitoi.eu>
Message-ID: <09677548-C78C-46A1-A9D7-187D189EAD28@gecode.org>

Hi,
have you verified (e.g. using Gist) that your search tree actually has that shape?  If yes, could you post a short self-contained example code that shows this behavior?

Cheers,
Guido


On 6 Nov 2011, at 12:58, TeXitoi wrote:

> Hi!
> 
> I'm trying to use Gecode 3.7.1 to do local search.  My decision
> variables are in a IntVarArray machine_m.
> 
> I do about that :
> 
>  /* constraints... */
>  IntArgs sol_l(machine_m.size());
>  /* creating sol_l with sol_l[i] = ...; */
>  count(*this, machine_m, sol_l, IRT_EQ, machine_m.size() - 1);
>  branch(*this, machine_m, INT_VAR_RND, INT_VAL_MIN);
> 
> if I am correct, the tree will be totally balanced on the right,
> e.g. choice(0) will always be a solution, and choice(1) will be the
> rest of the solutions. I use INT_VAL_MIN to limit the fragmentation of
> my decision variables.
> 
> I enumerate the different solutions about like that:
> 
>  Search::Options options_l;
>  options_l.c_d = 1;
>  options_l.clone = false;
>  DFS<GecodeSpace> search_l(pSpace_l, options_l);
>  GecodeSpace *pSpace_l = 0;
>  while ((pSol_l = search_l.next()) != 0) {
>      /* working with pSol_l */
>      delete pSol_l;
>  }
> 
> I use c_d = 1 because my tree have this special shape that make
> choice(0) always be a solution.  I thought that the search tree will
> be memory efficient because only 2 Gecode::Space must be stored at the
> same time because of the shape of the search tree, but I can see that
> it takes a lot of memory on big instances (even if I comment
> c_d=...).  I can see on "top" the memory growing about linearly with
> time.
> 
> It seems that I do not have any memory problem in my program because
> if I use Search::MemoryStop(256 * 1024 * 1024) and let my local search
> running all the night, my program is only growing between about 30MB
> and 270MB.
> 
> Why do I have this behavior? What did I do wrong? How to solve my
> problem (enumerating every solutions that have only 1 variable
> different from a given solution in constant memory)?
> 
> Thanks in advance.
> 
> -- 
> Guillaume Pinot                               http://www.texitoi.eu
> 
> ? Il semble que la perfection soit atteinte non quand il n'y a plus
> rien ? ajouter, mais quand il n'y a plus rien ? retrancher. ?
>                      -- Antoine de Saint-Exup?ry, Terre des hommes
> 
> ()  ASCII ribbon campaign      -- Against HTML e-mail
> /\  http://www.asciiribbon.org -- Against proprietary attachments
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users



From texitoi+news at texitoi.eu  Sun Nov  6 17:46:04 2011
From: texitoi+news at texitoi.eu (TeXitoi)
Date: 06 Nov 2011 17:46:04 +0100
Subject: [gecode-users] Memory problem using Gecode for local search
References: <87ipmxtqcb.fsf@epiano.texitoi.eu>
	<09677548-C78C-46A1-A9D7-187D189EAD28@gecode.org>
Message-ID: <87ehxltd0z.fsf@epiano.texitoi.eu>

Guido Tack <tack at gecode.org> writes:

> Hi,
> have you verified (e.g. using Gist) that your search tree actually
> has that shape?

I cannot make gecode with gist compile here (OpenBSD).  But writing a
minimal example, I think I understood why the tree do not have the
shape I was thinking.

So, the question is: How can I branch to values different from sol_l
(sol_l can be any solution, of course)? Ideally, a random value not
the one of sol_l[i].

Here is the example:

====8<========8<========8<========8<========8<========8<========8<====
#include <gecode/int.hh>
#include <gecode/search.hh>

using namespace Gecode;

class MySpace: public Space
{
public:
    MySpace(int size_p, int nb_p):
        machine_m(*this, size_p, 0, nb_p - 1)
    {
        IntArgs sol_l(machine_m.size());
        for (int i_l = 0; i_l < machine_m.size(); ++i_l)
            sol_l[i_l] = 0;
        count(*this, machine_m, sol_l, IRT_EQ, machine_m.size() - 1);
        // if using that, we will affect first according to sol_l, so
        // we will need to go deep to find a solution
        branch(*this, machine_m, INT_VAR_NONE, INT_VAL_MIN);
        // using that, we will directly choose a value different from
        // sol_l, and so we will have a right balanced tree
        //branch(*this, machine_m, INT_VAR_NONE, INT_VAL_MAX);
    }

    MySpace(bool share_p, MySpace &that): Space(share_p, that)
    { machine_m.update(*this, share_p, that.machine_m); }

    virtual Gecode::Space *copy(bool share_p)
    { return new MySpace(share_p, *this); }

    void print()
    { std::cout << machine_m << std::endl; }

protected:
    Gecode::IntVarArray machine_m;
};

int main(void)
{
    MySpace *pSpace_l = new MySpace(10, 2);
    Search::Options options_l;
    options_l.c_d = 1;
    options_l.clone = false;
    DFS<MySpace> search_l(pSpace_l, options_l);
    MySpace *pSol_l = 0;
    while ((pSol_l = search_l.next()) != 0) {
        pSol_l->print();
        delete pSol_l;
    }

    return 0;
}
====8<========8<========8<========8<========8<========8<========8<====

-- 
Guillaume Pinot                               http://www.texitoi.eu

? Il semble que la perfection soit atteinte non quand il n'y a plus
rien ? ajouter, mais quand il n'y a plus rien ? retrancher. ?
                      -- Antoine de Saint-Exup?ry, Terre des hommes

()  ASCII ribbon campaign      -- Against HTML e-mail
/\  http://www.asciiribbon.org -- Against proprietary attachments



From tack at gecode.org  Sun Nov  6 19:50:44 2011
From: tack at gecode.org (Guido Tack)
Date: Sun, 6 Nov 2011 19:50:44 +0100
Subject: [gecode-users] Memory problem using Gecode for local search
In-Reply-To: <87ehxltd0z.fsf@epiano.texitoi.eu>
References: <87ipmxtqcb.fsf@epiano.texitoi.eu>
	<09677548-C78C-46A1-A9D7-187D189EAD28@gecode.org>
	<87ehxltd0z.fsf@epiano.texitoi.eu>
Message-ID: <5247AF58-ADC8-4B67-AEED-E63358EC349B@gecode.org>

On 6 Nov 2011, at 17:46, TeXitoi wrote:

> Guido Tack <tack at gecode.org> writes:
> 
>> Hi,
>> have you verified (e.g. using Gist) that your search tree actually
>> has that shape?
> 
> I cannot make gecode with gist compile here (OpenBSD).  But writing a
> minimal example, I think I understood why the tree do not have the
> shape I was thinking.
> 
> So, the question is: How can I branch to values different from sol_l
> (sol_l can be any solution, of course)? Ideally, a random value not
> the one of sol_l[i].

Ah, that makes sense.  With the second branch enabled (and using 10000 as the size), memory increases only very little over time.

You'll have to implement a brancher, see the relevant sections in the documentation. The brancher will have to store the sol_I array and use it to determine the value to branch on.

Cheers,
Guido

> 
> Here is the example:
> 
> ====8<========8<========8<========8<========8<========8<========8<====
> #include <gecode/int.hh>
> #include <gecode/search.hh>
> 
> using namespace Gecode;
> 
> class MySpace: public Space
> {
> public:
>    MySpace(int size_p, int nb_p):
>        machine_m(*this, size_p, 0, nb_p - 1)
>    {
>        IntArgs sol_l(machine_m.size());
>        for (int i_l = 0; i_l < machine_m.size(); ++i_l)
>            sol_l[i_l] = 0;
>        count(*this, machine_m, sol_l, IRT_EQ, machine_m.size() - 1);
>        // if using that, we will affect first according to sol_l, so
>        // we will need to go deep to find a solution
>        branch(*this, machine_m, INT_VAR_NONE, INT_VAL_MIN);
>        // using that, we will directly choose a value different from
>        // sol_l, and so we will have a right balanced tree
>        //branch(*this, machine_m, INT_VAR_NONE, INT_VAL_MAX);
>    }
> 
>    MySpace(bool share_p, MySpace &that): Space(share_p, that)
>    { machine_m.update(*this, share_p, that.machine_m); }
> 
>    virtual Gecode::Space *copy(bool share_p)
>    { return new MySpace(share_p, *this); }
> 
>    void print()
>    { std::cout << machine_m << std::endl; }
> 
> protected:
>    Gecode::IntVarArray machine_m;
> };
> 
> int main(void)
> {
>    MySpace *pSpace_l = new MySpace(10, 2);
>    Search::Options options_l;
>    options_l.c_d = 1;
>    options_l.clone = false;
>    DFS<MySpace> search_l(pSpace_l, options_l);
>    MySpace *pSol_l = 0;
>    while ((pSol_l = search_l.next()) != 0) {
>        pSol_l->print();
>        delete pSol_l;
>    }
> 
>    return 0;
> }
> ====8<========8<========8<========8<========8<========8<========8<====
> 
> -- 
> Guillaume Pinot                               http://www.texitoi.eu
> 
> ? Il semble que la perfection soit atteinte non quand il n'y a plus
> rien ? ajouter, mais quand il n'y a plus rien ? retrancher. ?
>                      -- Antoine de Saint-Exup?ry, Terre des hommes
> 
> ()  ASCII ribbon campaign      -- Against HTML e-mail
> /\  http://www.asciiribbon.org -- Against proprietary attachments
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users



From cschulte at kth.se  Mon Nov  7 10:23:43 2011
From: cschulte at kth.se (Christian Schulte)
Date: Mon, 7 Nov 2011 10:23:43 +0100
Subject: [gecode-users] assert in propagator cast
In-Reply-To: <4EB3FC7F020000850001B660@mail.quintiq.nl>
References: <4EA58552020000850001B23A@mail.quintiq.nl>
	<015e01cc932d$71905ec0$54b11c40$@kth.se>
	<4EB3CFF2020000850001B647@mail.quintiq.nl>
	<00c501cc9ae7$a5a94ac0$f0fbe040$@se>
	<4EB3FC7F020000850001B660@mail.quintiq.nl>
Message-ID: <000601cc9d2e$f4412bf0$dcc383d0$@kth.se>

Hi David,

What still could have happened is that you disposed the advisor without
cancelling this one out of five subscriptions. In that case there still
would a subscription left and there would be no possibility to cancel it as
the advisor has been removed from the council (this is a side-effect of
disposing an advisor, it gets removed from its council).

Christian

--
Christian Schulte, KTH, web.it.kth.se/~cschulte/

-----Original Message-----
From: David Rijsman [mailto:David.Rijsman at quintiq.com] 
Sent: Friday, November 04, 2011 2:54 PM
To: users at gecode.org; cschulte at kth.se
Subject: RE: [gecode-users] assert in propagator cast

Hi Christian,

in my case the dispose of the advisor is the one that cancels the
subscription to the variable.  The dispose of the propagator is the one that
disposes the council (and the council disposes the advisors still in the
council). So I think I dispose (and cancel) enough. The assert was raised
when I only disposed 4 (any subset) out of 5 of the advisors related to a
task for which the boolean turned false. I fixed this to 5 and the problem
no longer happens. I just can not figure out why the assert was raised
especially it should not hurt to wait with disposing of an individual
advisor until the council disposes. I will keep searching and post when I
find something,

David Rijsman

>>> 
From: 	"Christian Schulte" <cschulte at kth.se>
To:	"'David Rijsman'" <David.Rijsman at quintiq.com>, <users at gecode.org>
Date: 	11/4/2011 12:50 PM
Subject: 	RE: [gecode-users] assert in propagator cast

Hi David,

Ok, let's see: when the Boolean variable becomes assigned you dispose the
advisors. But do you also cancel the subscriptions?

As you correctly observed, some advisors have a dispose function that also
does the cancel. If an advisor has a dispose function that does not cancel,
then the cancel has to be done manually.

For assigned views, subscriptions do not need to be cancelled but advisors
still must be disposed. You might do that in the advise() function or in the
dispose() function but have to be careful to only do it once!

Please let me know whether this helps.

Best
Christian

--
Christian Schulte, www.ict.kth.se/~cschulte/ 


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of David Rijsman
Sent: Friday, November 04, 2011 11:44 AM
To: users at gecode.org; cschulte at kth.se
Subject: Re: [gecode-users] assert in propagator cast

Hi Christian,

a little bit delayed but yes you are pretty close with your guessing. I do
step 1 and step 2 I do cancel the subscription. Also in the dispose method
of the propagator I invoke the dispose method of the council. 

Should I also cancel all the subscriptions of the variables to the advisors
in the propagators dispose although I invoke the dispose on the council? I
checked the dispose of the council and it also invokes the dispose of the
advisors which in my case do cancel the subscriptions.

In the example  in gecode/int/bool/or.hpp you are using the advisor type
Advisor in which the cancellation does not take place (in my case it does in
the specialized implementation of dispose) so I understand the need to
explicitly do it in the dispose of the propagator in your case. But I do not
see it in my case....

To give you a little more background, I have a propagator working on tasks,
each task has five variables of which one is a boolean. When the boolean
becomes false I want to dispose all the advisors on all the five variables
associated with this task. When the boolean becomes false, in the advise of
the propagator I iterate over all the advisors in the council, cast them to
my advisor type, ask the advisor if it belongs to the same task as the
boolean, if so it is disposed. I had made an optimization which would stop
iterating over the advisors once it disposed  four, this is a mistake as it
could have found the advisor of the boolean itself and dispose it, now if I
exclude the explicit disposal of the advisor of the boolean variable the
problem no longer occurs. I am a little puzzled here how this is related to
the assert being raised (a double disposal also raises an assert and I do
not see this), I will continue my search but if you have any suggestions
that would be great,

Another question for my understanding, who is (responsible for) disposing
the advisor when a variable becomes assigned?

thanks,

David Rijsman

>>> 
From: 	"Christian Schulte" <cschulte at kth.se>
To:	"'David Rijsman'" <David.Rijsman at quintiq.com>, <users at gecode.org>
Date: 	10/25/2011 5:48 PM
Subject: 	Re: [gecode-users] assert in propagator cast

Hi David,

Let me do some guessing here:

1) You are using a propagator that uses advisors.
2) The dispose method of your advisors does not unsubscribe the advisor from
the view.
3) The propagator's dispose method disposes the advisors' council without
deleting the advisors subscriptions

Bang! Is that correct?

If yes, there are two ways to fix it:
a) The dispose method of the advisors also unsubscribes, or
b) In the propagator's dispose method you iterate over all advisors and
unsubscribe (The iterator is called Advisors<A> where A is the type of the
advisor). You might want to search for Advisors in gecode/int/bool/or.hpp
for an example.

I hope that helps!

Best
Christian

PS: Sorry for the delay, I was travelling.

--
Christian Schulte, KTH, web.it.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of David Rijsman
Sent: Monday, October 24, 2011 3:34 PM
To: users at gecode.org
Subject: [gecode-users] assert in propagator cast

I need some help with an assert being thrown by Gecode, hopefully by an
error I made in a propagator I have created. Is there an obvious candidate
for an error I made in my propagator when this assert is thrown?

The assert is thrown in core.hpp

  forceinline Propagator&
  Advisor::propagator(void) const {
    assert(!disposed());
    return *Propagator::cast(ActorLink::prev());
  }

as a result of an invocation of  Advisor::cast(*a)->propagator().afc() in:


  template<class VIC>
  forceinline double
  VarImp<VIC>::afc(void) const {
    if (degree() == 0)
      return 0.0;
    double d = degree();
    // Count the afc of each propagator
    {
      ActorLink** a = const_cast<VarImp<VIC>*>(this)->actor(0);
      ActorLink** e =
const_cast<VarImp<VIC>*>(this)->actorNonZero(pc_max+1);
      while (a < e) {
        d += Propagator::cast(*a)->afc(); a++;
      }
    }
    // Count the afc of each advisor's propagator
    {
      ActorLink** a =
const_cast<VarImp<VIC>*>(this)->actorNonZero(pc_max+1);
      ActorLink** e = const_cast<VarImp<VIC>*>(this)->base+entries;
      while (a < e) {
        d += Advisor::cast(*a)->propagator().afc(); a++;
      }
    }
    return d;
  }

thanks,

David Rijsman


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users 


_______________________________________________
Gecode users mailing list
users at gecode.org 
https://www.gecode.org/mailman/listinfo/gecode-users 


_______________________________________________
Gecode users mailing list
users at gecode.org 
https://www.gecode.org/mailman/listinfo/gecode-users 





From cschulte at kth.se  Mon Nov  7 10:31:54 2011
From: cschulte at kth.se (Christian Schulte)
Date: Mon, 7 Nov 2011 10:31:54 +0100
Subject: [gecode-users] Gecode 4.0.0
In-Reply-To: <F55E27F7-1B36-423D-8A3A-588D946BEAF4@gecode.org>
References: <006501cc8a71$900c6250$b02526f0$@se>	<006b01cc8a72$69968a00$3cc39e00$@se>
	<j8ulfq$7i7$1@dough.gmane.org>	<00b001cc9adc$9c7c82b0$d5758810$@se>	<20111104145521.21095g0puvf4w4g0@imp.info.univ-angers.fr>	<87r51ot0t2.fsf@epiano.texitoi.eu>
	<j90uhj$b2a$1@dough.gmane.org>	<20111104165922.19295q16b6gach44@imp.info.univ-angers.fr>	<4EB63A2F.3090704@logis.cz>
	<F55E27F7-1B36-423D-8A3A-588D946BEAF4@gecode.org>
Message-ID: <000e01cc9d30$174a0620$45de1260$@kth.se>

Dear all,

I also support Guido's proposal. For 4.0.0 I think we will aim at getting the FloatVars in with the functionality described by Vincent. This will be enough work: testing, support in minimodel, documenting it in MPG, ...

In a second step one then can start thinking how to get the remaining stuff in. I expect that this will also change how we build and package Gecode and for that reason postponing it is a good idea so that we do not have a new major release and at the same time a change of the build infrastructure.

Best
Christian

--
Christian Schulte, KTH, web.it.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf Of Guido Tack
Sent: Sunday, November 06, 2011 10:52 AM
To: Filip Konvi?ka
Cc: Vincent Barichard; users at gecode.org
Subject: Re: [gecode-users] Gecode 4.0.0


-- 
Guido Tack, http://people.cs.kuleuven.be/~guido.tack/




Hi guys,

we wouldn't be worried at all about having code that uses an LGPL library within Gecode - actually, we already have, as Gist uses Qt.  This doesn't mean Gecode, or any part of it, needs to be LGPL.
As far as I can see, it's possible to build MPIR and MPFR using Visual Studio.  I haven't checked how easy it is, though.  What we'd really need is someone to build Windows binary packages for these two libraries (or a combined one), which install all the libraries and header files somewhere ready to compile and link against.  We'd be very happy to help with the packaging, we have enough experience with the wix toolkit, e.g.

Vincent, as far as I can see, a core version of FloatVars could be an integral part of Gecode without linking to MPFR.  Then a separate DLL could provide the constraints for trigonometric and transcendental functions, and link to MPFR.

Cheers,
Guido

On 6 Nov 2011, at 08:41, Filip Konvi?ka wrote:

> Hi Vincent,
> 
> I agree.  Regarding LGPL - I should have said that it would make the Gecode package include LGPL code, which might be problematic for some.  But it's still OK for many.  I was briefly looking at the Internet on Friday and I haven't seen a usable math library that is not LGPL.
> 
> Best,
> Filip
> 
>> Hi Filip,
>> 
>> I don't know smathlib, but as you said, it seems to be not maintained anymore.
>> Elisa is based on Gaol which is based on the IBM mathematical library, so it also relies on
>> another external library.
>> 
>> I agree to not start a new implementation, it will be painfull. I don't think that Gecode will
>> become LGPL if it links with a LGPL library. But users should have the choice to not embed such a dependency.
>> I didn't find a mathematical library which fit all our needs (license, multi platforms, small, reliable).
>> So I see no choice but to use an external dependency which will be LGPL. Up to now, I retained two possibilities which
>> are MPFR or CRlibm. Maybe CRLibm is easier to build under windows than MPFR? (I am not a Windows user so I have no feedback on this)
>> 
>> I also think that a build-option should be used to decide if transcendental constraints must be included. But we still have
>> to provide a fully functional implementation of FloatVar, and to achieve it, we must choose a library. I prefer a library
>> which works on Linux and Windows. I think it's up to Gecode maintainers to decide which choice has to be made, I will follow
>> their conlusions. But in the meantime, I will continue to dig the topic, so thank you very much for all your remarks and
>> advices :) If a Windows user has ever used an exact mathematical library, feel free to share your comments.
>> 
>> Best,
>> Vincent
>> 
>> Filip Konvi?ka <filip.konvicka at logis.cz> a ?crit :
>> 
>>>> Maybe you can have a look at Gaol:
>>>> http://sourceforge.net/projects/gaol/
>>>> 
>>>> You can also write to the author Frederic Goualard to talk about the
>>>> subject.
>>>> 
>>> 
>>> One issue will probably be the license - both Gaol and MPFR are LGPL, so including them in a Gecode distribution would make that Gecode package also LGPL, I guess.  Again, if a user decides to build their own Gecode with this included, it's fine, so it's great to have the option.  But for a standard Gecode release my understanding was that the ideal license would be MIT-style.
>>> 
>>> Best,
>>> Filip
>>> 
>>> 
>>> _______________________________________________
>>> Gecode users mailing list
>>> users at gecode.org
>>> https://www.gecode.org/mailman/listinfo/gecode-users
>>> 
>> 
>> 
>> 
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From kisshen at cisco.com  Mon Nov  7 20:55:57 2011
From: kisshen at cisco.com (Kish Shen)
Date: Mon, 07 Nov 2011 19:55:57 +0000
Subject: [gecode-users] Efficiently excluding a set of values from the
 domains of multiple IntVars
Message-ID: <4EB837CD.80304@cisco.com>

Hi,

A user who is testing the ECLiPSe Gecode Interface reports an issue he 
is having with trying to convert his application from using ECLiPSe's 
native solver:

He needs to exclude the same set of values from the domains of a set of 
variables. With ECLiPSe's native ic solver, he is doing this with a 
primitive which exclude one value from one variable, so he has an outer 
loop that loops through the variables, and then for each variable, each 
value is excluded:

foreach(V, Vars) do
     foreach(Val, Values) do exclude(Val, V)

where exclude removes Val from variable V's domain.

When this code was used in the Gecode interface, the execution time was 
about 15 times slower than when running with ic.

In the Gecode interface, the exclude is implemented using a reified 
dom() constraint, i.e. something like:

    dom(home, V, Val, 0)

Part of the reason for this difference is the removal of one element at 
a time. In ic, interer domains are represented as bitmaps, so removing 
one value at a time is quite efficient, it is simply a bit operation.
I assume this is not the case with Gecode?

As a way to exclude all the values at the same time, he used reified dom 
constraint directly, i.e. something like:

     dom(V, Values, 0);

this is faster, but is still 5 times slower than the original code in 
ic, and about 20% slower than the equivalent ic code (i.e. also using 
reified domain constraint).

Some of the remaining difference is probably caused by the overheads the 
Gecode interface needs for allowing recomputation/cloning -- posting of 
constraints need to be remembered so that they can be recomputed if 
needed. So it should be much more efficient if the set of values can be 
excluded from all the variables at once, i.e. something like:

    dom(Vars, Values, 0)

however, the refieid domain constraint supports only IntVar, and not 
IntVarArgs (unlike the non-reified versions of the constraint).

ECLiPSe also does not support reified domain constraint on multiple 
variables (nor the exclusion of a single value from multiple variables, 
which is why my user has a loop through the variables). Is there any 
strong reason for this restriction, or is it because it is unlikely that 
you want to reify the domain of a set of variables in the same way?

Is there a more efficient/direct way in Gecode of excluding one value or 
a set of values from the domain of one (or multiple) variables? I am 
using reified domain constraint because I could not find any more direct 
way of doing this?

Thanks and cheers,

Kish




-- 
This e-mail may contain confidential and privileged material for the
sole use of the intended recipient. Any review, use, distribution or
disclosure by others is strictly prohibited. If you are not the intended
recipient (or authorized to receive for the recipient), please contact
the sender by reply e-mail and delete all copies of this message.
Cisco Systems Limited (Company Number: 02558939), is registered in
England and Wales with its registered office at 1 Callaghan Square,
Cardiff, South Glamorgan CF10 5BT.


From tack at gecode.org  Tue Nov  8 10:15:48 2011
From: tack at gecode.org (Guido Tack)
Date: Tue, 8 Nov 2011 10:15:48 +0100
Subject: [gecode-users] Efficiently excluding a set of values from the
	domains of multiple IntVars
In-Reply-To: <4EB837CD.80304@cisco.com>
References: <4EB837CD.80304@cisco.com>
Message-ID: <9330E4CA-8017-46B6-BF29-D2D5E58F1ED3@gecode.org>

Hi Kish,

I think the main difference will be the domain representation.  Gecode's list-of-ranges representation is inherently less efficient for this type of operation than a bitset.  The best option is of course to create the variables with the right domain in the first place.

There was a small bug in the reified dom constraints in Gecode, which didn't update the domain immediately if the control variable was assigned, but posted propagators instead.  This was easy to fix (it's in the svn trunk now), but in my experiments only accounts for at most 25% overhead (tested with 50000 variables, domain 1..50000, and excluding a random set of 1000 integers from the domains).

I don't think a reified dom for IntVarArgs would be very useful.  If you think it's useful for the eclipse interface, you could simply add that constraint to the native part of the interface (it wouldn't make the execution more efficient, but you'd only have to store one constraint for the backtracking).

Cheers,
Guido

On 7 Nov 2011, at 20:55, Kish Shen wrote:

> Hi,
> 
> A user who is testing the ECLiPSe Gecode Interface reports an issue he is having with trying to convert his application from using ECLiPSe's native solver:
> 
> He needs to exclude the same set of values from the domains of a set of variables. With ECLiPSe's native ic solver, he is doing this with a primitive which exclude one value from one variable, so he has an outer loop that loops through the variables, and then for each variable, each value is excluded:
> 
> foreach(V, Vars) do
>    foreach(Val, Values) do exclude(Val, V)
> 
> where exclude removes Val from variable V's domain.
> 
> When this code was used in the Gecode interface, the execution time was about 15 times slower than when running with ic.
> 
> In the Gecode interface, the exclude is implemented using a reified dom() constraint, i.e. something like:
> 
>   dom(home, V, Val, 0)
> 
> Part of the reason for this difference is the removal of one element at a time. In ic, interer domains are represented as bitmaps, so removing one value at a time is quite efficient, it is simply a bit operation.
> I assume this is not the case with Gecode?
> 
> As a way to exclude all the values at the same time, he used reified dom constraint directly, i.e. something like:
> 
>    dom(V, Values, 0);
> 
> this is faster, but is still 5 times slower than the original code in ic, and about 20% slower than the equivalent ic code (i.e. also using reified domain constraint).
> 
> Some of the remaining difference is probably caused by the overheads the Gecode interface needs for allowing recomputation/cloning -- posting of constraints need to be remembered so that they can be recomputed if needed. So it should be much more efficient if the set of values can be excluded from all the variables at once, i.e. something like:
> 
>   dom(Vars, Values, 0)
> 
> however, the refieid domain constraint supports only IntVar, and not IntVarArgs (unlike the non-reified versions of the constraint).
> 
> ECLiPSe also does not support reified domain constraint on multiple variables (nor the exclusion of a single value from multiple variables, which is why my user has a loop through the variables). Is there any strong reason for this restriction, or is it because it is unlikely that you want to reify the domain of a set of variables in the same way?
> 
> Is there a more efficient/direct way in Gecode of excluding one value or a set of values from the domain of one (or multiple) variables? I am using reified domain constraint because I could not find any more direct way of doing this?
> 
> Thanks and cheers,
> 
> Kish
> 
> 
> 
> 
> -- 
> This e-mail may contain confidential and privileged material for the
> sole use of the intended recipient. Any review, use, distribution or
> disclosure by others is strictly prohibited. If you are not the intended
> recipient (or authorized to receive for the recipient), please contact
> the sender by reply e-mail and delete all copies of this message.
> Cisco Systems Limited (Company Number: 02558939), is registered in
> England and Wales with its registered office at 1 Callaghan Square,
> Cardiff, South Glamorgan CF10 5BT.
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users

-- 
Guido Tack, http://people.cs.kuleuven.be/~guido.tack/







From aemhm1 at hotmail.com  Fri Nov 18 02:28:03 2011
From: aemhm1 at hotmail.com (Milton Friedman)
Date: Thu, 17 Nov 2011 20:28:03 -0500
Subject: [gecode-users] Indexing into arrays
Message-ID: <SNT117-W313A93C9ACD8A3B665F40192C40@phx.gbl>


I've been learning and coding in Gecode for the past few weeks.  I read and re-read the modeling parts of MPG, and checked the online docs for syntax.I've tried recasting my application several times and each time I get blocked by syntax I'd expect to exist that doesn't.I hardly ever seem to have a reification-suitable situation, and when I do, it's with a function that doesn't support reification.I'm used to languages that let you put data in arrays and then index into the arrays to solve problems.  The Gecode examples seem to have variable arrays, and constant integer indices into them, based on a fixed problem structures, like Sudoku etc., but in my case the application structure that's constant is the array, and the parts of it that I need to index into are determined by the finite-domain variables.
Below is an example.  I'm trying to use an IntVarArgs to index into a vector of constants (in this case booleans).I can't figure out how to get Gecode to index directly into the C++ vector, so I create a BoolVarArgs vector and copy the constants into it...seems wasteful but ok.Then I do the indexing into a vector of constants, with a single number (1-item domain), and it tells me the binary result is [0..1] -- not especially enlightening news about a binary.So I must be missing something obvious about how to index in Gecode.  Any thoughts?Any help or guidance would be appreciated.Thanks,-Milt   
	//notCD is a C++ boolean vector: knows nothing about Gecode        bool * notCD        notCD = new bool [VecLength];        for (int i = 0; i<VecLength; i++) {                notCD[i] = abs(some2D_integer_array[i][2])==1;          }                      //Create nCD: BoolVarArgs vector of notCD       //only creating nCD because I can't get Gecode to let me work directly with notCD        BoolVarArgs nCD(VecLength);        for(int i=0; i<VecLength; i++){ //expected to write nCD[i]=notCD[i]; or maybe nCD[i]=expr(*this,notCD[i]); or nCD[i]=expr(*this,element(notCD,i));                                        // but none of these forms compiled                if (notCD[i]){                        nCD[i]=T;                }                else {                        nCD[i]=F;                }        }        //I'm really just trying to index with an item of an IntVarArgs vector into a C++ boolean vector        IntVar da;        for(int i=0; i<3; i++){                da = p[iterm+i];        //p is an IntVarArgs with all terms assigned, and p[iTerm+0] is 192                ds[i] = expr(*this,element(nCD,da),ICL_DOM);                cout<<"da: "<<da<<", ds["<<i<<"]: "<<ds[i]<<", nCD[192]: "<<nCD[192]<<"  ";        }        //-------------------        //so unfortunately the output is:        //da: 192, ds[0]: [0..1], nCD[192]: 1        //        //why isn't the output:        //da: 192, ds[0]: 1, nCD[192]: 1        //why is there indecision about ds[0]?...how do I get Gecode to understand that ds[0] must be 1? 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20111117/0b719d94/attachment.html>

From tack at gecode.org  Fri Nov 18 08:23:14 2011
From: tack at gecode.org (Guido Tack)
Date: Fri, 18 Nov 2011 08:23:14 +0100
Subject: [gecode-users] Indexing into arrays
In-Reply-To: <SNT117-W313A93C9ACD8A3B665F40192C40@phx.gbl>
References: <SNT117-W313A93C9ACD8A3B665F40192C40@phx.gbl>
Message-ID: <27FCB3CF-2EC2-4AD8-826E-5EB1E2305039@gecode.org>

Hi Milt,

just posting a constraint does not mean it is "executed".  Running search for your problem (or, in fact, just calling status() on the space you post the constraints in) should determine that ds[0]=1.  See Tip 2.2 "Propagation is explicit" in Modeling and Programing with Gecode.

Cheers,
Guido

On 18 Nov 2011, at 02:28, Milton Friedman wrote:

> I've been learning and coding in Gecode for the past few weeks.  I read and re-read the modeling parts of MPG, and checked the online docs for syntax.
> 
> I've tried recasting my application several times and each time I get blocked by syntax I'd expect to exist that doesn't.
> 
> I hardly ever seem to have a reification-suitable situation, and when I do, it's with a function that doesn't support reification.
> 
> 
> I'm used to languages that let you put data in arrays and then index into the arrays to solve problems.  The Gecode examples seem to have variable arrays, and constant integer indices into them, based on a fixed problem structures, like Sudoku etc., but in my case the application structure that's constant is the array, and the parts of it that I need to index into are determined by the finite-domain variables.
> 
> 
> 
> Below is an example.  I'm trying to use an IntVarArgs to index into a vector of constants (in this case booleans).
> 
> I can't figure out how to get Gecode to index directly into the C++ vector, so I create a BoolVarArgs vector and copy the constants into it...seems wasteful but ok.
> 
> Then I do the indexing into a vector of constants, with a single number (1-item domain), and it tells me the binary result is [0..1] -- not especially enlightening news about a binary.
> 
> So I must be missing something obvious about how to index in Gecode.  Any thoughts?
> 
> Any help or guidance would be appreciated.
> 
> Thanks,
> 
> -Milt   
> 
> 
> 
> 	//notCD is a C++ boolean vector: knows nothing about Gecode
> 
>         bool * notCD
> 
>         notCD = new bool [VecLength];
> 
>         for (int i = 0; i<VecLength; i++) {
> 
>                 notCD[i] = abs(some2D_integer_array[i][2])==1;  
> 
>         }              
> 
>         //Create nCD: BoolVarArgs vector of notCD       //only creating nCD because I can't get Gecode to let me work directly with notCD
> 
>         BoolVarArgs nCD(VecLength);
> 
>         for(int i=0; i<VecLength; i++){ //expected to write nCD[i]=notCD[i]; or maybe nCD[i]=expr(*this,notCD[i]); or nCD[i]=expr(*this,element(notCD,i));
> 
>                                         // but none of these forms compiled
> 
>                 if (notCD[i]){
> 
>                         nCD[i]=T;
> 
>                 }
> 
>                 else {
> 
>                         nCD[i]=F;
> 
>                 }
> 
>         }
> 
>         //I'm really just trying to index with an item of an IntVarArgs vector into a C++ boolean vector
> 
>         IntVar da;
> 
>         for(int i=0; i<3; i++){
> 
>                 da = p[iterm+i];        //p is an IntVarArgs with all terms assigned, and p[iTerm+0] is 192
> 
>                 ds[i] = expr(*this,element(nCD,da),ICL_DOM);
> 
>                 cout<<"da: "<<da<<", ds["<<i<<"]: "<<ds[i]<<", nCD[192]: "<<nCD[192]<<"  ";
> 
>         }
> 
>         //-------------------
> 
>         //so unfortunately the output is:
> 
>         //da: 192, ds[0]: [0..1], nCD[192]: 1
> 
>         //
> 
>         //why isn't the output:
> 
>         //da: 192, ds[0]: 1, nCD[192]: 1
> 
>         //why is there indecision about ds[0]?...how do I get Gecode to understand that ds[0] must be 1?
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users

-- 
Guido Tack, http://people.cs.kuleuven.be/~guido.tack/




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20111118/3bb75249/attachment-0001.htm>

From mdsolimu at ualberta.ca  Fri Nov 18 10:12:26 2011
From: mdsolimu at ualberta.ca (Md Solimul Chowdhury)
Date: Fri, 18 Nov 2011 02:12:26 -0700
Subject: [gecode-users] Implementing multiple GECODE models in a single Space
Message-ID: <CAMm5P0aS_WFPoNqrD=xkLy4NnVjthsaHwzkd6s7O5P4EX6Bucg@mail.gmail.com>

Hi,

Good day. Currently I am engaged in a research project which involves
integrating global constraints into SAT solving. I have built a prototype
system for the integration framework and have used GECODE as the constraint
solving engine.

In my prototype system, global constraints are part of the SAT formula (in
which a global constraint is represented as a Boolean variable) and the
GECODE is invoked whenever a global constraint is implied to be true by the
SAT solver.

Now I am stuck with a problem of GECODE.


In GECODE, is there any way to share a Space between multiple related
GECODE models? I want to come up with a GECODE program which will contain
multiple GECODE models (each will contain a CSP), but all these models will
be implemented in the same space.

For example, for the magic square problem of order 3, there are
3 'linear' global constraints for the rows,
3 for the columns, and
2 for the 2 diagonals (total 8 'linear' global constraints)

Instead of posting all the required 'linear' global constraints in a single
GECODE model (i.e one that is given in the Gecode\Example directory), I
want to post each of the 'linear' global constraints in 8 separate GECODE
model.
But, as these 'linear' global constraints are related, I want to post them
on the same CSP variable (i.e. on a global IntVarArray), to enable the
propagators for all the related 'linear' global constraints upon a View
change.
In essence, I want to come up with a program which will contain 8 GECODE
models, which individually models  each of these 'linear' global
constraints, but each of the models will share the same Space.


Thanks in advance.

Sincerely,
Md Solimul Chowdhury
Department of Computing Science,
University of Alberta, Alberta, Canada.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20111118/e2d724c0/attachment.htm>

From ostrowsk at cs.uni-potsdam.de  Fri Nov 18 13:29:22 2011
From: ostrowsk at cs.uni-potsdam.de (Max Ostrowski)
Date: Fri, 18 Nov 2011 13:29:22 +0100
Subject: [gecode-users] Search and Recomputation
Message-ID: <4EC64FA2.5040407@cs.uni-potsdam.de>

I have 2 general questions on how search works in gecode.

Search and Propagation

I just read on page 306 in "Modelling and Programming with Gecode", that
during search "pristine" clones are stored, where no propagation was made.
How is this possible. Considering the simple case, without
recomputation, having a full "trail" of spaces.
having space[0] to space[n] for the first n decision levels.
Now i do a choice on some variable x==1.
Now i would expect doing some propagation.
Do you copy the space[n+1], do some propagation, and afterwards delete
the propagated space to do another choice ?
Do you always propagate all constraints with all choices without storing
intermediate, usable, results of this propagation?




2nd Question:

Using Recomputation:


If i have stored a space S and done some choices C1,C2,C3

S->C1->S1->C2->S2->C3->S3

and now recognize that space S3 is failed and want to "backtrack" to S2
i would do

S->commit(C1)
S->commit(C2)

This should lead to a space equivalent to S2. Is this space already
propagated ?
If i now call status() on S, is any propagator invoked?
Does commit redo the propagation?
Does it just restore the effects of the propagation?
Does it just repost the decision (as i could do by hand saying post(x==1) )?

Best,

Max Ostrowski



From tack at gecode.org  Fri Nov 18 13:38:46 2011
From: tack at gecode.org (Guido Tack)
Date: Fri, 18 Nov 2011 13:38:46 +0100
Subject: [gecode-users] Search and Recomputation
In-Reply-To: <4EC64FA2.5040407@cs.uni-potsdam.de>
References: <4EC64FA2.5040407@cs.uni-potsdam.de>
Message-ID: <6CBF6002-161F-41D1-9313-DBB5D29FB50A@gecode.org>

On 18 Nov 2011, at 13:29, Max Ostrowski wrote:

> I have 2 general questions on how search works in gecode.
> 
> Search and Propagation
> 
> I just read on page 306 in "Modelling and Programming with Gecode", that
> during search "pristine" clones are stored, where no propagation was made.
> How is this possible. Considering the simple case, without
> recomputation, having a full "trail" of spaces.
> having space[0] to space[n] for the first n decision levels.
> Now i do a choice on some variable x==1.
> Now i would expect doing some propagation.
> Do you copy the space[n+1], do some propagation, and afterwards delete
> the propagated space to do another choice ?
> Do you always propagate all constraints with all choices without storing
> intermediate, usable, results of this propagation?

I'm not sure I understand this question.  The only way to store results of propagation is to store a clone of a space.  That's what a search engine does. either for every choice point, or only for some (in case of recomputation).  Please read the chapter about search engines, it will answer your questions about which spaces are stored (in particular 36.5, hybrid recomputation).  

> 2nd Question:
> 
> Using Recomputation:
> 
> 
> If i have stored a space S and done some choices C1,C2,C3
> 
> S->C1->S1->C2->S2->C3->S3
> 
> and now recognize that space S3 is failed and want to "backtrack" to S2
> i would do
> 
> S->commit(C1)
> S->commit(C2)
> 
> This should lead to a space equivalent to S2. Is this space already
> propagated ?
> If i now call status() on S, is any propagator invoked?
> Does commit redo the propagation?
> Does it just restore the effects of the propagation?
> Does it just repost the decision (as i could do by hand saying post(x==1) )?

It just posts the decision (that's the point of having choices, you only run the entire propagation once, after posting all the choices).  Calling status() will trigger all the propagation that results from the choices you committed to.  Committing to choices is therefore the same as posting constraints (no propagation happens until you call status()).

Cheers,
Guido

-- 
Guido Tack, http://people.cs.kuleuven.be/~guido.tack/



From cschulte at kth.se  Fri Nov 18 13:45:34 2011
From: cschulte at kth.se (Christian Schulte)
Date: Fri, 18 Nov 2011 13:45:34 +0100
Subject: [gecode-users] Search and Recomputation
In-Reply-To: <6CBF6002-161F-41D1-9313-DBB5D29FB50A@gecode.org>
References: <4EC64FA2.5040407@cs.uni-potsdam.de>
	<6CBF6002-161F-41D1-9313-DBB5D29FB50A@gecode.org>
Message-ID: <016c01cca5ef$f7c918e0$e75b4aa0$@se>

Before reading part S you should read all of Chapter 7. Your questions are
answered there.

Christian

--
Christian Schulte, www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Guido Tack
Sent: Friday, November 18, 2011 1:39 PM
To: Max Ostrowski
Cc: users at gecode.org
Subject: Re: [gecode-users] Search and Recomputation

On 18 Nov 2011, at 13:29, Max Ostrowski wrote:

> I have 2 general questions on how search works in gecode.
> 
> Search and Propagation
> 
> I just read on page 306 in "Modelling and Programming with Gecode", 
> that during search "pristine" clones are stored, where no propagation was
made.
> How is this possible. Considering the simple case, without 
> recomputation, having a full "trail" of spaces.
> having space[0] to space[n] for the first n decision levels.
> Now i do a choice on some variable x==1.
> Now i would expect doing some propagation.
> Do you copy the space[n+1], do some propagation, and afterwards delete 
> the propagated space to do another choice ?
> Do you always propagate all constraints with all choices without 
> storing intermediate, usable, results of this propagation?

I'm not sure I understand this question.  The only way to store results of
propagation is to store a clone of a space.  That's what a search engine
does. either for every choice point, or only for some (in case of
recomputation).  Please read the chapter about search engines, it will
answer your questions about which spaces are stored (in particular 36.5,
hybrid recomputation).  

> 2nd Question:
> 
> Using Recomputation:
> 
> 
> If i have stored a space S and done some choices C1,C2,C3
> 
> S->C1->S1->C2->S2->C3->S3
> 
> and now recognize that space S3 is failed and want to "backtrack" to 
> S2 i would do
> 
> S->commit(C1)
> S->commit(C2)
> 
> This should lead to a space equivalent to S2. Is this space already 
> propagated ?
> If i now call status() on S, is any propagator invoked?
> Does commit redo the propagation?
> Does it just restore the effects of the propagation?
> Does it just repost the decision (as i could do by hand saying post(x==1)
)?

It just posts the decision (that's the point of having choices, you only run
the entire propagation once, after posting all the choices).  Calling
status() will trigger all the propagation that results from the choices you
committed to.  Committing to choices is therefore the same as posting
constraints (no propagation happens until you call status()).

Cheers,
Guido

--
Guido Tack, http://people.cs.kuleuven.be/~guido.tack/


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From cschulte at kth.se  Fri Nov 18 13:48:01 2011
From: cschulte at kth.se (Christian Schulte)
Date: Fri, 18 Nov 2011 13:48:01 +0100
Subject: [gecode-users] Implementing multiple GECODE models in a single
	Space
In-Reply-To: <CAMm5P0aS_WFPoNqrD=xkLy4NnVjthsaHwzkd6s7O5P4EX6Bucg@mail.gmail.com>
References: <CAMm5P0aS_WFPoNqrD=xkLy4NnVjthsaHwzkd6s7O5P4EX6Bucg@mail.gmail.com>
Message-ID: <016f01cca5f0$4eca5a00$ec5f0e00$@se>

Hi,

 

That's not possible: a variable always belongs to a space (the space in
which you created it) and you can use variables for propagation only with
constraints posted in the space the variables belong to.

 

What you could do is to store the variable domains outside of any space (as
in an array of integer sets IntSet) and then propagate the information into
the spaces you want to use (for example by the dom constraint).

 

Christian

 

--

Christian Schulte, www.ict.kth.se/~cschulte/

 

From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Md Solimul Chowdhury
Sent: Friday, November 18, 2011 10:12 AM
To: users at gecode.org
Subject: [gecode-users] Implementing multiple GECODE models in a single
Space

 

Hi,

 

Good day. Currently I am engaged in a research project which involves
integrating global constraints into SAT solving. I have built a prototype
system for the integration framework and have used GECODE as the constraint
solving engine. 

 

In my prototype system, global constraints are part of the SAT formula (in
which a global constraint is represented as a Boolean variable) and the
GECODE is invoked whenever a global constraint is implied to be true by the
SAT solver.

 

Now I am stuck with a problem of GECODE. 

 

 

In GECODE, is there any way to share a Space between multiple related GECODE
models? I want to come up with a GECODE program which will contain multiple
GECODE models (each will contain a CSP), but all these models will be
implemented in the same space.

 

For example, for the magic square problem of order 3, there are 

3 'linear' global constraints for the rows, 

3 for the columns, and 

2 for the 2 diagonals (total 8 'linear' global constraints)

 

Instead of posting all the required 'linear' global constraints in a single
GECODE model (i.e one that is given in the Gecode\Example directory), I want
to post each of the 'linear' global constraints in 8 separate GECODE model. 

But, as these 'linear' global constraints are related, I want to post them
on the same CSP variable (i.e. on a global IntVarArray), to enable the
propagators for all the related 'linear' global constraints upon a View
change. 

In essence, I want to come up with a program which will contain 8 GECODE
models, which individually models  each of these 'linear' global
constraints, but each of the models will share the same Space.

 

 

Thanks in advance.

 

Sincerely,

Md Solimul Chowdhury

Department of Computing Science,

University of Alberta, Alberta, Canada.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20111118/93d66a90/attachment.htm>

From aemhm1 at hotmail.com  Sun Nov 20 19:42:40 2011
From: aemhm1 at hotmail.com (Milt)
Date: Sun, 20 Nov 2011 18:42:40 +0000 (UTC)
Subject: [gecode-users] Indexing into arrays
References: <SNT117-W313A93C9ACD8A3B665F40192C40@phx.gbl>
	<27FCB3CF-2EC2-4AD8-826E-5EB1E2305039@gecode.org>
Message-ID: <loom.20111120T182513-172@post.gmane.org>

Guido,
Thanks for your quick reply!  I'd certainly missed that point about status()
...got it.
But I think I still must be missing something, because I'm getting behavior I
don't quite understand.
So I distilled my code down to the simple example below that behaves as
follows.
  -When I run the code below, I get these results (the rel(!A[0]) fails the
space):
      A[0]=1, B0=0, C=0
      A[1]=[0..1], B1=193, C=0
  -I'd have expected A[1] to be equal to 0.
  -But when I change the assignment of B0 from 
      expr(*this,0) to 
      expr(*this,192), 
   I get what I'd expect as results (the rel(!A[0]) doesn't fail the space):
      A[0]=0, B0=192, C=0
      A[1]=0, B1=193, C=0
Is this what's meant in MPG section 4.1.7, that after a space fails, the domain
may have more content than expected?

Question: If so, then when the space fails during the relation !A[0], why does
Gecode keep running my code to define A[1], do the status, and the couts?
(I'd have expected Gecode to recognize that the space failed, abandon the
failed space ASAP, and hurry to try another branching variable or value.)

Also, my approach to debugging the constraint posting within my model is to use
compiler directives (#if, #else, #endif) to maintain 2 paths thru my code: 

1 - one that is normal, branching and exploring as intended, for example on an
IntVarArray "list", which my code uses to compose constraints to post, and

2 - one that is for debugging a single test case at a time, so it branches and
updates a different variable array "list_other", which my code ignores, and
defines an IntVarArgs "list", and defines its items specifically to be a test
case I'm debugging.  So my code, which is written to examine "list", now
focuses exclusively on the test case.  This lets me avoid the confusion of the
entire design space, and see just how the test case is being treated. (e.g., why
it isn't being filtered out by the constraint I'd expect to catch it, or failing
good cases.)

Question: But, if Gecode shows extra items once it fails, as in the example
below, how can I tell when the space has failed, to know whether my code is
faulty in not narrowing down a domain, or whether some constraint has failed
for the test case and I'm getting the after-fail behavior? (and if so, is there
any simple way to detect which constraint detected the failed space, i.e., the
straw that broke the camel's back; or does order of constraint posting
matter?)

Question: Is this a reasonable debugging strategy for the constraint posting
(I'm not dealing with the search issues yet), or do people typically use other
better techniques?  (not sure where I'd look for Gecode debugging
techniques...saw your interaction w/Roberto Pinto in 2006, but I'm looking for
more of a targetable data dump of the data structures than an interactive Gist
like exploration of the design-space search order -- Gist is great, but not what
I think I need for this purpose.)

Thanks for your help,
-Milt
---------------
class Trim : public Space {
protected:
public:
        IntVarArray IVA;
        // Constructor for script
        Trim()
          :
                IVA(*this, 1, 0, 3)
                {
                IntVar B0 = expr(*this,0);
                IntVar B1 = expr(*this,193);
                int C = 0;
                BoolVarArgs A(2);
                //Post constraints
                A[0] = expr(*this,B0==C,ICL_DOM);          
                rel(*this,!A[0],ICL_DOM);
                A[1] = expr(*this,B1==C,ICL_DOM);          
                status();
                cout<<"A[0]="<<A[0]<<", B0="<<B0<<", C="<<C<<endl;
                cout<<"A[1]="<<A[1]<<", B1="<<B1<<", C="<<C<<endl;
                // post branching
                branch(*this, IVA, INT_VAR_SIZE_MIN, INT_VAL_MIN);
        }
        // search support: Constructor for cloning
        Trim(bool share, Trim& s) : Space(share, s) {
                IVA.update(*this, share, s.IVA);
        }
        // perform copying during cloning
        virtual Space* copy(bool share) {
                return new
                Trim(share,*this);
        }
};



From cschulte at kth.se  Mon Nov 21 14:45:46 2011
From: cschulte at kth.se (Christian Schulte)
Date: Mon, 21 Nov 2011 14:45:46 +0100
Subject: [gecode-users] Indexing into arrays
In-Reply-To: <loom.20111120T182513-172@post.gmane.org>
References: <SNT117-W313A93C9ACD8A3B665F40192C40@phx.gbl>	<27FCB3CF-2EC2-4AD8-826E-5EB1E2305039@gecode.org>
	<loom.20111120T182513-172@post.gmane.org>
Message-ID: <009c01cca853$df9e0990$9eda1cb0$@se>

Hi,

Yes, you are absolutely correct in your analysis: failing a space does not
stop execution of a space's method (or with other words, does not throw a
C++ exception or something like that). The reason for that is that it does
not matter! The code defining the variables, constraints, and propagators is
executed just once initially in order to create the space for the root node
of the search tree. This is cheap. What takes time is doing constraint
propagation (triggered by status()) and this is terminated immediately when
failure occurs.

Maybe MPG should explain this at some point.

I am not sure I understand your second point. After running status() you
should always check whether a space is failed (status() returns that
information). So, when testing why not run status() everytime to make sure
that things are not yet failed?

Christian

--
Christian Schulte, www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Milt
Sent: Sunday, November 20, 2011 7:43 PM
To: users at gecode.org
Subject: Re: [gecode-users] Indexing into arrays

Guido,
Thanks for your quick reply!  I'd certainly missed that point about status()
...got it.
But I think I still must be missing something, because I'm getting behavior
I don't quite understand.
So I distilled my code down to the simple example below that behaves as
follows.
  -When I run the code below, I get these results (the rel(!A[0]) fails the
space):
      A[0]=1, B0=0, C=0
      A[1]=[0..1], B1=193, C=0
  -I'd have expected A[1] to be equal to 0.
  -But when I change the assignment of B0 from 
      expr(*this,0) to 
      expr(*this,192), 
   I get what I'd expect as results (the rel(!A[0]) doesn't fail the space):
      A[0]=0, B0=192, C=0
      A[1]=0, B1=193, C=0
Is this what's meant in MPG section 4.1.7, that after a space fails, the
domain may have more content than expected?

Question: If so, then when the space fails during the relation !A[0], why
does Gecode keep running my code to define A[1], do the status, and the
couts?
(I'd have expected Gecode to recognize that the space failed, abandon the
failed space ASAP, and hurry to try another branching variable or value.)

Also, my approach to debugging the constraint posting within my model is to
use compiler directives (#if, #else, #endif) to maintain 2 paths thru my
code: 

1 - one that is normal, branching and exploring as intended, for example on
an IntVarArray "list", which my code uses to compose constraints to post,
and

2 - one that is for debugging a single test case at a time, so it branches
and updates a different variable array "list_other", which my code ignores,
and defines an IntVarArgs "list", and defines its items specifically to be a
test case I'm debugging.  So my code, which is written to examine "list",
now focuses exclusively on the test case.  This lets me avoid the confusion
of the entire design space, and see just how the test case is being treated.
(e.g., why it isn't being filtered out by the constraint I'd expect to catch
it, or failing good cases.)

Question: But, if Gecode shows extra items once it fails, as in the example
below, how can I tell when the space has failed, to know whether my code is
faulty in not narrowing down a domain, or whether some constraint has failed
for the test case and I'm getting the after-fail behavior? (and if so, is
there any simple way to detect which constraint detected the failed space,
i.e., the straw that broke the camel's back; or does order of constraint
posting
matter?)

Question: Is this a reasonable debugging strategy for the constraint posting
(I'm not dealing with the search issues yet), or do people typically use
other better techniques?  (not sure where I'd look for Gecode debugging
techniques...saw your interaction w/Roberto Pinto in 2006, but I'm looking
for more of a targetable data dump of the data structures than an
interactive Gist like exploration of the design-space search order -- Gist
is great, but not what I think I need for this purpose.)

Thanks for your help,
-Milt
---------------
class Trim : public Space {
protected:
public:
        IntVarArray IVA;
        // Constructor for script
        Trim()
          :
                IVA(*this, 1, 0, 3)
                {
                IntVar B0 = expr(*this,0);
                IntVar B1 = expr(*this,193);
                int C = 0;
                BoolVarArgs A(2);
                //Post constraints
                A[0] = expr(*this,B0==C,ICL_DOM);          
                rel(*this,!A[0],ICL_DOM);
                A[1] = expr(*this,B1==C,ICL_DOM);          
                status();
                cout<<"A[0]="<<A[0]<<", B0="<<B0<<", C="<<C<<endl;
                cout<<"A[1]="<<A[1]<<", B1="<<B1<<", C="<<C<<endl;
                // post branching
                branch(*this, IVA, INT_VAR_SIZE_MIN, INT_VAL_MIN);
        }
        // search support: Constructor for cloning
        Trim(bool share, Trim& s) : Space(share, s) {
                IVA.update(*this, share, s.IVA);
        }
        // perform copying during cloning
        virtual Space* copy(bool share) {
                return new
                Trim(share,*this);
        }
};


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From aemhm1 at hotmail.com  Mon Nov 21 16:10:34 2011
From: aemhm1 at hotmail.com (Milt)
Date: Mon, 21 Nov 2011 15:10:34 +0000 (UTC)
Subject: [gecode-users] Indexing into arrays
References: <SNT117-W313A93C9ACD8A3B665F40192C40@phx.gbl>	<27FCB3CF-2EC2-4AD8-826E-5EB1E2305039@gecode.org>
	<loom.20111120T182513-172@post.gmane.org>
	<009c01cca853$df9e0990$9eda1cb0$@se>
Message-ID: <loom.20111121T145748-725@post.gmane.org>

Thanks Christian,

> ...failing a space does not
> stop execution of a space's method (or with other words, does not throw a
> C++ exception or something like that). The reason for that is that it does
> not matter! The code defining the variables, constraints, and propagators is
> executed just once initially in order to create the space for the root node
> of the search tree. This is cheap. What takes time is doing constraint
> propagation (triggered by status()) and this is terminated immediately when
> failure occurs.

Good...so Gecode is right to keep going after failing the root node because it 
has to finish setting up the model infrastructure once (to post all of the 
constraints), but it's very efficient beyond the root node.  I'll read further 
in the branch and search sections of MPG to better understand how and in what 
order everything executes...that seems to be where I'm fuzziest right now.

> I am not sure I understand your second point. After running status() you
> should always check whether a space is failed (status() returns that
> information). So, when testing why not run status() everytime to make sure
> that things are not yet failed?

Ok, so I can check for the result from status() e.g., SS_FAILED, rather than 
just running status() to force propagation. I just read some more of MPG 
chapter 20 and see there's also ES_FAILED which can be used to determine which 
propagator failed.

I'll give that a shot.
Thanks for your help!
-Milt



From cschulte at kth.se  Mon Nov 21 16:27:29 2011
From: cschulte at kth.se (Christian Schulte)
Date: Mon, 21 Nov 2011 16:27:29 +0100
Subject: [gecode-users] Indexing into arrays
In-Reply-To: <loom.20111121T145748-725@post.gmane.org>
References: <SNT117-W313A93C9ACD8A3B665F40192C40@phx.gbl>	<27FCB3CF-2EC2-4AD8-826E-5EB1E2305039@gecode.org>	<loom.20111120T182513-172@post.gmane.org>	<009c01cca853$df9e0990$9eda1cb0$@se>
	<loom.20111121T145748-725@post.gmane.org>
Message-ID: <00b901cca862$14c52eb0$3e4f8c10$@se>

Uuups, the ES_FAILED is a different beast all together! This is what a
propagator will return to the kernel to signal failure but finding out which
propagator returned it will require hacking the kernel. Frankly, that will
require some stamina ;-)

Christian

--
Christian Schulte, www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Milt
Sent: Monday, November 21, 2011 4:11 PM
To: users at gecode.org
Subject: Re: [gecode-users] Indexing into arrays

Thanks Christian,

> ...failing a space does not
> stop execution of a space's method (or with other words, does not 
> throw a
> C++ exception or something like that). The reason for that is that it 
> C++ does
> not matter! The code defining the variables, constraints, and 
> propagators is executed just once initially in order to create the 
> space for the root node of the search tree. This is cheap. What takes 
> time is doing constraint propagation (triggered by status()) and this 
> is terminated immediately when failure occurs.

Good...so Gecode is right to keep going after failing the root node because
it has to finish setting up the model infrastructure once (to post all of
the constraints), but it's very efficient beyond the root node.  I'll read
further in the branch and search sections of MPG to better understand how
and in what order everything executes...that seems to be where I'm fuzziest
right now.

> I am not sure I understand your second point. After running status() 
> you should always check whether a space is failed (status() returns 
> that information). So, when testing why not run status() everytime to 
> make sure that things are not yet failed?

Ok, so I can check for the result from status() e.g., SS_FAILED, rather than
just running status() to force propagation. I just read some more of MPG
chapter 20 and see there's also ES_FAILED which can be used to determine
which propagator failed.

I'll give that a shot.
Thanks for your help!
-Milt


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From kisshen at cisco.com  Tue Nov 22 08:09:27 2011
From: kisshen at cisco.com (Kish Shen)
Date: Tue, 22 Nov 2011 07:09:27 +0000
Subject: [gecode-users] semantics for count(Home home, const IntVarArgs &x,
 IntVar y, IntRelType r, IntVar z)
Message-ID: <4ECB4AA7.3000701@cisco.com>

Hi,

I have been looking at the behaviour of

count(Home home, const IntVarArgs &x, IntVar y, IntRelType r, IntVar z)

and cannot understand what is happening when IntVar y has more than one 
value in its domain. Until now, I have only tested this constraint with 
y having a singleton value in its domain, and in this case, the 
constraint behaves the same as the case where y is Int, i.e. the number 
of occurrences of the value y in x is counted.

However, one of my user wanted to use the constraint where y has 
multiple values (i.e. the counts constraint in the global constraint 
catalog). I know this constraint is provided with y being an IntSet, but 
my user did not know about this constraint, so he used the version where 
y is a IntVar instead.

I had expected that mulitple domain values in y would behave like 
multiple values in the IntSet for this constraint, but this does not 
seem to be the case. For example, the constraint succeeds with the 
following (in ECLiPSe syntax, but the argument order of Gecode's 
constraint):

Y :: [3,4], count([3,0,3,3,4], Y, =, 2)

where [3,0,3,3,4] is x, IntRelType is IRT_EQ.

I don't understand why this succeeds -- the count for 3 is 3, and for 4 
is 1, and for both 3 and 4 is 4, none of which is equal to 2. So what is 
the semantics?

The equivalent call using y as an IntSet [3,4] fails as expected. Also, 
for the same count constraint, if y has a single domain value (e.g. 3 or 
4), then the constraint behave as I expected, i.e. z = 3 for y = 3, and 
z = 1 for y = 1.

Thanks and cheers,

Kish


-- 
This e-mail may contain confidential and privileged material for the
sole use of the intended recipient. Any review, use, distribution or
disclosure by others is strictly prohibited. If you are not the intended
recipient (or authorized to receive for the recipient), please contact
the sender by reply e-mail and delete all copies of this message.
Cisco Systems Limited (Company Number: 02558939), is registered in
England and Wales with its registered office at 1 Callaghan Square,
Cardiff, South Glamorgan CF10 5BT.


From cschulte at kth.se  Tue Nov 22 09:49:31 2011
From: cschulte at kth.se (Christian Schulte)
Date: Tue, 22 Nov 2011 09:49:31 +0100
Subject: [gecode-users] semantics for count(Home home,
	const IntVarArgs &x, IntVar y, IntRelType r, IntVar z)
In-Reply-To: <4ECB4AA7.3000701@cisco.com>
References: <4ECB4AA7.3000701@cisco.com>
Message-ID: <00f501cca8f3$a8ea52f0$fabef8d0$@se>

This is a fundamental missunderstanding of what an integer set and an
integer variable denotes. 

It might be that the current domain of an integer variable is a set, however
the variable denotes a single integer (which you do not know yet). That's
fundamental and very different from a set.

With that in mind, count behaves exactly like one would expect.

In your example, the constraint does not succeed (as in being entailed). It
just does not fail yet. Let's take the more general example (2 is replaced
by an integer variable Z):

Y :: [3,4], count([3,0,3,3,4], Y, =, Z)

Then it will propagate that Z has the domain [0..4] as there are four
elements in the array that still could be equal to Y with domain 3 or 4 and
one is already known to be different (the element 0) from 3 or 4.

Christian

--
Christian Schulte, www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Kish Shen
Sent: Tuesday, November 22, 2011 8:09 AM
To: users at gecode.org
Subject: [gecode-users] semantics for count(Home home, const IntVarArgs &x,
IntVar y, IntRelType r, IntVar z)

Hi,

I have been looking at the behaviour of

count(Home home, const IntVarArgs &x, IntVar y, IntRelType r, IntVar z)

and cannot understand what is happening when IntVar y has more than one
value in its domain. Until now, I have only tested this constraint with y
having a singleton value in its domain, and in this case, the constraint
behaves the same as the case where y is Int, i.e. the number of occurrences
of the value y in x is counted.

However, one of my user wanted to use the constraint where y has multiple
values (i.e. the counts constraint in the global constraint catalog). I know
this constraint is provided with y being an IntSet, but my user did not know
about this constraint, so he used the version where y is a IntVar instead.

I had expected that mulitple domain values in y would behave like multiple
values in the IntSet for this constraint, but this does not seem to be the
case. For example, the constraint succeeds with the following (in ECLiPSe
syntax, but the argument order of Gecode's
constraint):

Y :: [3,4], count([3,0,3,3,4], Y, =, 2)

where [3,0,3,3,4] is x, IntRelType is IRT_EQ.

I don't understand why this succeeds -- the count for 3 is 3, and for 4 is
1, and for both 3 and 4 is 4, none of which is equal to 2. So what is the
semantics?

The equivalent call using y as an IntSet [3,4] fails as expected. Also, for
the same count constraint, if y has a single domain value (e.g. 3 or 4),
then the constraint behave as I expected, i.e. z = 3 for y = 3, and z = 1
for y = 1.

Thanks and cheers,

Kish


--
This e-mail may contain confidential and privileged material for the sole
use of the intended recipient. Any review, use, distribution or disclosure
by others is strictly prohibited. If you are not the intended recipient (or
authorized to receive for the recipient), please contact the sender by reply
e-mail and delete all copies of this message.
Cisco Systems Limited (Company Number: 02558939), is registered in England
and Wales with its registered office at 1 Callaghan Square, Cardiff, South
Glamorgan CF10 5BT.

_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From kisshen at cisco.com  Tue Nov 22 18:35:13 2011
From: kisshen at cisco.com (Kish Shen)
Date: Tue, 22 Nov 2011 17:35:13 +0000
Subject: [gecode-users] semantics for count(Home home,
 const IntVarArgs &x, IntVar y, IntRelType r, IntVar z)
In-Reply-To: <00f501cca8f3$a8ea52f0$fabef8d0$@se>
References: <4ECB4AA7.3000701@cisco.com> <00f501cca8f3$a8ea52f0$fabef8d0$@se>
Message-ID: <4ECBDD51.7070204@cisco.com>

Hi,

I am still not sure I understand the semantics -- the constraint is 
posted with domain consistency (the default). My understanding of domain 
consistency is that any values remaining in the domain is consistent 
with the constraint, i.e. the constraint should not fail if the variable 
is instantiated to one of the values, as long as this is the only change 
made. For

Y :: [3,4], count([3,0,3,3,4], Y, =, 2)

Y is the only domain variable with more than one value, so if I 
understand domain consistency correctly, then instantiating it to either 
3 or 4 should succeed, but doing so fails for both values.

The documentation states that:

Supports domain consistent propagation (icl = ICL_DOM, default) and 
"almost" domain consistent propagation (all other values for icl), where 
y is not pruned.

(I assume by other values of icl, you exclude ICL_DEF, which behaves as 
ICL_DOM as that is the default)

It seems to me the behaviour is that y is not pruned in the above, even 
when the constraint is posted with ICL_DOM and ICL_DEF -- I have 
explicitly posted the constraint with ICL_DOM, to check if it makes any 
difference, and it does not, i.e. the example with Y::[3,4] succeeds.

Cheers,

Kish


On 22/11/2011 08:49, Christian Schulte wrote:
> This is a fundamental missunderstanding of what an integer set and an
> integer variable denotes.
>
> It might be that the current domain of an integer variable is a set, however
> the variable denotes a single integer (which you do not know yet). That's
> fundamental and very different from a set.
>
> With that in mind, count behaves exactly like one would expect.
>
> In your example, the constraint does not succeed (as in being entailed). It
> just does not fail yet. Let's take the more general example (2 is replaced
> by an integer variable Z):
>
> Y :: [3,4], count([3,0,3,3,4], Y, =, Z)
>
> Then it will propagate that Z has the domain [0..4] as there are four
> elements in the array that still could be equal to Y with domain 3 or 4 and
> one is already known to be different (the element 0) from 3 or 4.
>
> Christian
>
> --
> Christian Schulte, www.ict.kth.se/~cschulte/
>
>
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
> Of Kish Shen
> Sent: Tuesday, November 22, 2011 8:09 AM
> To: users at gecode.org
> Subject: [gecode-users] semantics for count(Home home, const IntVarArgs&x,
> IntVar y, IntRelType r, IntVar z)
>
> Hi,
>
> I have been looking at the behaviour of
>
> count(Home home, const IntVarArgs&x, IntVar y, IntRelType r, IntVar z)
>
> and cannot understand what is happening when IntVar y has more than one
> value in its domain. Until now, I have only tested this constraint with y
> having a singleton value in its domain, and in this case, the constraint
> behaves the same as the case where y is Int, i.e. the number of occurrences
> of the value y in x is counted.
>
> However, one of my user wanted to use the constraint where y has multiple
> values (i.e. the counts constraint in the global constraint catalog). I know
> this constraint is provided with y being an IntSet, but my user did not know
> about this constraint, so he used the version where y is a IntVar instead.
>
> I had expected that mulitple domain values in y would behave like multiple
> values in the IntSet for this constraint, but this does not seem to be the
> case. For example, the constraint succeeds with the following (in ECLiPSe
> syntax, but the argument order of Gecode's
> constraint):
>
> Y :: [3,4], count([3,0,3,3,4], Y, =, 2)
>
> where [3,0,3,3,4] is x, IntRelType is IRT_EQ.
>
> I don't understand why this succeeds -- the count for 3 is 3, and for 4 is
> 1, and for both 3 and 4 is 4, none of which is equal to 2. So what is the
> semantics?
>
> The equivalent call using y as an IntSet [3,4] fails as expected. Also, for
> the same count constraint, if y has a single domain value (e.g. 3 or 4),
> then the constraint behave as I expected, i.e. z = 3 for y = 3, and z = 1
> for y = 1.
>
> Thanks and cheers,
>
> Kish
>
>
> --
> This e-mail may contain confidential and privileged material for the sole
> use of the intended recipient. Any review, use, distribution or disclosure
> by others is strictly prohibited. If you are not the intended recipient (or
> authorized to receive for the recipient), please contact the sender by reply
> e-mail and delete all copies of this message.
> Cisco Systems Limited (Company Number: 02558939), is registered in England
> and Wales with its registered office at 1 Callaghan Square, Cardiff, South
> Glamorgan CF10 5BT.
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>


-- 
This e-mail may contain confidential and privileged material for the
sole use of the intended recipient. Any review, use, distribution or
disclosure by others is strictly prohibited. If you are not the intended
recipient (or authorized to receive for the recipient), please contact
the sender by reply e-mail and delete all copies of this message.
Cisco Systems Limited (Company Number: 02558939), is registered in
England and Wales with its registered office at 1 Callaghan Square,
Cardiff, South Glamorgan CF10 5BT.


From cschulte at kth.se  Tue Nov 22 20:07:06 2011
From: cschulte at kth.se (Christian Schulte)
Date: Tue, 22 Nov 2011 20:07:06 +0100
Subject: [gecode-users] semantics for count(Home home,
	const IntVarArgs &x, IntVar y, IntRelType r, IntVar z)
In-Reply-To: <4ECBDD51.7070204@cisco.com>
References: <4ECB4AA7.3000701@cisco.com> <00f501cca8f3$a8ea52f0$fabef8d0$@se>
	<4ECBDD51.7070204@cisco.com>
Message-ID: <001b01cca949$eeee4080$cccac180$@kth.se>

Right, it is not domain consistent, it just performs domain propagation. I
will update the docs accordingly.

But still, it does not succeed (it is not logically entailed) but it does
not fail yet (as it is not domain consistent). Try labeling Y and see what
happens.

Christian

--
Christian Schulte, KTH, web.it.kth.se/~cschulte/

-----Original Message-----
From: Kish Shen [mailto:kisshen at cisco.com] 
Sent: Tuesday, November 22, 2011 6:35 PM
To: cschulte at kth.se
Cc: users at gecode.org
Subject: Re: [gecode-users] semantics for count(Home home, const IntVarArgs
&x, IntVar y, IntRelType r, IntVar z)

Hi,

I am still not sure I understand the semantics -- the constraint is posted
with domain consistency (the default). My understanding of domain
consistency is that any values remaining in the domain is consistent with
the constraint, i.e. the constraint should not fail if the variable is
instantiated to one of the values, as long as this is the only change made.
For

Y :: [3,4], count([3,0,3,3,4], Y, =, 2)

Y is the only domain variable with more than one value, so if I understand
domain consistency correctly, then instantiating it to either
3 or 4 should succeed, but doing so fails for both values.

The documentation states that:

Supports domain consistent propagation (icl = ICL_DOM, default) and "almost"
domain consistent propagation (all other values for icl), where y is not
pruned.

(I assume by other values of icl, you exclude ICL_DEF, which behaves as
ICL_DOM as that is the default)

It seems to me the behaviour is that y is not pruned in the above, even when
the constraint is posted with ICL_DOM and ICL_DEF -- I have explicitly
posted the constraint with ICL_DOM, to check if it makes any difference, and
it does not, i.e. the example with Y::[3,4] succeeds.

Cheers,

Kish


On 22/11/2011 08:49, Christian Schulte wrote:
> This is a fundamental missunderstanding of what an integer set and an 
> integer variable denotes.
>
> It might be that the current domain of an integer variable is a set, 
> however the variable denotes a single integer (which you do not know 
> yet). That's fundamental and very different from a set.
>
> With that in mind, count behaves exactly like one would expect.
>
> In your example, the constraint does not succeed (as in being 
> entailed). It just does not fail yet. Let's take the more general 
> example (2 is replaced by an integer variable Z):
>
> Y :: [3,4], count([3,0,3,3,4], Y, =, Z)
>
> Then it will propagate that Z has the domain [0..4] as there are four 
> elements in the array that still could be equal to Y with domain 3 or 
> 4 and one is already known to be different (the element 0) from 3 or 4.
>
> Christian
>
> --
> Christian Schulte, www.ict.kth.se/~cschulte/
>
>
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On 
> Behalf Of Kish Shen
> Sent: Tuesday, November 22, 2011 8:09 AM
> To: users at gecode.org
> Subject: [gecode-users] semantics for count(Home home, const 
> IntVarArgs&x, IntVar y, IntRelType r, IntVar z)
>
> Hi,
>
> I have been looking at the behaviour of
>
> count(Home home, const IntVarArgs&x, IntVar y, IntRelType r, IntVar z)
>
> and cannot understand what is happening when IntVar y has more than 
> one value in its domain. Until now, I have only tested this constraint 
> with y having a singleton value in its domain, and in this case, the 
> constraint behaves the same as the case where y is Int, i.e. the 
> number of occurrences of the value y in x is counted.
>
> However, one of my user wanted to use the constraint where y has 
> multiple values (i.e. the counts constraint in the global constraint 
> catalog). I know this constraint is provided with y being an IntSet, 
> but my user did not know about this constraint, so he used the version
where y is a IntVar instead.
>
> I had expected that mulitple domain values in y would behave like 
> multiple values in the IntSet for this constraint, but this does not 
> seem to be the case. For example, the constraint succeeds with the 
> following (in ECLiPSe syntax, but the argument order of Gecode's
> constraint):
>
> Y :: [3,4], count([3,0,3,3,4], Y, =, 2)
>
> where [3,0,3,3,4] is x, IntRelType is IRT_EQ.
>
> I don't understand why this succeeds -- the count for 3 is 3, and for 
> 4 is 1, and for both 3 and 4 is 4, none of which is equal to 2. So 
> what is the semantics?
>
> The equivalent call using y as an IntSet [3,4] fails as expected. 
> Also, for the same count constraint, if y has a single domain value 
> (e.g. 3 or 4), then the constraint behave as I expected, i.e. z = 3 
> for y = 3, and z = 1 for y = 1.
>
> Thanks and cheers,
>
> Kish
>
>
> --
> This e-mail may contain confidential and privileged material for the 
> sole use of the intended recipient. Any review, use, distribution or 
> disclosure by others is strictly prohibited. If you are not the 
> intended recipient (or authorized to receive for the recipient), 
> please contact the sender by reply e-mail and delete all copies of this
message.
> Cisco Systems Limited (Company Number: 02558939), is registered in 
> England and Wales with its registered office at 1 Callaghan Square, 
> Cardiff, South Glamorgan CF10 5BT.
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>


--
This e-mail may contain confidential and privileged material for the sole
use of the intended recipient. Any review, use, distribution or disclosure
by others is strictly prohibited. If you are not the intended recipient (or
authorized to receive for the recipient), please contact the sender by reply
e-mail and delete all copies of this message.
Cisco Systems Limited (Company Number: 02558939), is registered in England
and Wales with its registered office at 1 Callaghan Square, Cardiff, South
Glamorgan CF10 5BT.



From texitoi+news at texitoi.eu  Wed Nov 30 11:20:57 2011
From: texitoi+news at texitoi.eu (TeXitoi)
Date: 30 Nov 2011 11:20:57 +0100
Subject: [gecode-users] multiple non parallel search in different threads
Message-ID: <874nxlykqe.fsf@epiano.texitoi.eu>

Hi!

I use Gecode in a special way:
 - first I generate a problem
 - then I clone (using space->clone(false)) 2 times the problem
 - on each clone, I add some constraints and branching
 - then I launch simultaneously a DFS on each clone in parallel in 2
   differents threads. The options of the DFS is clone=false (to not
   manually delete my manual clone) and default threading mode (so
   sequencial search).

It (randomly) segfault inside Gecode (most of the time in _clone()). I
suspect that the search use clone(true), and that there is problems
with my 2 simultaneous searchs. After reading MPG, I was thinking that
it should work, but I now suspect that each clone in DFS must use false.

Am I right? How to force clone(false) without doing parallel search in
DFS?

Thanks.

-- 
Guillaume Pinot                               http://www.texitoi.eu

? Il semble que la perfection soit atteinte non quand il n'y a plus
rien ? ajouter, mais quand il n'y a plus rien ? retrancher. ?
                      -- Antoine de Saint-Exup?ry, Terre des hommes

()  ASCII ribbon campaign      -- Against HTML e-mail
/\  http://www.asciiribbon.org -- Against proprietary attachments



From cschulte at kth.se  Wed Nov 30 11:26:31 2011
From: cschulte at kth.se (Christian Schulte)
Date: Wed, 30 Nov 2011 11:26:31 +0100
Subject: [gecode-users] multiple non parallel search in different threads
In-Reply-To: <874nxlykqe.fsf@epiano.texitoi.eu>
References: <874nxlykqe.fsf@epiano.texitoi.eu>
Message-ID: <01c501ccaf4a$878d0af0$96a720d0$@se>

Hi,

You should first try to make independent clones so that you can use them
with different threads:

a) Suppose you have a space s.
b) You compute the fixpoint by s->status(). If s->status() return SS_FAILED
you are done.
c) Create two clones c1 and c2 by c1 = s->clone(false) and c2 =
s->clone(false).
d) Now you can use c1 and c2 in two different threads with the normal DFS
engines.

Christian

--
Christian Schulte, www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of TeXitoi
Sent: Wednesday, November 30, 2011 11:21 AM
To: users at gecode.org
Subject: [gecode-users] multiple non parallel search in different threads

Hi!

I use Gecode in a special way:
 - first I generate a problem
 - then I clone (using space->clone(false)) 2 times the problem
 - on each clone, I add some constraints and branching
 - then I launch simultaneously a DFS on each clone in parallel in 2
   differents threads. The options of the DFS is clone=false (to not
   manually delete my manual clone) and default threading mode (so
   sequencial search).

It (randomly) segfault inside Gecode (most of the time in _clone()). I
suspect that the search use clone(true), and that there is problems with my
2 simultaneous searchs. After reading MPG, I was thinking that it should
work, but I now suspect that each clone in DFS must use false.

Am I right? How to force clone(false) without doing parallel search in DFS?

Thanks.

-- 
Guillaume Pinot                               http://www.texitoi.eu

? Il semble que la perfection soit atteinte non quand il n'y a plus rien ?
ajouter, mais quand il n'y a plus rien ? retrancher. ?
                      -- Antoine de Saint-Exup?ry, Terre des hommes

()  ASCII ribbon campaign      -- Against HTML e-mail
/\  http://www.asciiribbon.org -- Against proprietary attachments


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From texitoi+news at texitoi.eu  Wed Nov 30 11:59:56 2011
From: texitoi+news at texitoi.eu (TeXitoi)
Date: 30 Nov 2011 11:59:56 +0100
Subject: [gecode-users] multiple non parallel search in different threads
References: <874nxlykqe.fsf@epiano.texitoi.eu>
	<01c501ccaf4a$878d0af0$96a720d0$@se>
Message-ID: <87zkfdx4cz.fsf@epiano.texitoi.eu>

"Christian Schulte" <cschulte at kth.se> writes:

> Hi,
> 
> You should first try to make independent clones so that you can use them
> with different threads:
> 
> a) Suppose you have a space s.
> b) You compute the fixpoint by s->status(). If s->status() return SS_FAILED
> you are done.
> c) Create two clones c1 and c2 by c1 = s->clone(false) and c2 =
> s->clone(false).

I have added a method that is :

MySpace *MySpace::safeClone()
{
    if (status() != SS_FAILED) {
        MySpace *that = static_cast<MySpace*>(clone(false));
        that->status();
        return that;
    } else return 0;
}

and do every clone with it.

> d) Now you can use c1 and c2 in two different threads with the normal DFS
> engines.

If I understand correctly, my code should work, but it doesn't.

I'll try on linux to see if I can reproduce it (tested on OpenBSD and
Cygwin, I do not have a big confidence on threads on these platforms).
And if I can, I'll try to write a small example showing the problem.

-- 
Guillaume Pinot                               http://www.texitoi.eu

? Il semble que la perfection soit atteinte non quand il n'y a plus
rien ? ajouter, mais quand il n'y a plus rien ? retrancher. ?
                      -- Antoine de Saint-Exup?ry, Terre des hommes

()  ASCII ribbon campaign      -- Against HTML e-mail
/\  http://www.asciiribbon.org -- Against proprietary attachments



From cschulte at kth.se  Wed Nov 30 12:06:54 2011
From: cschulte at kth.se (Christian Schulte)
Date: Wed, 30 Nov 2011 12:06:54 +0100
Subject: [gecode-users] multiple non parallel search in different threads
In-Reply-To: <87zkfdx4cz.fsf@epiano.texitoi.eu>
References: <874nxlykqe.fsf@epiano.texitoi.eu>	<01c501ccaf4a$878d0af0$96a720d0$@se>
	<87zkfdx4cz.fsf@epiano.texitoi.eu>
Message-ID: <01ef01ccaf50$2b4b9580$81e2c080$@se>

In which thread do you create the search engines? In the main thread or in
your slave threads?

It is pretty unlikely that this is buggy in Gecode as the parallel search
engines that come with Gecode do more or less what you do.

Cygwin is not a supported platform and we also have close to no experience
on FreeBSD. Use Windows, Mac, or Linux, there things should work.

BTW: There is no need to call status on a fresh clone.

Christian

--
Christian Schulte, www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of TeXitoi
Sent: Wednesday, November 30, 2011 12:00 PM
To: users at gecode.org
Subject: Re: [gecode-users] multiple non parallel search in different
threads

"Christian Schulte" <cschulte at kth.se> writes:

> Hi,
> 
> You should first try to make independent clones so that you can use 
> them with different threads:
> 
> a) Suppose you have a space s.
> b) You compute the fixpoint by s->status(). If s->status() return 
> SS_FAILED you are done.
> c) Create two clones c1 and c2 by c1 = s->clone(false) and c2 =
> s->clone(false).

I have added a method that is :

MySpace *MySpace::safeClone()
{
    if (status() != SS_FAILED) {
        MySpace *that = static_cast<MySpace*>(clone(false));
        that->status();
        return that;
    } else return 0;
}

and do every clone with it.

> d) Now you can use c1 and c2 in two different threads with the normal 
> DFS engines.

If I understand correctly, my code should work, but it doesn't.

I'll try on linux to see if I can reproduce it (tested on OpenBSD and
Cygwin, I do not have a big confidence on threads on these platforms).
And if I can, I'll try to write a small example showing the problem.

-- 
Guillaume Pinot                               http://www.texitoi.eu

? Il semble que la perfection soit atteinte non quand il n'y a plus rien ?
ajouter, mais quand il n'y a plus rien ? retrancher. ?
                      -- Antoine de Saint-Exup?ry, Terre des hommes

()  ASCII ribbon campaign      -- Against HTML e-mail
/\  http://www.asciiribbon.org -- Against proprietary attachments


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From texitoi+news at texitoi.eu  Wed Nov 30 13:05:13 2011
From: texitoi+news at texitoi.eu (TeXitoi)
Date: 30 Nov 2011 13:05:13 +0100
Subject: [gecode-users] multiple non parallel search in different threads
References: <874nxlykqe.fsf@epiano.texitoi.eu>
	<01c501ccaf4a$878d0af0$96a720d0$@se>
	<87zkfdx4cz.fsf@epiano.texitoi.eu>
	<01ef01ccaf50$2b4b9580$81e2c080$@se>
Message-ID: <87vcq1x1c6.fsf@epiano.texitoi.eu>

"Christian Schulte" <cschulte at kth.se> writes:

> In which thread do you create the search engines? In the main thread or in
> your slave threads?

in the slave threads.

> It is pretty unlikely that this is buggy in Gecode as the parallel search
> engines that come with Gecode do more or less what you do.
> 
> Cygwin is not a supported platform and we also have close to no experience
> on FreeBSD. Use Windows, Mac, or Linux, there things should work.

OK, I will try on linux and report the results here.

> BTW: There is no need to call status on a fresh clone.

OK, I will remove that line.

Thanks.

-- 
Guillaume Pinot                               http://www.texitoi.eu

? Il semble que la perfection soit atteinte non quand il n'y a plus
rien ? ajouter, mais quand il n'y a plus rien ? retrancher. ?
                      -- Antoine de Saint-Exup?ry, Terre des hommes

()  ASCII ribbon campaign      -- Against HTML e-mail
/\  http://www.asciiribbon.org -- Against proprietary attachments



From trosky99 at gmail.com  Wed Nov 30 13:17:34 2011
From: trosky99 at gmail.com (Alberto Delgado)
Date: Wed, 30 Nov 2011 13:17:34 +0100
Subject: [gecode-users] On IntVar limits
Message-ID: <CAN6C9hKzyb=czhrkiw160P_KO0UUz-bk6EL3WZr_0Foi1nW8Mw@mail.gmail.com>

Dear all,

I was wondering if it's possible to compile gecode in 64bit such that
the domain limit of an intvar variable become that of a long long int
rather than a long int.  The thing is that I have this problem where
the objective overflows time to time,  and I wanted to try increasing
the domain limits  before I scale down the values and lose some
precision.

Thanks in advance,

Alberto


From tack at gecode.org  Wed Nov 30 13:20:40 2011
From: tack at gecode.org (Guido Tack)
Date: Wed, 30 Nov 2011 13:20:40 +0100
Subject: [gecode-users] On IntVar limits
In-Reply-To: <CAN6C9hKzyb=czhrkiw160P_KO0UUz-bk6EL3WZr_0Foi1nW8Mw@mail.gmail.com>
References: <CAN6C9hKzyb=czhrkiw160P_KO0UUz-bk6EL3WZr_0Foi1nW8Mw@mail.gmail.com>
Message-ID: <20EB3213-D600-4281-8D5A-2DBCAF980596@gecode.org>

Hi,

unfortunately, that's currently not possible, and it would require significant changes to the code.

Cheers,
Guido

On 30 Nov 2011, at 13:17, Alberto Delgado wrote:

> Dear all,
> 
> I was wondering if it's possible to compile gecode in 64bit such that
> the domain limit of an intvar variable become that of a long long int
> rather than a long int.  The thing is that I have this problem where
> the objective overflows time to time,  and I wanted to try increasing
> the domain limits  before I scale down the values and lose some
> precision.
> 
> Thanks in advance,
> 
> Alberto
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users

-- 
Guido Tack, http://people.cs.kuleuven.be/~guido.tack/







