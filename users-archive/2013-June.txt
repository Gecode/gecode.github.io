From tack at gecode.org  Sat Jun  1 18:40:39 2013
From: tack at gecode.org (Guido Tack)
Date: Sat, 1 Jun 2013 18:40:39 +0200
Subject: [gecode-users] Display the values of a set of variable	without
	duplicates
In-Reply-To: <003101ce5de6$456b6350$d04229f0$@se>
References: <51A8587E.7030903@gmail.com> <003101ce5de6$456b6350$d04229f0$@se>
Message-ID: <84157255-1264-49A4-AAF1-22E0966EEF6D@gecode.org>

I guess the problem is that you only want to see x,y but you need to search on z,k first? That's a bit more tricky.
You can use a restart search engine, which restarts after each solution. Then for each solution you add the negation of the solution as a constraint in the root, e.g. (not (x==1 and y==1)). I'm not sure how well this scales if you have many solutions, but it could be worth a try.

Cheers,
Guido

On 31/05/2013, at 12:04, Christian Schulte <cschulte at kth.se> wrote:

> Hi,
> 
> I am not sure whether I understand your question correctly. But you can
> exchange the order of the search engine (that is, in my previous reply swap
> e1 and e2).
> 
> Best
> Christian
> 
> --
> Christian Schulte, Professor of Computer Science, KTH,
> www.ict.kth.se/~cschulte/
> 
> 
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
> Of Amina Kemmar
> Sent: Friday, May 31, 2013 10:00 AM
> To: users at gecode.org
> Subject: [gecode-users] Display the values of a set of variable without
> duplicates
> 
> Hello,
> 
> I already asked for the following problem:
> 
> According to the variables defined in our model (x,y,z,k), I obtained the
> following solutions :
>  1,1,2,3
>  1,1,5,6
>  1,1,7,9
>  1.1,8,8
> I am interested to the values of the two variable x and y, so I want to
> avoid the enumeration of the three last solution in order to display just
> the first solution.
> 
> I got the following response:
> 
> One way to do it is as follows:
>  - You create a space s that only has a brancher for x and y
>  - You create a search engine e1 for s and find a solution, say s1
>  - You post a brancher in s1 for z and k.
>  - You create a search engine e2 for s and find just a single solution!
>  - You can then also get more solutions from e1 and repeat the previous two
> steps.
> 
> Thank you for the solution, it works very well, but I have an other problem
> which is the enumeration order of the variables x, y, z and k. I must begin
> the branching from the variables  z and k, then x, y (In this way, Gecode
> enumerates quickly the solutions but for the first order "x,y,z,k", it takes
> about 30 minutes to enumerate the first solution).
> Is there an other solution?
> 
> Thank you.
> -----
> Amina
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users


From mailinglistx at gmail.com  Tue Jun  4 11:33:48 2013
From: mailinglistx at gmail.com (Mailing List Email)
Date: Tue, 4 Jun 2013 11:33:48 +0200
Subject: [gecode-users] Help figuring out how to use float variables
Message-ID: <CAHwYJRLh6J7StvkUPorHUJ=qfCSg1qEcMATCOwdKKV6Uv1jTYw@mail.gmail.com>

I have a simple model which I am trying to use to find one, two or possible
three floating variables that satisfies certain solutions to a formula. The
problem I face is that Gecode keeps giving thousands of the SAME solution,
probably because of truncation errors.
I've looked in the MPG, but can't find any information regarding how to do
this, so if anyone has any suggestions or hints, I'd be grateful.
I'm using Gist to find and print the solutions.
I'm attaching the code.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20130604/299e99ce/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: FindConfidenceFormula.cpp
Type: text/x-c++src
Size: 2259 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20130604/299e99ce/attachment.cpp>

From Vincent.Barichard at univ-angers.fr  Tue Jun  4 16:26:30 2013
From: Vincent.Barichard at univ-angers.fr (Vincent Barichard)
Date: Tue, 4 Jun 2013 16:26:30 +0200
Subject: [gecode-users] Help figuring out how to use float variables
In-Reply-To: <CAHwYJRLh6J7StvkUPorHUJ=qfCSg1qEcMATCOwdKKV6Uv1jTYw@mail.gmail.com>
References: <CAHwYJRLh6J7StvkUPorHUJ=qfCSg1qEcMATCOwdKKV6Uv1jTYw@mail.gmail.com>
Message-ID: <CAF6ZHemWRj0hJCY9MXkMREknjM=FEmJ3eaHRQxKeVB+awTP9+g@mail.gmail.com>

Hi,

It's not a truncating error, you get different solutions but very very
close ones (only one
float between two solutions), printing is not precise enough to distinguish
them.
Are you sure about your constraints ?
It seems odd that you post only one constraint about your expression with
NodeConfValues.


I modified a little your script, maybe it's what you expected ?

Best regards,
Vincent


2013/6/4 Mailing List Email <mailinglistx at gmail.com>

> I have a simple model which I am trying to use to find one, two or
> possible three floating variables that satisfies certain solutions to a
> formula. The problem I face is that Gecode keeps giving thousands of the
> SAME solution, probably because of truncation errors.
> I've looked in the MPG, but can't find any information regarding how to do
> this, so if anyone has any suggestions or hints, I'd be grateful.
> I'm using Gist to find and print the solutions.
> I'm attaching the code.
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>
>


-- 
Vincent Barichard         Universit? d'Angers (LERIA)
Tel:  02 41 73 52 06      D?partement Informatique
Fax: 02 41 73 50 73      H203
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20130604/e493bd19/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: FindConfidenceFormula.cpp
Type: text/x-c++src
Size: 2416 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20130604/e493bd19/attachment.cpp>

From mailinglistx at gmail.com  Tue Jun  4 18:57:30 2013
From: mailinglistx at gmail.com (Mailing List Email)
Date: Tue, 4 Jun 2013 18:57:30 +0200
Subject: [gecode-users] Help figuring out how to use float variables
In-Reply-To: <CAF6ZHemWRj0hJCY9MXkMREknjM=FEmJ3eaHRQxKeVB+awTP9+g@mail.gmail.com>
References: <CAHwYJRLh6J7StvkUPorHUJ=qfCSg1qEcMATCOwdKKV6Uv1jTYw@mail.gmail.com>
	<CAF6ZHemWRj0hJCY9MXkMREknjM=FEmJ3eaHRQxKeVB+awTP9+g@mail.gmail.com>
Message-ID: <CAHwYJRLhM1EHpaDcGNwu4Xn3aB+r0e-Lv7OBDutyWpNgvBr+aA@mail.gmail.com>

Thanks. Yes, this is what I expected.
I will have to experiment more tomorrow.

But yes, the truncation problem I mention is essentially that Gecode finds
solution so close to each other that somehow, when put into the formula,
I'm guessing truncation errors cause the result to be the same for the
solutions. Mathematically, no matter how close to the value for the
solution, it is not possible to get the same result, which is why I said
they were the same solutions.


On 4 June 2013 16:26, Vincent Barichard <Vincent.Barichard at univ-angers.fr>wrote:

> Hi,
>
> It's not a truncating error, you get different solutions but very very
> close ones (only one
> float between two solutions), printing is not precise enough to
> distinguish them.
> Are you sure about your constraints ?
> It seems odd that you post only one constraint about your expression with
> NodeConfValues.
>
>
> I modified a little your script, maybe it's what you expected ?
>
> Best regards,
> Vincent
>
>
> 2013/6/4 Mailing List Email <mailinglistx at gmail.com>
>
>> I have a simple model which I am trying to use to find one, two or
>> possible three floating variables that satisfies certain solutions to a
>> formula. The problem I face is that Gecode keeps giving thousands of the
>> SAME solution, probably because of truncation errors.
>> I've looked in the MPG, but can't find any information regarding how to
>> do this, so if anyone has any suggestions or hints, I'd be grateful.
>> I'm using Gist to find and print the solutions.
>> I'm attaching the code.
>>
>> _______________________________________________
>> Gecode users mailing list
>> users at gecode.org
>> https://www.gecode.org/mailman/listinfo/gecode-users
>>
>>
>
>
> --
> Vincent Barichard         Universit? d'Angers (LERIA)
> Tel:  02 41 73 52 06      D?partement Informatique
> Fax: 02 41 73 50 73      H203
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20130604/53833ea9/attachment.html>

From kemmar.amina at gmail.com  Thu Jun  6 10:00:58 2013
From: kemmar.amina at gmail.com (Amina Kemmar)
Date: Thu, 06 Jun 2013 10:00:58 +0200
Subject: [gecode-users] Restart search engine, adding a new constraint
In-Reply-To: <84157255-1264-49A4-AAF1-22E0966EEF6D@gecode.org>
References: <51A8587E.7030903@gmail.com> <003101ce5de6$456b6350$d04229f0$@se>
	<84157255-1264-49A4-AAF1-22E0966EEF6D@gecode.org>
Message-ID: <51B041BA.3080402@gmail.com>

On 06/01/2013 06:40 PM, Guido Tack wrote:
> I guess the problem is that you only want to see x,y but you need to search on z,k first? That's a bit more tricky.
> You can use a restart search engine, which restarts after each solution. Then for each solution you add the negation of the solution as a constraint in the root, e.g. (not (x==1 and y==1)). I'm not sure how well this scales if you have many solutions, but it could be worth a try.
>
> Cheers,
> Guido
>
> On 31/05/2013, at 12:04, Christian Schulte <cschulte at kth.se> wrote:
>
>> Hi,
>>
>> I am not sure whether I understand your question correctly. But you can
>> exchange the order of the search engine (that is, in my previous reply swap
>> e1 and e2).
>>
>> Best
>> Christian
>>
>> --
>> Christian Schulte, Professor of Computer Science, KTH,
>> www.ict.kth.se/~cschulte/
>>
>>
>> -----Original Message-----
>> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
>> Of Amina Kemmar
>> Sent: Friday, May 31, 2013 10:00 AM
>> To: users at gecode.org
>> Subject: [gecode-users] Display the values of a set of variable without
>> duplicates
>>
>> Hello,
>>
>> I already asked for the following problem:
>>
>> According to the variables defined in our model (x,y,z,k), I obtained the
>> following solutions :
>>   1,1,2,3
>>   1,1,5,6
>>   1,1,7,9
>>   1.1,8,8
>> I am interested to the values of the two variable x and y, so I want to
>> avoid the enumeration of the three last solution in order to display just
>> the first solution.
>>
>> I got the following response:
>>
>> One way to do it is as follows:
>>   - You create a space s that only has a brancher for x and y
>>   - You create a search engine e1 for s and find a solution, say s1
>>   - You post a brancher in s1 for z and k.
>>   - You create a search engine e2 for s and find just a single solution!
>>   - You can then also get more solutions from e1 and repeat the previous two
>> steps.
>>
>> Thank you for the solution, it works very well, but I have an other problem
>> which is the enumeration order of the variables x, y, z and k. I must begin
>> the branching from the variables  z and k, then x, y (In this way, Gecode
>> enumerates quickly the solutions but for the first order "x,y,z,k", it takes
>> about 30 minutes to enumerate the first solution).
>> Is there an other solution?
>>
>> Thank you.
>> -----
>> Amina
>>
>>
>> _______________________________________________
>> Gecode users mailing list
>> users at gecode.org
>> https://www.gecode.org/mailman/listinfo/gecode-users
>>
>>
>> _______________________________________________
>> Gecode users mailing list
>> users at gecode.org
>> https://www.gecode.org/mailman/listinfo/gecode-users
Hi,

Thank you Guido for the response, this is exactly what I want to do, but 
I red the documentation (section 9.4) , and I added the following code 
to restart the search:

MyExample* s1 = new MyExample(opt);
Search::Options o;
Search::Cuttof* c = Search::Cuttof::constant(2);
o.cuttof = c;
RBS<DFS,MyExample> e3(s1, o);

I get some errors : ?Cuttof? is not a member of ?Gecode::Search?

My second question is how to add a new constraint, after the restart search?

Thank you for your help.
cheers.

I get


From cschulte at kth.se  Thu Jun  6 12:02:25 2013
From: cschulte at kth.se (Christian Schulte)
Date: Thu, 6 Jun 2013 12:02:25 +0200
Subject: [gecode-users] Restart search engine, adding a new constraint
In-Reply-To: <51B041BA.3080402@gmail.com>
References: <51A8587E.7030903@gmail.com>
	<003101ce5de6$456b6350$d04229f0$@se>	<84157255-1264-49A4-AAF1-22E0966EEF6D@gecode.org>
	<51B041BA.3080402@gmail.com>
Message-ID: <002e01ce629c$f23876d0$d6a96470$@kth.se>

Hi,

It is spelled Cutoff. Please read the section in MPG about the master() and
slave() functions.

Best
Christian

--
Christian Schulte, www.ict.kth.se/~cschulte/


> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On
> Behalf Of Amina Kemmar
> Sent: Thursday, June 06, 2013 10:01 AM
> To: users at gecode.org
> Subject: [gecode-users] Restart search engine, adding a new constraint
> 
> On 06/01/2013 06:40 PM, Guido Tack wrote:
> > I guess the problem is that you only want to see x,y but you need to
search on
> z,k first? That's a bit more tricky.
> > You can use a restart search engine, which restarts after each solution.
Then
> for each solution you add the negation of the solution as a constraint in
the
> root, e.g. (not (x==1 and y==1)). I'm not sure how well this scales if you
have
> many solutions, but it could be worth a try.
> >
> > Cheers,
> > Guido
> >
> > On 31/05/2013, at 12:04, Christian Schulte <cschulte at kth.se> wrote:
> >
> >> Hi,
> >>
> >> I am not sure whether I understand your question correctly. But you
> >> can exchange the order of the search engine (that is, in my previous
> >> reply swap
> >> e1 and e2).
> >>
> >> Best
> >> Christian
> >>
> >> --
> >> Christian Schulte, Professor of Computer Science, KTH,
> >> www.ict.kth.se/~cschulte/
> >>
> >>
> >> -----Original Message-----
> >> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On
> >> Behalf Of Amina Kemmar
> >> Sent: Friday, May 31, 2013 10:00 AM
> >> To: users at gecode.org
> >> Subject: [gecode-users] Display the values of a set of variable
> >> without duplicates
> >>
> >> Hello,
> >>
> >> I already asked for the following problem:
> >>
> >> According to the variables defined in our model (x,y,z,k), I obtained
> >> the following solutions :
> >>   1,1,2,3
> >>   1,1,5,6
> >>   1,1,7,9
> >>   1.1,8,8
> >> I am interested to the values of the two variable x and y, so I want
> >> to avoid the enumeration of the three last solution in order to
> >> display just the first solution.
> >>
> >> I got the following response:
> >>
> >> One way to do it is as follows:
> >>   - You create a space s that only has a brancher for x and y
> >>   - You create a search engine e1 for s and find a solution, say s1
> >>   - You post a brancher in s1 for z and k.
> >>   - You create a search engine e2 for s and find just a single
solution!
> >>   - You can then also get more solutions from e1 and repeat the
> >> previous two steps.
> >>
> >> Thank you for the solution, it works very well, but I have an other
> >> problem which is the enumeration order of the variables x, y, z and
> >> k. I must begin the branching from the variables  z and k, then x, y
> >> (In this way, Gecode enumerates quickly the solutions but for the
> >> first order "x,y,z,k", it takes about 30 minutes to enumerate the first
> solution).
> >> Is there an other solution?
> >>
> >> Thank you.
> >> -----
> >> Amina
> >>
> >>
> >> _______________________________________________
> >> Gecode users mailing list
> >> users at gecode.org
> >> https://www.gecode.org/mailman/listinfo/gecode-users
> >>
> >>
> >> _______________________________________________
> >> Gecode users mailing list
> >> users at gecode.org
> >> https://www.gecode.org/mailman/listinfo/gecode-users
> Hi,
> 
> Thank you Guido for the response, this is exactly what I want to do, but I
red the
> documentation (section 9.4) , and I added the following code to restart
the
> search:
> 
> MyExample* s1 = new MyExample(opt);
> Search::Options o;
> Search::Cuttof* c = Search::Cuttof::constant(2); o.cuttof = c;
> RBS<DFS,MyExample> e3(s1, o);
> 
> I get some errors : 'Cuttof' is not a member of 'Gecode::Search'
> 
> My second question is how to add a new constraint, after the restart
search?
> 
> Thank you for your help.
> cheers.
> 
> I get
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users



From mailing-list at francq.info  Thu Jun  6 19:13:16 2013
From: mailing-list at francq.info (Pascal Francq (Mailing lists))
Date: Thu, 06 Jun 2013 19:13:16 +0200
Subject: [gecode-users] Limiting some combinations of variables
Message-ID: <51B0C32C.9040703@francq.info>

Hi,
I have a question regarding how to avoid some combinations of variables
to test. I give here a simple example:
1. I have four IntVar a,b,c and d.
2. I want to allow a=2*b=2*c only if a==1 and d==0.
If have try to encode this constraint with a code that looks like:
	BoolVar tmp;
	tmp=expr(home,(a!=1)&&(a==2*b)&&(a==2*c)&&(d==0));
	rel(home,!tmp);
But it seems that it does not try the only combination allowed.
Is this the correct way ?
Thanks.
-- 
Dr. Pascal Francq
Belgium


From conrad.drescher at gmail.com  Fri Jun  7 10:37:35 2013
From: conrad.drescher at gmail.com (Conrad Drescher)
Date: Fri, 7 Jun 2013 10:37:35 +0200
Subject: [gecode-users] Limiting some combinations of variables
In-Reply-To: <51B0C32C.9040703@francq.info>
References: <51B0C32C.9040703@francq.info>
Message-ID: <CAOk99y35LhSBvanjSE6KVY0AmdS+4P6M9H4g+uhjwE26MkUV8g@mail.gmail.com>

Hi,

2013/6/6 Pascal Francq (Mailing lists) <mailing-list at francq.info>

> Hi,
> I have a question regarding how to avoid some combinations of variables
> to test. I give here a simple example:
> 1. I have four IntVar a,b,c and d.
>

Gecode-matters aside I think that this


> 2. I want to allow a=2*b=2*c only if a==1 and d==0.
> If have try to encode this constraint with a code that looks like:
>         BoolVar tmp;
>

doesn't say the same as this:


>         tmp=expr(home,(a!=1)&&(a==2*b)&&(a==2*c)&&(d==0));
>         rel(home,!tmp);
>

If I understand your 2. correctly it says:

neg (a = 2*b /\ a = 2*c /\ (a != 1 \/ d != 0))

Hence I think tmp should be something like

expr(home,(a==2*b)&&(a==2*c)&&((a!=1)||(d!=0))

HTH
Conrad


> But it seems that it does not try the only combination allowed.
> Is this the correct way ?
> Thanks.
> --
> Dr. Pascal Francq
> Belgium
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20130607/20faaaf8/attachment.html>

From aqwzsxaqwzsx at orange.fr  Sat Jun 15 10:24:52 2013
From: aqwzsxaqwzsx at orange.fr (Philippe K)
Date: Sat, 15 Jun 2013 08:24:52 +0000 (UTC)
Subject: [gecode-users] First step in constraint progamming
Message-ID: <loom.20130615T101609-809@post.gmane.org>

Hello Everybody,

First of all, my apologize if I've posted this message in the wrong place. 
Apologies also for my poor english level.

I just start in constraint programming and I have difficulties getting the 
right approach, the good reasoning, to pose my first problem (both
mathematically and with geocode).

Please, allow me to expose this quite interesting (and fun ?) problem.


Given :
--------

- A set of CPU
- 'Prioritized' tasks  (a priority of 1 is the highest priority)

And knowing that :
-------------------

- A CPU can treat in parallel N tasks
- A CPU can only runs certain tasks

We have to distribute theses N tasks among these CPU such that we maximize 
the number of allocated tasks.A distribution is invalid if there exist an 
allocated task T and an unallocated task T' that have priority.

Example 1 :
-----------

              TASK1               TASK2           MAX // TASKS
Priority        2                   1
---------------------------------------------------------------
CPU1        affectable           affectable        1
---------------------------------------------------------------


CPU1 : { TASK1 }       is an invalid distribution since TASK2 has priority
                       but is not affected.
CPU1 : { TASK1 TASK2 } is an invalid distribution since the max number of 
                       parallel tasks is 1
CPU1 : { TASK2 }       valid distribution
CPU1 : {  }            Means 'no distribution', Not considered since we  
                       have a non empty valid distribution

=> CPU1 : { TASK2 }


Example 2 :
-----------


              TASK1               TASK2        MAX // TASKS
Priority        2                   1
-------------------------------------------------------------
CPU1        affectable           affectable       1
CPU2        not affectable       affectable       2
-------------------------------------------------------------



CPU1: { }            , CPU2: { TASK1 TASK2 }: invalid distribution, Task 1 
                                              not affectable to CPU2
CPU1: { TASK1 }      , CPU2: { TASK2 }      : valid distribution
CPU1: { TASK2 }      , CPU2: { TASK1 }      : invalid distribution, 
                                              Task 1 not affectable to CPU2
CPU1: { TASK1 TASK2 }, CPU2: { }            : invalid distribution, only 1 
                                              tasks affectable to CPU1
CPU1: { }            , CPU2: { }            : Not considered since we have
                                              a non empty valid distribution


Example 3 :
-----------

Now let's take this final example and refine it step by step.


              TASK1           TASK2     MAX // TASKS
Priority        2               1
-----------------------------------------------------
CPU1        affectable       affectable     2
CPU2        affectable       affectable     2
-----------------------------------------------------

CPU1: { }            , CPU2: { TASK1 TASK2 } : valid distribution
CPU1: { TASK1 }      , CPU2: { TASK2 }       : valid distribution
CPU1: { TASK2 }      , CPU2: { TASK1 }       : valid distribution
CPU1: { TASK1 TASK2 }, CPU2: { }             : valid distribution
CPU1: { }            , CPU2: { }             : Not considered since we have
                                               a non empty valid 
                                               distributions.

---------------------------------------------------------------------------
If we have multiple valid distributions, we prefer the one where the
"Task (+ pending task) per CPU" is "well balanced" across CPUs

for instance, with 3 CPU, the 'balance' of a distribution is :

|(nbAffectations(CPU1)+nbPendingTask(CPU1))-
(nbAffectations(CPU2)+nbPendingTask(CPU2))| +

|(nbAffectations(CPU1)+nbPendingTask(CPU1))-
(nbAffectations(CPU3)+nbPendingTask(CPU3))| +

|(nbAffectations(CPU2)+nbPendingTask(CPU2))-
(nbAffectations(CPU3)+nbPendingTask(CPU3))|
---------------------------------------------------------------------------

              TASK1           TASK2     MAX // TASKS NB_PENDING_TASK
Priority        2               1
-----------------------------------------------------------------------
CPU1        affectable       affectable     2               0
CPU2        affectable       affectable     2               0
-----------------------------------------------------------------------

CPU1: { }          , CPU2: { TASK1 TASK2 } : rejected, not the best balance
                                             |0+0 - 2+0| = 2
CPU1: { TASK1 }    , CPU2: { TASK2 }       : best balance|1+0 - 1+0| = 0
CPU1: { TASK2 }    , CPU2: { TASK1 }       : best balance : |1+0 - 1+0| = 0
CPU1: { TASK1 TASK2 }, CPU2: { }           : rejected, not the best balance
                                             |2+0 - 0+0| = 2

----------------------------------------------------------------------------
But since we have more than one potential distribution, we prefer the one 
where the "global affinity" is maximized. The "global affinity" of a 
distribution could be expressed as :

Sum(CPUi) (Sum(Taskj) (isAffected(CPUi,Taskj)*Affinity(CPUi,Taskj)))
----------------------------------------------------------------------------
                   TASK1                       TASK2           MAX // TASKS
Priority             2                          1
----------------------------------------------------------------------------
CPU1        affectable, affinity = 3    affectable, affinity = 1      2
CPU2        affectable, affinity = 2    affectable, affinity = 4      2
----------------------------------------------------------------------------

CPU1: { TASK1 } , CPU2: { TASK2 } : affinity= (1*3 + 0*1) + (0*2 + 1*4) = 7 
CPU1: { TASK2 } , CPU2: { TASK1 } : affinity= (0*3 + 1*1) + (1*2 + 0*4) = 3

Final solution : CPU1 : { TASK1 } , CPU2 : { TASK2 } 
----------------------------------------------------------------------------

To speak honestly, I've absolutely no idea of how to express this problem in 
a 'programming constraint' way. Is this can be expressed using geocode ? 
Any help would be greatly appreciated to prototype this.

Philippe








From cschulte at kth.se  Tue Jun 18 14:02:18 2013
From: cschulte at kth.se (Christian Schulte)
Date: Tue, 18 Jun 2013 14:02:18 +0200
Subject: [gecode-users] First step in constraint progamming
In-Reply-To: <loom.20130615T101609-809@post.gmane.org>
References: <loom.20130615T101609-809@post.gmane.org>
Message-ID: <020301ce6c1b$aefac570$0cf05050$@se>

Hi Philippe,

Unfortunately I cannot really answer your question as this is a general
modeling question and not a dedicated Gecode question.

Best
Christian

--
Christian Schulte, Professor of Computer Science, KTH,
www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Philippe K
Sent: Saturday, June 15, 2013 10:25 AM
To: users at gecode.org
Subject: [gecode-users] First step in constraint progamming

Hello Everybody,

First of all, my apologize if I've posted this message in the wrong place. 
Apologies also for my poor english level.

I just start in constraint programming and I have difficulties getting the
right approach, the good reasoning, to pose my first problem (both
mathematically and with geocode).

Please, allow me to expose this quite interesting (and fun ?) problem.


Given :
--------

- A set of CPU
- 'Prioritized' tasks  (a priority of 1 is the highest priority)

And knowing that :
-------------------

- A CPU can treat in parallel N tasks
- A CPU can only runs certain tasks

We have to distribute theses N tasks among these CPU such that we maximize
the number of allocated tasks.A distribution is invalid if there exist an
allocated task T and an unallocated task T' that have priority.

Example 1 :
-----------

              TASK1               TASK2           MAX // TASKS
Priority        2                   1
---------------------------------------------------------------
CPU1        affectable           affectable        1
---------------------------------------------------------------


CPU1 : { TASK1 }       is an invalid distribution since TASK2 has priority
                       but is not affected.
CPU1 : { TASK1 TASK2 } is an invalid distribution since the max number of 
                       parallel tasks is 1
CPU1 : { TASK2 }       valid distribution
CPU1 : {  }            Means 'no distribution', Not considered since we  
                       have a non empty valid distribution

=> CPU1 : { TASK2 }


Example 2 :
-----------


              TASK1               TASK2        MAX // TASKS
Priority        2                   1
-------------------------------------------------------------
CPU1        affectable           affectable       1
CPU2        not affectable       affectable       2
-------------------------------------------------------------



CPU1: { }            , CPU2: { TASK1 TASK2 }: invalid distribution, Task 1 
                                              not affectable to CPU2
CPU1: { TASK1 }      , CPU2: { TASK2 }      : valid distribution
CPU1: { TASK2 }      , CPU2: { TASK1 }      : invalid distribution, 
                                              Task 1 not affectable to CPU2
CPU1: { TASK1 TASK2 }, CPU2: { }            : invalid distribution, only 1 
                                              tasks affectable to CPU1
CPU1: { }            , CPU2: { }            : Not considered since we have
                                              a non empty valid distribution


Example 3 :
-----------

Now let's take this final example and refine it step by step.


              TASK1           TASK2     MAX // TASKS
Priority        2               1
-----------------------------------------------------
CPU1        affectable       affectable     2
CPU2        affectable       affectable     2
-----------------------------------------------------

CPU1: { }            , CPU2: { TASK1 TASK2 } : valid distribution
CPU1: { TASK1 }      , CPU2: { TASK2 }       : valid distribution
CPU1: { TASK2 }      , CPU2: { TASK1 }       : valid distribution
CPU1: { TASK1 TASK2 }, CPU2: { }             : valid distribution
CPU1: { }            , CPU2: { }             : Not considered since we have
                                               a non empty valid 
                                               distributions.

---------------------------------------------------------------------------
If we have multiple valid distributions, we prefer the one where the "Task
(+ pending task) per CPU" is "well balanced" across CPUs

for instance, with 3 CPU, the 'balance' of a distribution is :

|(nbAffectations(CPU1)+nbPendingTask(CPU1))-
(nbAffectations(CPU2)+nbPendingTask(CPU2))| +

|(nbAffectations(CPU1)+nbPendingTask(CPU1))-
(nbAffectations(CPU3)+nbPendingTask(CPU3))| +

|(nbAffectations(CPU2)+nbPendingTask(CPU2))-
(nbAffectations(CPU3)+nbPendingTask(CPU3))|
---------------------------------------------------------------------------

              TASK1           TASK2     MAX // TASKS NB_PENDING_TASK
Priority        2               1
-----------------------------------------------------------------------
CPU1        affectable       affectable     2               0
CPU2        affectable       affectable     2               0
-----------------------------------------------------------------------

CPU1: { }          , CPU2: { TASK1 TASK2 } : rejected, not the best balance
                                             |0+0 - 2+0| = 2
CPU1: { TASK1 }    , CPU2: { TASK2 }       : best balance|1+0 - 1+0| = 0
CPU1: { TASK2 }    , CPU2: { TASK1 }       : best balance : |1+0 - 1+0| = 0
CPU1: { TASK1 TASK2 }, CPU2: { }           : rejected, not the best balance
                                             |2+0 - 0+0| = 2

----------------------------------------------------------------------------
But since we have more than one potential distribution, we prefer the one
where the "global affinity" is maximized. The "global affinity" of a
distribution could be expressed as :

Sum(CPUi) (Sum(Taskj) (isAffected(CPUi,Taskj)*Affinity(CPUi,Taskj)))
----------------------------------------------------------------------------
                   TASK1                       TASK2           MAX // TASKS
Priority             2                          1
----------------------------------------------------------------------------
CPU1        affectable, affinity = 3    affectable, affinity = 1      2
CPU2        affectable, affinity = 2    affectable, affinity = 4      2
----------------------------------------------------------------------------

CPU1: { TASK1 } , CPU2: { TASK2 } : affinity= (1*3 + 0*1) + (0*2 + 1*4) = 7
CPU1: { TASK2 } , CPU2: { TASK1 } : affinity= (0*3 + 1*1) + (1*2 + 0*4) = 3

Final solution : CPU1 : { TASK1 } , CPU2 : { TASK2 }
----------------------------------------------------------------------------

To speak honestly, I've absolutely no idea of how to express this problem in
a 'programming constraint' way. Is this can be expressed using geocode ? 
Any help would be greatly appreciated to prototype this.

Philippe







_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From aqwzsxaqwzsx at orange.fr  Tue Jun 18 23:45:01 2013
From: aqwzsxaqwzsx at orange.fr (Phillipe K)
Date: Tue, 18 Jun 2013 21:45:01 +0000 (UTC)
Subject: [gecode-users] First step in constraint progamming
References: <loom.20130615T101609-809@post.gmane.org>
	<020301ce6c1b$aefac570$0cf05050$@se>
Message-ID: <loom.20130618T234331-842@post.gmane.org>

Hi Christian,

I understand. My opinion is that this problem is a constraint satisfaction
 problem.?I wonder if this problem can be naturally modeled with gecode
 (without?reading?all the 504 pages...) ?Without spending too much time 
on this?problem, do you?have an opinion on this question (just requesting
 an?advice, not a gecode prototype) ?

Anyway, thanks for you reply,
Philippe



From kemmar.amina at gmail.com  Wed Jun 19 19:17:25 2013
From: kemmar.amina at gmail.com (Amina Kemmar)
Date: Wed, 19 Jun 2013 19:17:25 +0200
Subject: [gecode-users] Reducing a view domain during propagation
Message-ID: <51C1E7A5.3080900@gmail.com>

Hi,

In my propagate function that  I implemented, I want to reduce the 
domain of an IntView x1 to a fix set of values given by the strucure 
set<int> s, how can I do this?

Thank you for your help.
Regards.



From mailinglistx at gmail.com  Wed Jun 19 19:23:12 2013
From: mailinglistx at gmail.com (Mailing List Email)
Date: Wed, 19 Jun 2013 19:23:12 +0200
Subject: [gecode-users] Reducing a view domain during propagation
In-Reply-To: <51C1E7A5.3080900@gmail.com>
References: <51C1E7A5.3080900@gmail.com>
Message-ID: <CAHwYJRJbawmv2e0XR69+qDsuvF1z411zQRYeek-s5yrVLhyqCw@mail.gmail.com>

Try x1.le(max(s)), x1.ge(min(s)) for domain consistency.
On 19 Jun 2013 19:17, "Amina Kemmar" <kemmar.amina at gmail.com> wrote:

> Hi,
>
> In my propagate function that  I implemented, I want to reduce the domain
> of an IntView x1 to a fix set of values given by the strucure set<int> s,
> how can I do this?
>
> Thank you for your help.
> Regards.
>
>
> ______________________________**_________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/**mailman/listinfo/gecode-users<https://www.gecode.org/mailman/listinfo/gecode-users>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20130619/7b626d81/attachment.html>

From mailinglistx at gmail.com  Wed Jun 19 19:49:06 2013
From: mailinglistx at gmail.com (Mailing List Email)
Date: Wed, 19 Jun 2013 19:49:06 +0200
Subject: [gecode-users] Reducing a view domain during propagation
In-Reply-To: <CAHwYJRJbawmv2e0XR69+qDsuvF1z411zQRYeek-s5yrVLhyqCw@mail.gmail.com>
References: <51C1E7A5.3080900@gmail.com>
	<CAHwYJRJbawmv2e0XR69+qDsuvF1z411zQRYeek-s5yrVLhyqCw@mail.gmail.com>
Message-ID: <CAHwYJR+YQS_zOhMjLyf-k4ZvstmMkiMrrDpYxwc0J_Nk2orz9Q@mail.gmail.com>

Sorry, that's bounds consistency.
On 19 Jun 2013 19:23, "Mailing List Email" <mailinglistx at gmail.com> wrote:

> Try x1.le(max(s)), x1.ge(min(s)) for domain consistency.
> On 19 Jun 2013 19:17, "Amina Kemmar" <kemmar.amina at gmail.com> wrote:
>
>> Hi,
>>
>> In my propagate function that  I implemented, I want to reduce the domain
>> of an IntView x1 to a fix set of values given by the strucure set<int> s,
>> how can I do this?
>>
>> Thank you for your help.
>> Regards.
>>
>>
>> ______________________________**_________________
>> Gecode users mailing list
>> users at gecode.org
>> https://www.gecode.org/**mailman/listinfo/gecode-users<https://www.gecode.org/mailman/listinfo/gecode-users>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20130619/6521ed4f/attachment.html>

From cschulte at kth.se  Wed Jun 19 20:00:21 2013
From: cschulte at kth.se (Christian Schulte)
Date: Wed, 19 Jun 2013 20:00:21 +0200
Subject: [gecode-users] Reducing a view domain during propagation
In-Reply-To: <CAHwYJR+YQS_zOhMjLyf-k4ZvstmMkiMrrDpYxwc0J_Nk2orz9Q@mail.gmail.com>
References: <51C1E7A5.3080900@gmail.com>	<CAHwYJRJbawmv2e0XR69+qDsuvF1z411zQRYeek-s5yrVLhyqCw@mail.gmail.com>
	<CAHwYJR+YQS_zOhMjLyf-k4ZvstmMkiMrrDpYxwc0J_Nk2orz9Q@mail.gmail.com>
Message-ID: <002e01ce6d16$de1a80b0$9a4f8210$@kth.se>

Read Chapter 25 in MPG and then you will have to implement a Gecode-style
iterator that iterates over the values of set<int>.

 

Best

Christian

 

--

Christian Schulte, www.ict.kth.se/~cschulte/

 

From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Mailing List Email
Sent: Wednesday, June 19, 2013 7:49 PM
To: Amina Kemmar
Cc: users at gecode.org
Subject: Re: [gecode-users] Reducing a view domain during propagation

 

Sorry, that's bounds consistency. 

On 19 Jun 2013 19:23, "Mailing List Email" <mailinglistx at gmail.com> wrote:

Try x1.le(max(s)), x1.ge(min(s)) for domain consistency.

On 19 Jun 2013 19:17, "Amina Kemmar" <kemmar.amina at gmail.com> wrote:

Hi,

In my propagate function that  I implemented, I want to reduce the domain of
an IntView x1 to a fix set of values given by the strucure set<int> s, how
can I do this?

Thank you for your help.
Regards.


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20130619/699ea6e8/attachment.html>

From mmann at informatik.uni-freiburg.de  Thu Jun 20 00:38:50 2013
From: mmann at informatik.uni-freiburg.de (Martin Mann)
Date: Thu, 20 Jun 2013 00:38:50 +0200
Subject: [gecode-users] Reducing a view domain during propagation
In-Reply-To: <002e01ce6d16$de1a80b0$9a4f8210$@kth.se>
References: <51C1E7A5.3080900@gmail.com>	<CAHwYJRJbawmv2e0XR69+qDsuvF1z411zQRYeek-s5yrVLhyqCw@mail.gmail.com>
	<CAHwYJR+YQS_zOhMjLyf-k4ZvstmMkiMrrDpYxwc0J_Nk2orz9Q@mail.gmail.com>
	<002e01ce6d16$de1a80b0$9a4f8210$@kth.se>
Message-ID: <51C232FA.8080307@informatik.uni-freiburg.de>


Hi Amina,

years back I wrote the attached std::set range iterator. you can use it 
with any of the IntView shrink function members like narrow etc. 
something like

////////////
   // setup iterator
GC_StlSetRangeIterator supportIter(&support);
   // prune the domain to supported values
GECODE_ME_CHECK(x0.narrow_r(home, supportIter, false));
////////////

the iterator implementation is obviously not the nices nor best source 
code possible but might be a starting point.. as I said, wrote it years 
ago and didnt touched it since that time.

Hope it helps.
Best,
Martin



Am 19.06.2013 20:00, schrieb Christian Schulte:
> Read Chapter 25 in MPG and then you will have to implement a Gecode-style
> iterator that iterates over the values of set<int>.
>
>
>
> Best
>
> Christian
>
>
>
> --
>
> Christian Schulte, www.ict.kth.se/~cschulte/
>
>
>
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
> Of Mailing List Email
> Sent: Wednesday, June 19, 2013 7:49 PM
> To: Amina Kemmar
> Cc: users at gecode.org
> Subject: Re: [gecode-users] Reducing a view domain during propagation
>
>
>
> Sorry, that's bounds consistency.
>
> On 19 Jun 2013 19:23, "Mailing List Email" <mailinglistx at gmail.com> wrote:
>
> Try x1.le(max(s)), x1.ge(min(s)) for domain consistency.
>
> On 19 Jun 2013 19:17, "Amina Kemmar" <kemmar.amina at gmail.com> wrote:
>
> Hi,
>
> In my propagate function that  I implemented, I want to reduce the domain of
> an IntView x1 to a fix set of values given by the strucure set<int> s, how
> can I do this?
>
> Thank you for your help.
> Regards.
>
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>
>
>
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>

-- 
Dr. Martin Mann, Postdoc
Bioinformatics - Inst. of Computer Science
Albert-Ludwigs-University Freiburg
Tel: ++49-761-203-8254
Fax: ++49-761-203-7462
http://www.bioinf.uni-freiburg.de/~mmann/

-------------- next part --------------
/*
 *  Main authors:
 *     Martin Mann http://www.bioinf.uni-freiburg.de/~mmann/
 *
 *  Contributing authors:
 *     Sebastian Will http://www.bioinf.uni-freiburg.de/~will/
 *
 *  Copyright:
 *     Martin Mann, 2007
 *
 *  This file is part of the CPSP-tools package:
 *     http://www.bioinf.uni-freiburg.de/sw/cpsp/
 *
 *  See the file "LICENSE" for information on usage and
 *  redistribution of this file, and for a
 *     DISCLAIMER OF ALL WARRANTIES.
 *
 */

#include "GC_StlSetRangeIterator.h"
  	
  	GC_StlSetRangeIterator::GC_StlSetRangeIterator() :
  		data(NULL), noFurtherRange(true)
  	{
  		getNextRange();
  	}
  		
	GC_StlSetRangeIterator::GC_StlSetRangeIterator(const std::set<int>* data_) :
		data(data_), noFurtherRange(false)
	{
		if (data != NULL) 
			actElem = data->begin();
		getNextRange();
	}
	
	GC_StlSetRangeIterator::~GC_StlSetRangeIterator()
	{
	}
	
	void
	GC_StlSetRangeIterator::getNextRange() {
		if (data==NULL || actElem == data->end()) {
			noFurtherRange = true;
			return;
		}
			// find next range
		nextMin = *actElem;
		nextMax = nextMin;
			// build up new upper bound until end of set reached or gap in 
			// sequence
		while ( (++actElem != data->end()) && (*actElem == (nextMax+1))) {
			nextMax++;
		}
	}
-------------- next part --------------
/*
 *  Main authors:
 *     Martin Mann http://www.bioinf.uni-freiburg.de/~mmann/
 *
 *  Contributing authors:
 *     Sebastian Will http://www.bioinf.uni-freiburg.de/~will/
 *
 *  Copyright:
 *     Martin Mann, 2007
 *
 *  This file is part of the CPSP-tools package:
 *     http://www.bioinf.uni-freiburg.de/sw/cpsp/
 *
 *  See the file "LICENSE" for information on usage and
 *  redistribution of this file, and for a
 *     DISCLAIMER OF ALL WARRANTIES.
 *
 */

#ifndef GC_STLSETRANGEITERATOR_HH_
#define GC_STLSETRANGEITERATOR_HH_


#include <set>
#include <iostream>
  	
  		/**
  		 * Provides a constant Gecode RangeIterator of a std::set<int> that 
  		 * calculates the ranges on demand.
  		 */
	class GC_StlSetRangeIterator
	{
	private:
		const std::set<int>* data;
		std::set<int>::const_iterator actElem;
		
		bool noFurtherRange;
		
		int nextMin, nextMax;
		
			//! searchs for the next range and sets the inner members
		void getNextRange();
	public:
		GC_StlSetRangeIterator();
		GC_StlSetRangeIterator(const std::set<int>* data_);
		virtual ~GC_StlSetRangeIterator();
		
		void init(const std::set<int>* const data_) {
			data = data_;
			noFurtherRange = false;
			if (data != NULL) 
				actElem = data->begin();
			getNextRange();
		}
		
		bool operator()(void) const { return !noFurtherRange; }
		void operator++(void) { getNextRange(); }
		
		int min(void) const { return nextMin; }
		int max(void) const { return nextMax; }
		unsigned int width(void) { return nextMax-nextMin+1; }
		
		
	};
	

#endif /*GC_STLSETRANGEITERATOR_HH_*/

From victor.zverovich at gmail.com  Sat Jun 22 00:20:18 2013
From: victor.zverovich at gmail.com (victor.zverovich at gmail.com)
Date: Fri, 21 Jun 2013 15:20:18 -0700
Subject: [gecode-users] bug in INT_VALUES_MAX
Message-ID: <CANawtxb3jmzB754b7zWaZMuG76T7KJBwAj1PP+MmHgJL=0EKVQ@mail.gmail.com>

Hi,

There seems to be a trivial bug in INT_VALUES_MAX: SEL_VALUES_MIN is used
instead of SEL_VALUES_MAX. The attached patch fixes it.

Best regards,
Victor
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20130621/553569bc/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-Fix-INT_VALUES_MAX.patch
Type: application/octet-stream
Size: 689 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20130621/553569bc/attachment.obj>

From cschulte at kth.se  Sun Jun 23 18:59:15 2013
From: cschulte at kth.se (Christian Schulte)
Date: Sun, 23 Jun 2013 18:59:15 +0200
Subject: [gecode-users] bug in INT_VALUES_MAX
In-Reply-To: <CANawtxb3jmzB754b7zWaZMuG76T7KJBwAj1PP+MmHgJL=0EKVQ@mail.gmail.com>
References: <CANawtxb3jmzB754b7zWaZMuG76T7KJBwAj1PP+MmHgJL=0EKVQ@mail.gmail.com>
Message-ID: <003001ce7032$feacdb60$fc069220$@kth.se>

Thanks! Fixed in the trunk. Christian

 

--

Christian Schulte, www.ict.kth.se/~cschulte/

 

From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of victor.zverovich at gmail.com
Sent: Saturday, June 22, 2013 12:20 AM
To: users at gecode.org
Subject: [gecode-users] bug in INT_VALUES_MAX

 

Hi,

 

There seems to be a trivial bug in INT_VALUES_MAX: SEL_VALUES_MIN is used
instead of SEL_VALUES_MAX. The attached patch fixes it.

 

Best regards,

Victor

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20130623/87a2d618/attachment.html>

From cschulte at kth.se  Mon Jun 24 14:34:10 2013
From: cschulte at kth.se (Christian Schulte)
Date: Mon, 24 Jun 2013 14:34:10 +0200
Subject: [gecode-users] First step in constraint progamming
In-Reply-To: <loom.20130618T234331-842@post.gmane.org>
References: <loom.20130615T101609-809@post.gmane.org>	<020301ce6c1b$aefac570$0cf05050$@se>
	<loom.20130618T234331-842@post.gmane.org>
Message-ID: <01f501ce70d7$20a84020$61f8c060$@se>

Hi Philippe,

Yes it looks very much like a constraint problem. Maybe somebody from our users can help here. Hint hint?

Best
Christian

--
Christian Schulte, Professor of Computer Science, KTH, www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf Of Phillipe K
Sent: Tuesday, June 18, 2013 11:45 PM
To: users at gecode.org
Subject: Re: [gecode-users] First step in constraint progamming

Hi Christian,

I understand. My opinion is that this problem is a constraint satisfaction  problem. I wonder if this problem can be naturally modeled with gecode  (without reading all the 504 pages...)  Without spending too much time on this problem, do you have an opinion on this question (just requesting  an advice, not a gecode prototype) ?

Anyway, thanks for you reply,
Philippe


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From mailinglistx at gmail.com  Mon Jun 24 14:44:26 2013
From: mailinglistx at gmail.com (Mailing List Email)
Date: Mon, 24 Jun 2013 14:44:26 +0200
Subject: [gecode-users] First step in constraint progamming
In-Reply-To: <loom.20130615T101609-809@post.gmane.org>
References: <loom.20130615T101609-809@post.gmane.org>
Message-ID: <CAHwYJRJRZR=UrJkwCvGcwyvR-RViSgrZnD2Yn_jsvRAz5Cmdxw@mail.gmail.com>

Attempt at a model:

Model each cpu as a rectangle where one dimension represents time and the
other how much "resources" the cpu has. By resources, we can put an upper
limit on how many tasks it can run in parallel.
Each task then defines how much cpu usage it consumes and how long time it
takes to complete. Each of these parameters is either width or height
depending on which dimension you choose to represent what.
Each task also defines what type of work it is.
Each task defines a priority.
Add constraints to each cpu that tells what type of work it can handle.
Order the tasks such that the highest priority must be before (to the left
or above) the one with the next lower priority.
Each task must be contained inside one of the cpu boxes.
Then make sure no cpu box overlaps, no task boxes overlap and that they are
constrained inside each cpu box (they don't span multiple cpu boxes).

Gecode contains a nooverlap propagator.
I haven't tested it, but maybe it will provide a starting point.


On 15 June 2013 10:24, Philippe K <aqwzsxaqwzsx at orange.fr> wrote:

> Hello Everybody,
>
> First of all, my apologize if I've posted this message in the wrong place.
> Apologies also for my poor english level.
>
> I just start in constraint programming and I have difficulties getting the
> right approach, the good reasoning, to pose my first problem (both
> mathematically and with geocode).
>
> Please, allow me to expose this quite interesting (and fun ?) problem.
>
>
> Given :
> --------
>
> - A set of CPU
> - 'Prioritized' tasks  (a priority of 1 is the highest priority)
>
> And knowing that :
> -------------------
>
> - A CPU can treat in parallel N tasks
> - A CPU can only runs certain tasks
>
> We have to distribute theses N tasks among these CPU such that we maximize
> the number of allocated tasks.A distribution is invalid if there exist an
> allocated task T and an unallocated task T' that have priority.
>
> Example 1 :
> -----------
>
>               TASK1               TASK2           MAX // TASKS
> Priority        2                   1
> ---------------------------------------------------------------
> CPU1        affectable           affectable        1
> ---------------------------------------------------------------
>
>
> CPU1 : { TASK1 }       is an invalid distribution since TASK2 has priority
>                        but is not affected.
> CPU1 : { TASK1 TASK2 } is an invalid distribution since the max number of
>                        parallel tasks is 1
> CPU1 : { TASK2 }       valid distribution
> CPU1 : {  }            Means 'no distribution', Not considered since we
>                        have a non empty valid distribution
>
> => CPU1 : { TASK2 }
>
>
> Example 2 :
> -----------
>
>
>               TASK1               TASK2        MAX // TASKS
> Priority        2                   1
> -------------------------------------------------------------
> CPU1        affectable           affectable       1
> CPU2        not affectable       affectable       2
> -------------------------------------------------------------
>
>
>
> CPU1: { }            , CPU2: { TASK1 TASK2 }: invalid distribution, Task 1
>                                               not affectable to CPU2
> CPU1: { TASK1 }      , CPU2: { TASK2 }      : valid distribution
> CPU1: { TASK2 }      , CPU2: { TASK1 }      : invalid distribution,
>                                               Task 1 not affectable to CPU2
> CPU1: { TASK1 TASK2 }, CPU2: { }            : invalid distribution, only 1
>                                               tasks affectable to CPU1
> CPU1: { }            , CPU2: { }            : Not considered since we have
>                                               a non empty valid
> distribution
>
>
> Example 3 :
> -----------
>
> Now let's take this final example and refine it step by step.
>
>
>               TASK1           TASK2     MAX // TASKS
> Priority        2               1
> -----------------------------------------------------
> CPU1        affectable       affectable     2
> CPU2        affectable       affectable     2
> -----------------------------------------------------
>
> CPU1: { }            , CPU2: { TASK1 TASK2 } : valid distribution
> CPU1: { TASK1 }      , CPU2: { TASK2 }       : valid distribution
> CPU1: { TASK2 }      , CPU2: { TASK1 }       : valid distribution
> CPU1: { TASK1 TASK2 }, CPU2: { }             : valid distribution
> CPU1: { }            , CPU2: { }             : Not considered since we have
>                                                a non empty valid
>                                                distributions.
>
> ---------------------------------------------------------------------------
> If we have multiple valid distributions, we prefer the one where the
> "Task (+ pending task) per CPU" is "well balanced" across CPUs
>
> for instance, with 3 CPU, the 'balance' of a distribution is :
>
> |(nbAffectations(CPU1)+nbPendingTask(CPU1))-
> (nbAffectations(CPU2)+nbPendingTask(CPU2))| +
>
> |(nbAffectations(CPU1)+nbPendingTask(CPU1))-
> (nbAffectations(CPU3)+nbPendingTask(CPU3))| +
>
> |(nbAffectations(CPU2)+nbPendingTask(CPU2))-
> (nbAffectations(CPU3)+nbPendingTask(CPU3))|
> ---------------------------------------------------------------------------
>
>               TASK1           TASK2     MAX // TASKS NB_PENDING_TASK
> Priority        2               1
> -----------------------------------------------------------------------
> CPU1        affectable       affectable     2               0
> CPU2        affectable       affectable     2               0
> -----------------------------------------------------------------------
>
> CPU1: { }          , CPU2: { TASK1 TASK2 } : rejected, not the best balance
>                                              |0+0 - 2+0| = 2
> CPU1: { TASK1 }    , CPU2: { TASK2 }       : best balance|1+0 - 1+0| = 0
> CPU1: { TASK2 }    , CPU2: { TASK1 }       : best balance : |1+0 - 1+0| = 0
> CPU1: { TASK1 TASK2 }, CPU2: { }           : rejected, not the best balance
>                                              |2+0 - 0+0| = 2
>
>
> ----------------------------------------------------------------------------
> But since we have more than one potential distribution, we prefer the one
> where the "global affinity" is maximized. The "global affinity" of a
> distribution could be expressed as :
>
> Sum(CPUi) (Sum(Taskj) (isAffected(CPUi,Taskj)*Affinity(CPUi,Taskj)))
>
> ----------------------------------------------------------------------------
>                    TASK1                       TASK2           MAX // TASKS
> Priority             2                          1
>
> ----------------------------------------------------------------------------
> CPU1        affectable, affinity = 3    affectable, affinity = 1      2
> CPU2        affectable, affinity = 2    affectable, affinity = 4      2
>
> ----------------------------------------------------------------------------
>
> CPU1: { TASK1 } , CPU2: { TASK2 } : affinity= (1*3 + 0*1) + (0*2 + 1*4) = 7
> CPU1: { TASK2 } , CPU2: { TASK1 } : affinity= (0*3 + 1*1) + (1*2 + 0*4) = 3
>
> Final solution : CPU1 : { TASK1 } , CPU2 : { TASK2 }
>
> ----------------------------------------------------------------------------
>
> To speak honestly, I've absolutely no idea of how to express this problem
> in
> a 'programming constraint' way. Is this can be expressed using geocode ?
> Any help would be greatly appreciated to prototype this.
>
> Philippe
>
>
>
>
>
>
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20130624/490ed0fe/attachment.html>

From aqwzsxaqwzsx at orange.fr  Tue Jun 25 21:45:45 2013
From: aqwzsxaqwzsx at orange.fr (Philippe K)
Date: Tue, 25 Jun 2013 19:45:45 +0000 (UTC)
Subject: [gecode-users] First step in constraint progamming
References: <loom.20130615T101609-809@post.gmane.org>	<020301ce6c1b$aefac570$0cf05050$@se>
	<loom.20130618T234331-842@post.gmane.org>
	<01f501ce70d7$20a84020$61f8c060$@se>
Message-ID: <loom.20130625T213947-350@post.gmane.org>

Hi Christian,

Thank you for your opinion (and your call to user's contributions !), 
it reinforces my approach. 
Also thank you to the person who gave an outline solution (which is
 different from a set-approach I was thinking)?I hope to tell you soon 
I realized a working gecode implementation.

Best,
Philippe



From uwe.nowak at itwm.fraunhofer.de  Thu Jun 27 12:57:22 2013
From: uwe.nowak at itwm.fraunhofer.de (Uwe Nowak)
Date: Thu, 27 Jun 2013 12:57:22 +0200
Subject: [gecode-users] Access Violation when temporary BoolVarAgs looses
	scope.
Message-ID: <007301ce7325$19f69e20$4de3da60$@itwm.fraunhofer.de>

Hello!

I am getting an access violation creating a custom Space and boiled it down
to the following minimal example.
When the tmp array is destroyed (as it gets out of scope) I get an access
violation.
Visual Studio 10, 32bit (on a 64 bit machine)

Did I missunderstand the concept of temporary variables? If all variables
are instance variables, everything works fine.
Interesting enough, it also works if tmp  has a length less or equal to 16.


class DummySpace : public Gecode::Space {
public:
  DummySpace(bool share, DummySpace& other)  : Space(share, other) { }

  DummySpace() { 
    {
      Gecode::BoolVarArgs tmp(*this, 17, 0, 1);
      for(int j = 0; j<tmp.size(); ++j) rel(*this, tmp[j] == 1);
    } //tmp gets out of scope
    std::cout << "Never executed!" << std::endl;
  }

  DummySpace* copy(bool share) {
    return new DummySpace(share, *this);
  }
};


Thank you for your support,
Uwe



From cschulte at kth.se  Thu Jun 27 15:23:34 2013
From: cschulte at kth.se (Christian Schulte)
Date: Thu, 27 Jun 2013 15:23:34 +0200
Subject: [gecode-users] Access Violation when temporary BoolVarAgs
	looses	scope.
In-Reply-To: <007301ce7325$19f69e20$4de3da60$@itwm.fraunhofer.de>
References: <007301ce7325$19f69e20$4de3da60$@itwm.fraunhofer.de>
Message-ID: <022201ce7339$86b12710$94137530$@kth.se>

Hi Uwe,

No, what you do is fine. This must be a bug in Gecode or an issue related to
DLLs in Windows (more likely). The 16 versus 17 is okay because up 16 the
temporary array is allocated on the stack and otherwise on the heap. So heap
allocation is the problem apparently.

I just tried it on my Windows machine x64 with MSVC 2012 and it works fine.

Now I have a strange question for you: does your project use several DLLs? I
have an idea which has to do with a restriction in Windows: memory allocated
by a function in one DLL must also be deallocated by a function from the
same DLL. When some functions are inlined and others are not, then they
might end up in different DLLs and a problem might occur (the program will
crash).

Did you compile in debug or release mode?

Best
Christian

--
Christian Schulte, Professor of Computer Science, KTH,
www.ict.kth.se/~cschulte/



-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Uwe Nowak
Sent: Thursday, June 27, 2013 12:57 PM
To: users at gecode.org
Subject: [gecode-users] Access Violation when temporary BoolVarAgs looses
scope.

Hello!

I am getting an access violation creating a custom Space and boiled it down
to the following minimal example.
When the tmp array is destroyed (as it gets out of scope) I get an access
violation.
Visual Studio 10, 32bit (on a 64 bit machine)

Did I missunderstand the concept of temporary variables? If all variables
are instance variables, everything works fine.
Interesting enough, it also works if tmp  has a length less or equal to 16.


class DummySpace : public Gecode::Space {
public:
  DummySpace(bool share, DummySpace& other)  : Space(share, other) { }

  DummySpace() { 
    {
      Gecode::BoolVarArgs tmp(*this, 17, 0, 1);
      for(int j = 0; j<tmp.size(); ++j) rel(*this, tmp[j] == 1);
    } //tmp gets out of scope
    std::cout << "Never executed!" << std::endl;
  }

  DummySpace* copy(bool share) {
    return new DummySpace(share, *this);
  }
};


Thank you for your support,
Uwe


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From begbie00 at gmail.com  Sat Jun 29 14:05:38 2013
From: begbie00 at gmail.com (Michael Rand)
Date: Sat, 29 Jun 2013 12:05:38 +0000 (UTC)
Subject: [gecode-users] Implementing scene allocation symmetry break in
	gecode-python
Message-ID: <loom.20130629T134927-584@post.gmane.org>

Hi,

Here's some c++ code implementing the symmetry break in the scene allocation 
problem:

//Symmetry breaking
    //Assign shot day for scene imposing an order
    post(*this, shoot[0] == 1);
    for(sceneCount=1; sceneCount<numScenes; sceneCount++){
      IntVar currentMax(*this,1,maxDays);      
      IntVarArray shot_slice(*this,sceneCount,1,maxDays);
      //Get Shot days from 0 to sceneCount
      int parcialShoot;
      for(parcialShoot=0; parcialShoot< sceneCount; parcialShoot++){
	shot_slice[parcialShoot] = shoot[parcialShoot];
      }
      //Each scene must be assigned to an already assigned scene day
      //or to the successor of the max assigned day
      max(*this,shot_slice, currentMax);
      post(*this, shoot[sceneCount] <= 1+currentMax);
    }

I would think the same constraint would be constructed in gecode-python as 
follows (with s = the space object):

    s.rel(shoot[0],cp.IRT_EQ,1)
    for scene_count in xrange(1,num_scenes):
        current_max = s.intvar(1, max_days)
        shot_slice = s.intvars(scene_count, 1, max_days)
        for partial_shoot in xrange(0, scene_count):
            shot_slice[partial_shoot] = shoot[partial_shoot]
        s.max(shot_slice, current_max)
        s.rel(shoot[scene_count], cp.IRT_LQ, current_max + 1)

But this raises the following exception:

Traceback (most recent call last):
  ...
  File "solver.py", line 61, in solveIt
    s.rel(shoot[scene_count], cp.IRT_LQ, current_max + 1)
TypeError: unsupported operand type(s) for +: '_gecode.IntVar' and 'int'


How do I implement the "+1" portion of the constraint if I can't add an int 
and an IntVar? Do I need to use some kind of linear equation constraint with 
a "plus_one" intvar?



