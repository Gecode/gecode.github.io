From negate273 at gmail.com  Wed May  7 08:17:40 2014
From: negate273 at gmail.com (negate273 at gmail.com)
Date: Tue, 6 May 2014 23:17:40 -0700
Subject: [gecode-users] debug unsatisfiable conditions
Message-ID: <D2E0794A-D1FC-4E12-AE8E-2A7D84688C26@gmail.com>

Hi, An unsatisfiable condition is reported by gecode, if the domain of a variable is empty after propagating constraints. What are some of the ways to debug such unsatisfiable fails in the model ? Is there an option, by which gecode can output (print) the variable whose domain is empty and which constraint caused this fail ? I?m specifying the model in minizinc and interface with gecode through fzn-gecode in tools/flatzinc/.
Thanks, ~az

From cschulte at kth.se  Wed May  7 10:01:44 2014
From: cschulte at kth.se (Christian Schulte)
Date: Wed, 7 May 2014 10:01:44 +0200
Subject: [gecode-users] debug unsatisfiable conditions
In-Reply-To: <D2E0794A-D1FC-4E12-AE8E-2A7D84688C26@gmail.com>
References: <D2E0794A-D1FC-4E12-AE8E-2A7D84688C26@gmail.com>
Message-ID: <011c01cf69ca$96aa09b0$c3fe1d10$@se>

Hi, there is no real support for that. The best option is to use Gist and
see where during search you reach failure.

Best
Christian

--
Christian Schulte, Professor of Computer Science, KTH,
www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of negate273 at gmail.com
Sent: Wednesday, May 07, 2014 8:18 AM
To: users at gecode.org
Subject: [gecode-users] debug unsatisfiable conditions

Hi, An unsatisfiable condition is reported by gecode, if the domain of a
variable is empty after propagating constraints. What are some of the ways
to debug such unsatisfiable fails in the model ? Is there an option, by
which gecode can output (print) the variable whose domain is empty and which
constraint caused this fail ? I'm specifying the model in minizinc and
interface with gecode through fzn-gecode in tools/flatzinc/.
Thanks, ~az
_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From zayenz at gmail.com  Wed May  7 12:41:56 2014
From: zayenz at gmail.com (Mikael Zayenz Lagerkvist)
Date: Wed, 07 May 2014 12:41:56 +0200
Subject: [gecode-users] debug unsatisfiable conditions
In-Reply-To: <011c01cf69ca$96aa09b0$c3fe1d10$@se>
References: <D2E0794A-D1FC-4E12-AE8E-2A7D84688C26@gmail.com>
	<011c01cf69ca$96aa09b0$c3fe1d10$@se>
Message-ID: <536A0DF4.4010707@gmail.com>

See also previous discussions on the mailing list. For example
   http://thread.gmane.org/gmane.comp.lib.gecode.user/2796
   http://thread.gmane.org/gmane.comp.lib.gecode.user/2762
   http://thread.gmane.org/gmane.comp.lib.gecode.user/1415

Cheers,
Mikael

Christian Schulte skrev 07/05/14 10:01:
> Hi, there is no real support for that. The best option is to use Gist and
> see where during search you reach failure.
>
> Best
> Christian
>
> --
> Christian Schulte, Professor of Computer Science, KTH,
> www.ict.kth.se/~cschulte/
>
>
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
> Of negate273 at gmail.com
> Sent: Wednesday, May 07, 2014 8:18 AM
> To: users at gecode.org
> Subject: [gecode-users] debug unsatisfiable conditions
>
> Hi, An unsatisfiable condition is reported by gecode, if the domain of a
> variable is empty after propagating constraints. What are some of the ways
> to debug such unsatisfiable fails in the model ? Is there an option, by
> which gecode can output (print) the variable whose domain is empty and which
> constraint caused this fail ? I'm specifying the model in minizinc and
> interface with gecode through fzn-gecode in tools/flatzinc/.
> Thanks, ~az
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users



From Torsten.Anders at beds.ac.uk  Fri May  9 12:38:39 2014
From: Torsten.Anders at beds.ac.uk (Torsten Anders)
Date: Fri, 9 May 2014 10:38:39 +0000
Subject: [gecode-users] Search combinator questions
Message-ID: <BBA9D1B1-62BC-4C9E-B059-A4886891A4C5@beds.ac.uk>

Dear Guido,

I had a look at the search combinators supported by the Gecode FlatZinc interpreter (http://www.gecode.org/flatzinc.html). I have two brief questions. 

The README file of http://www.gecode.org/download/searchcombinators-0.9.3.tgz says that support for set variables will be added later. Does this mean only that branching strategies for set variables cannot be defined right now, or more generally that CSPs with set variables are not supported by the current search combinators? In other words, can I define CSPs with a mix of integer and set variables, where a branching of the integers will also determine/fix the set variables? 

Also, do the search combinators depend on Gecode version 3.7.2, or could they also be compiled with later versions?

Thank you!  

Best wishes,
Torsten

--
Dr Torsten Anders
Course Leader, Music Technology
University of Bedfordshire
Park Square, Room A315
http://www.torsten-anders.de









From tack at gecode.org  Fri May  9 12:45:36 2014
From: tack at gecode.org (Guido Tack)
Date: Fri, 9 May 2014 20:45:36 +1000
Subject: [gecode-users] Search combinator questions
In-Reply-To: <BBA9D1B1-62BC-4C9E-B059-A4886891A4C5@beds.ac.uk>
References: <BBA9D1B1-62BC-4C9E-B059-A4886891A4C5@beds.ac.uk>
Message-ID: <570A8FC4-DA75-4295-AE06-49C8E8EA86AC@gecode.org>

Hi Torsten,

it just doesn't support search over sets, so if searching over the integer variables is enough it should work.  I have successfully compiled the code with Gecode 4, it requires a few changes but it shouldn't be too difficult if you want to give it a try.
We have plans to work a bit more on combinators soon, so I hope we'll get someone to bring all this code up to date.

Cheers,
Guido

On 9 May 2014, at 8:38 pm, Torsten Anders <Torsten.Anders at beds.ac.uk> wrote:

> Dear Guido,
> 
> I had a look at the search combinators supported by the Gecode FlatZinc interpreter (http://www.gecode.org/flatzinc.html). I have two brief questions. 
> 
> The README file of http://www.gecode.org/download/searchcombinators-0.9.3.tgz says that support for set variables will be added later. Does this mean only that branching strategies for set variables cannot be defined right now, or more generally that CSPs with set variables are not supported by the current search combinators? In other words, can I define CSPs with a mix of integer and set variables, where a branching of the integers will also determine/fix the set variables? 
> 
> Also, do the search combinators depend on Gecode version 3.7.2, or could they also be compiled with later versions?
> 
> Thank you!  
> 
> Best wishes,
> Torsten
> 
> --
> Dr Torsten Anders
> Course Leader, Music Technology
> University of Bedfordshire
> Park Square, Room A315
> http://www.torsten-anders.de
> 
> 
> 
> 
> 
> 
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users



From kisshen at cisco.com  Fri May  9 19:46:48 2014
From: kisshen at cisco.com (Kish Shen)
Date: Fri, 09 May 2014 18:46:48 +0100
Subject: [gecode-users] AFC decay with global AFC in search engines
Message-ID: <536D1488.406@cisco.com>

Hi,

I have been testing AFC decay as used in our ECLiPSe Gecode interface 
code, and I suspect the decay specification is ignored:

We use Gecode's older (pre version 4) interface for AFC, i.e. with the 
AFC applied to all variables in the space, mainly because we want to use 
AFC when the search is done in ECLiPSe.

I did not significantly change the code for using AFC with Gecode's DFS 
search engine when moving from Gecode 3 to 4, i.e. I use e.g. 
INT_VAR_AFC_MAX() (also similarly for the other AFC selection 
strategies) in setting the variable selection (select) in

branch(*solver, vars, select, choice)

To set the decay, I do

solver->afc_decay(decay)

before the call to branch().

However, as far as I can tell from running with examples, this setting 
of the decay does not seem to do anything, as I get the same solution in 
essentially the same amount of runtime regardless of the decay setting 
(I tested with 1.0 and 0.0).

To see if changing the decay should make a difference, I did the search 
in ECLiPSe (i.e. not using the search engines), using the same variable 
selection and value choice, and here, for the example I tried (first 
solution, NQueens), setting the decay did make a significant difference 
to the run time, and a different solution is returned for a decay of 1.0 
and 0.0 -- the solution that is returned when the decay is set to 1.0 
seems to be the same one as when the DFS search engine is used.

Is this because the use of INT_VAR_AFC_MAX() actually sets the decay to 1.0?

Thanks in advance for any information!

Cheers,

Kish


From kisshen at cisco.com  Sun May 11 23:15:07 2014
From: kisshen at cisco.com (Kish Shen)
Date: Sun, 11 May 2014 22:15:07 +0100
Subject: [gecode-users] AFC decay with global AFC in search engines
In-Reply-To: <536D1488.406@cisco.com>
References: <536D1488.406@cisco.com>
Message-ID: <536FE85B.7010206@cisco.com>

On 09/05/2014 18:46, Kish Shen wrote:

> To set the decay, I do
>
> solver->afc_decay(decay)
>
> before the call to branch().
>

I moved the call to afc_decay() to after the call to branch(), and with 
this, setting afc_decay does make a difference. So is this the correct 
way to set the afc_decay?

Cheers,

Kish




From cschulte at kth.se  Mon May 12 14:32:20 2014
From: cschulte at kth.se (Christian Schulte)
Date: Mon, 12 May 2014 14:32:20 +0200
Subject: [gecode-users] AFC decay with global AFC in search engines
In-Reply-To: <536FE85B.7010206@cisco.com>
References: <536D1488.406@cisco.com> <536FE85B.7010206@cisco.com>
Message-ID: <031201cf6dde$38ba6260$aa2f2720$@se>

Hi Kish,

This is strange. It should not matter, in fact. Normally, afc_decay should
be called before search is started and the brancher is actually executed.

Are you sure that this was the case when setting afc_decay before?

Cheers
Christian

--
Christian Schulte, Professor of Computer Science, KTH,
www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Kish Shen
Sent: Sunday, May 11, 2014 11:15 PM
To: users at gecode.org
Subject: Re: [gecode-users] AFC decay with global AFC in search engines

On 09/05/2014 18:46, Kish Shen wrote:

> To set the decay, I do
>
> solver->afc_decay(decay)
>
> before the call to branch().
>

I moved the call to afc_decay() to after the call to branch(), and with
this, setting afc_decay does make a difference. So is this the correct way
to set the afc_decay?

Cheers,

Kish



_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From kisshen at cisco.com  Mon May 12 23:39:56 2014
From: kisshen at cisco.com (Kish Shen)
Date: Mon, 12 May 2014 22:39:56 +0100
Subject: [gecode-users] AFC decay with global AFC in search engines
In-Reply-To: <031201cf6dde$38ba6260$aa2f2720$@se>
References: <536D1488.406@cisco.com> <536FE85B.7010206@cisco.com>
	<031201cf6dde$38ba6260$aa2f2720$@se>
Message-ID: <53713FAC.4080602@cisco.com>

Hi Christian,

Thanks for your reply.

On 12/05/2014 13:32, Christian Schulte wrote:
> Hi Kish,
>
> This is strange. It should not matter, in fact. Normally, afc_decay should
> be called before search is started and the brancher is actually executed.
>
> Are you sure that this was the case when setting afc_decay before?
>


Yes, I am sure. I have recompiled my code with afc_decay called before 
and after the branch() call. Here are the timings (for first solution of 
27 Queens):

decay:       1.0                  0.0
======================================
before:     0.57                 0.54
after:      0.55                 4.68

The solutions for the three runs with runtime of around 0.5s seems to be 
the same.

This is with select in branch() set to INT_VAR_AFC_MAX(), rather than
INT_VAR_AFC_MAX(afc).

For activity, I set select to INT_VAR_ACTIVITY_MAX(act) before the call 
to branch() (as I was doing for afc), and this seems to work.

Cheers,

Kish



From kisshen at cisco.com  Tue May 13 00:00:52 2014
From: kisshen at cisco.com (Kish Shen)
Date: Mon, 12 May 2014 23:00:52 +0100
Subject: [gecode-users] AFC decay with global AFC in search engines
In-Reply-To: <53713FAC.4080602@cisco.com>
References: <536D1488.406@cisco.com>
	<536FE85B.7010206@cisco.com>	<031201cf6dde$38ba6260$aa2f2720$@se>
	<53713FAC.4080602@cisco.com>
Message-ID: <53714494.30109@cisco.com>

On 12/05/2014 22:39, Kish Shen wrote:
> For activity, I set select to INT_VAR_ACTIVITY_MAX(act) before the call
> to branch() (as I was doing for afc), and this seems to work.

I guess this might not be very clear: what I do for activity is:

    IntActivity act(*solver, vars, actdecay);
    ....
    select = INT_VAR_ACTIVITY_MAX(act);
    ....
    branch(*solver vars, select, choice);

where actdecay is the activity decay, and by working I mean that 
changing the value of actdecay does seem to affect the search.

The difference with AFC is that I can use AFC outside of the search 
engines (i.e. if the search is done in ECLiPSe), because there is a 
"global" AFC associated with the space, which is what I use. For 
activity, I can only use it with a Gecode search engine, by declaring an 
IntActivity act for the variables involved in the search (vars).

Cheers,

Kish





From cschulte at kth.se  Tue May 13 16:36:00 2014
From: cschulte at kth.se (Christian Schulte)
Date: Tue, 13 May 2014 16:36:00 +0200
Subject: [gecode-users] AFC decay with global AFC in search engines
In-Reply-To: <53714494.30109@cisco.com>
References: <536D1488.406@cisco.com>	<536FE85B.7010206@cisco.com>	<031201cf6dde$38ba6260$aa2f2720$@se>	<53713FAC.4080602@cisco.com>
	<53714494.30109@cisco.com>
Message-ID: <03d801cf6eb8$aa12f280$fe38d780$@se>

After some head scratching I found out what the problem is: when you call
INT_VAR_AFC_* and do not give it an argument, it will reset the afc-decay to
1.0 (so that means no decay). When you call afc_decay(d) after
INT_VAR_AFC_*, the d is used!

Cheers
Christian


--
Christian Schulte, Professor of Computer Science, KTH,
www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Kish Shen
Sent: Tuesday, May 13, 2014 12:01 AM
To: users at gecode.org
Subject: Re: [gecode-users] AFC decay with global AFC in search engines

On 12/05/2014 22:39, Kish Shen wrote:
> For activity, I set select to INT_VAR_ACTIVITY_MAX(act) before the 
> call to branch() (as I was doing for afc), and this seems to work.

I guess this might not be very clear: what I do for activity is:

    IntActivity act(*solver, vars, actdecay);
    ....
    select = INT_VAR_ACTIVITY_MAX(act);
    ....
    branch(*solver vars, select, choice);

where actdecay is the activity decay, and by working I mean that changing
the value of actdecay does seem to affect the search.

The difference with AFC is that I can use AFC outside of the search engines
(i.e. if the search is done in ECLiPSe), because there is a "global" AFC
associated with the space, which is what I use. For activity, I can only use
it with a Gecode search engine, by declaring an IntActivity act for the
variables involved in the search (vars).

Cheers,

Kish




_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From tomas.liden at liu.se  Thu May 15 13:16:52 2014
From: tomas.liden at liu.se (=?ISO-8859-1?Q?Tomas_Lid=E9n?=)
Date: Thu, 15 May 2014 13:16:52 +0200
Subject: [gecode-users] Sum over matrix slice
Message-ID: <5374A224.2010706@liu.se>

Hi!

While working on a course assignment I realized (after some struggling) 
that summing over a matrix slice does not perform as expected:

=== snippet ==
BoolVarArray x(home, n*n, 0, 1);
Matrix<BoolVarArray> m(x, n, n);

rel(home, sum(m.slice(i, i+1, i, i+1)) > 0); // forces m(i,i) > 0 !!
BoolVarArgs s;
s << m(i,i) << m(i+1,i) << m(i,i+1) << m(i+1,i+1);
rel(home, sum(s) > 0); // forces the sum over the 4 variables > 0 (as I 
wanted)

== end of snippet ==

The sum(m.slice(...)) only seems to sum the first element in the slice?!
Quite surprising and unnatural to me. Am I doing something wrong here?
(I get no compiler warnings or errors..)

The following post discusses a similar subject concerning IntVar's..
http://www.gecode.org/pipermail/users/2013-August/004086.html

All the best,
Tomas

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20140515/4b7f92ab/attachment.html>

From cschulte at kth.se  Thu May 15 13:39:11 2014
From: cschulte at kth.se (Christian Schulte)
Date: Thu, 15 May 2014 13:39:11 +0200
Subject: [gecode-users] Sum over matrix slice
In-Reply-To: <5374A224.2010706@liu.se>
References: <5374A224.2010706@liu.se>
Message-ID: <010601cf7032$4aefa9d0$e0cefd70$@se>

Hi Tomas,

 

According to the documentation slice(i1,i2,j1,j2) extracts the elements with
coordinates in [i1,i2) and [j1,j2).

 

So, in your example, slice(i,i+1,i,i+1) extracts the elements with
coordinates [i,i+1) and [i,i+1) which is the single element with coordinates
i,i. That means you have to write slice(i,i+2,i,i+2).

 

Cheers

Christian

 

--

Christian Schulte, Professor of Computer Science, KTH,
www.ict.kth.se/~cschulte/

 

From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Tomas Lid?n
Sent: Thursday, May 15, 2014 1:17 PM
To: users at gecode.org
Subject: [gecode-users] Sum over matrix slice

 

Hi!

While working on a course assignment I realized (after some struggling) that
summing over a matrix slice does not perform as expected:

=== snippet ==
BoolVarArray x(home, n*n, 0, 1);
Matrix<BoolVarArray> m(x, n, n);

rel(home, sum(m.slice(i, i+1, i, i+1)) > 0); // forces m(i,i) > 0 !!
BoolVarArgs s;
s << m(i,i) << m(i+1,i) << m(i,i+1) << m(i+1,i+1);
rel(home, sum(s) > 0); // forces the sum over the 4 variables > 0 (as I
wanted)

== end of snippet ==

The sum(m.slice(...)) only seems to sum the first element in the slice?!
Quite surprising and unnatural to me. Am I doing something wrong here?
(I get no compiler warnings or errors..)

The following post discusses a similar subject concerning IntVar's..
http://www.gecode.org/pipermail/users/2013-August/004086.html

All the best,
Tomas





-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20140515/f4e05830/attachment.html>

From tomas.liden at liu.se  Thu May 15 14:41:50 2014
From: tomas.liden at liu.se (=?ISO-8859-1?Q?Tomas_Lid=E9n?=)
Date: Thu, 15 May 2014 14:41:50 +0200
Subject: [gecode-users] Sum over matrix slice
In-Reply-To: <010601cf7032$4aefa9d0$e0cefd70$@se>
References: <5374A224.2010706@liu.se> <010601cf7032$4aefa9d0$e0cefd70$@se>
Message-ID: <5374B60E.6080602@liu.se>

Argh - my bad... Thanks!
/T

Christian Schulte skrev 2014-05-15 13:39:
>
> Hi Tomas,
>
> According to the documentation slice(i1,i2,j1,j2) extracts the 
> elements with coordinates in [i1,i2) and [j1,j2).
>
> So, in your example, slice(i,i+1,i,i+1) extracts the elements with 
> coordinates [i,i+1) and [i,i+1) which is the single element with 
> coordinates i,i. That means you have to write slice(i,i+2,i,i+2).
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20140515/8243a7c1/attachment.html>

From anton.dries at cs.kuleuven.be  Thu May 15 15:03:21 2014
From: anton.dries at cs.kuleuven.be (Anton Dries)
Date: Thu, 15 May 2014 15:03:21 +0200
Subject: [gecode-users] Constraint posting side effects
Message-ID: <80DB50DB-4F8F-43BB-9D52-972EA6405BFC@cs.kuleuven.be>

Hi all,

We are working on a complex program based on Gecode (complex in a sense that it generates models on-the-fly and post dynamic constraints during solving).

We have run into a bug that we find hard to explain.
I have narrowed it down to posting a single constraint:

void postConstraint(Space& home, IntVarArray iva, int i) {
   BoolVar p(home,0,1);
   rel(home, iva[i], IRT_EQ, 0, p);
}

We get a different set of results depending on whether we call this function or not.
My question is: what are the side effects of posting such a constraint?
Or, more specific:
- As I understand, it shouldn't change the set of results because the variable 'p' is not constrained. Is this correct?
- Could posting this constraint change the order in which results are found?

I'm sorry for the vagueness of this question, but the bug is very hard to reproduce and I just want to rule out any misconceptions I might have about what is supposed to happen here.

 
Best regards,
Anton

--
dr. ir. Anton Dries
Post-doctoral researcher
Dept. of Computer Science
DTAI/ML - KU Leuven
Disclaimer: http://www.kuleuven.be/cwis/email_disclaimer.htm


From anton.dries at cs.kuleuven.be  Thu May 15 17:36:41 2014
From: anton.dries at cs.kuleuven.be (Anton Dries)
Date: Thu, 15 May 2014 17:36:41 +0200
Subject: [gecode-users] Constraint posting side effects
In-Reply-To: <80DB50DB-4F8F-43BB-9D52-972EA6405BFC@cs.kuleuven.be>
References: <80DB50DB-4F8F-43BB-9D52-972EA6405BFC@cs.kuleuven.be>
Message-ID: <0EFFBC02-D916-4E33-81C7-9404E7996CF6@cs.kuleuven.be>


We found the problem. It's in one of our custom constraint propagators.
Adding the (inactive) constraint changes the variable selection order (we use INT_VAR_DEGREE_MAX) and that changes the behaviour of the propagator.


Anton


On 15 May 2014, at 15:03, Anton Dries <anton.dries at cs.kuleuven.be> wrote:

> Hi all,
> 
> We are working on a complex program based on Gecode (complex in a sense that it generates models on-the-fly and post dynamic constraints during solving).
> 
> We have run into a bug that we find hard to explain.
> I have narrowed it down to posting a single constraint:
> 
> void postConstraint(Space& home, IntVarArray iva, int i) {
>   BoolVar p(home,0,1);
>   rel(home, iva[i], IRT_EQ, 0, p);
> }
> 
> We get a different set of results depending on whether we call this function or not.
> My question is: what are the side effects of posting such a constraint?
> Or, more specific:
> - As I understand, it shouldn't change the set of results because the variable 'p' is not constrained. Is this correct?
> - Could posting this constraint change the order in which results are found?
> 
> I'm sorry for the vagueness of this question, but the bug is very hard to reproduce and I just want to rule out any misconceptions I might have about what is supposed to happen here.
> 
> 
> Best regards,
> Anton
> 
> --
> dr. ir. Anton Dries
> Post-doctoral researcher
> Dept. of Computer Science
> DTAI/ML - KU Leuven


Disclaimer: http://www.kuleuven.be/cwis/email_disclaimer.htm


From philipp.keck at gmx.de  Sun May 18 18:38:22 2014
From: philipp.keck at gmx.de (Philipp Keck)
Date: Sun, 18 May 2014 18:38:22 +0200
Subject: [gecode-users] Gecode terminates on incomplete solution
Message-ID: <5378E1FE.8010709@gmx.de>

Hi,

I am new to Gecode and also to Constraint Programming. While my first 
problem may be a general CP question (so off-topic here? In that case 
ignore it please.), my second problem is Gecode-specific.

My first problem is that Gecode either finds a solution immediately 
(<1ms) and without any backtracking (peak-depth equals explored 
nodes-1), or takes longer than I want to wait (at least 2 hours). This 
problem might be related to my problem instances, because or-tools shows 
exactly the same behaviour. My problem instances have 1,000 to 10,000 
boolean variables and 400 to 2,500 constraints. There are both large and 
small instances that can be solved within milliseconds, and both large 
and small instances that take a long time. For those that take more than 
2 hours, I still am sure that there is a solution, because Gurobi finds 
one when I formulate the same problem as an LP.
How could I improve the running time of Gecode here? Does adding more 
constraints make finding (any feasible) solution faster (because the 
search space is more restricted and therefore the search tree is 
smaller) or slower (because there are simply less solutions)? Should I 
add redundant constraints?

For a set of boolean variables, if I want at most one of them to be 1, 
is it better to add "a+b+c+... <= 1" using a linear-Constraint, or 
should I use "a!=b", "a!=c", "b!=c", ... instead? Unfortunately I have 
difficulties finding out the answers by experimenting because Gecode 
runs for such long times. Is there a way to get some output during the 
computation?


My second problem is a weird behaviour of Gecode terminating with some 
variables remaining unassigned:
My models have the following structure: I have boolean variables only 
and two kinds of constraints. The first kind of constraints requires 
exactly c variables out of a certain subset to be 1, e.g. "a+c+d+x+y = 
3" or "a+b = 1". The second kind allows at most one variable to be 1, 
e.g. "a+b+r <= 1". That's all.
As mentioned above, Gecode either terminates immediately, or takes a 
very long time. However, I have a particular problem instances that 
makes Gecode terminate and report "solutions: 1" without having all the 
variables set. So there are variables that still have [0..1] instead of 
a specific value and val() throws ValOfUnassignedVar. Why does Gecode 
terminate before it has a solution?
I call it like this:
branch(*this, allVariablesArgs, INT_VAR_NONE(), INT_VAL_MIN());
Using this call on the other hand makes Gecode compute forever (i.e. 
more than 2 hours):
branch(*this, allVariablesArgs, INT_VAR_RND(someRnd), 
INT_VAL_RND(someOtherRnd));

The problem might be related to how I implemented the copy function. I 
have my variables inside a std::map<std::string, BoolVar> *and* inside a 
BoolVarArgs and clone them like this:
variablesMap = s.variablesMap;
allVariablesArgs = BoolVarArgs(s.allVariablesArgs);
I don't know if that's the correct way to go. In particular, my copy 
implementation never uses the share-parameter.
After reading the thread "Integer Variable Randomization" on this 
mailing list, I also tried setting -c-d and -a-d to high values, but 
still the copy-method was called many times.

Thank you for any help!
Philipp

Platform: Windows 7 x64, Visual Studio 2013 x64, Gecode 4.2.1


From tack at gecode.org  Sun May 18 18:45:47 2014
From: tack at gecode.org (Guido Tack)
Date: Sun, 18 May 2014 17:45:47 +0100
Subject: [gecode-users] Gecode terminates on incomplete solution
In-Reply-To: <5378E1FE.8010709@gmx.de>
References: <5378E1FE.8010709@gmx.de>
Message-ID: <F4D15DDB-EFF6-4136-BD4B-20A9190731E6@gecode.org>

Hi,

you get unassigned variables in the output because you don't copy them properly in the copy constructor.  Please read the corresponding section in MPG (or look at the examples): you need to store your variables in a BoolVarArray and then use its update method in the copy constructor.

Regarding the more general problem, the search heuristic may have a huge impact on whether Gecode (or any solver) can find a solution quickly or not at all.  You could analyse the search tree for a long running instance using Gist.  That way you can see why the search fails often, and whether perhaps adding redundant constraints would add enough propagation to speed up the search.

The linear constraints on BoolVars are quite specialised so using them should be fine.

Cheers,
Guido

-- 
Guido Tack
http://www.csse.monash.edu/~guidot/



On 18 May 2014, at 5:38 pm, Philipp Keck <philipp.keck at gmx.de> wrote:

> Hi,
> 
> I am new to Gecode and also to Constraint Programming. While my first problem may be a general CP question (so off-topic here? In that case ignore it please.), my second problem is Gecode-specific.
> 
> My first problem is that Gecode either finds a solution immediately (<1ms) and without any backtracking (peak-depth equals explored nodes-1), or takes longer than I want to wait (at least 2 hours). This problem might be related to my problem instances, because or-tools shows exactly the same behaviour. My problem instances have 1,000 to 10,000 boolean variables and 400 to 2,500 constraints. There are both large and small instances that can be solved within milliseconds, and both large and small instances that take a long time. For those that take more than 2 hours, I still am sure that there is a solution, because Gurobi finds one when I formulate the same problem as an LP.
> How could I improve the running time of Gecode here? Does adding more constraints make finding (any feasible) solution faster (because the search space is more restricted and therefore the search tree is smaller) or slower (because there are simply less solutions)? Should I add redundant constraints?
> 
> For a set of boolean variables, if I want at most one of them to be 1, is it better to add "a+b+c+... <= 1" using a linear-Constraint, or should I use "a!=b", "a!=c", "b!=c", ... instead? Unfortunately I have difficulties finding out the answers by experimenting because Gecode runs for such long times. Is there a way to get some output during the computation?
> 
> 
> My second problem is a weird behaviour of Gecode terminating with some variables remaining unassigned:
> My models have the following structure: I have boolean variables only and two kinds of constraints. The first kind of constraints requires exactly c variables out of a certain subset to be 1, e.g. "a+c+d+x+y = 3" or "a+b = 1". The second kind allows at most one variable to be 1, e.g. "a+b+r <= 1". That's all.
> As mentioned above, Gecode either terminates immediately, or takes a very long time. However, I have a particular problem instances that makes Gecode terminate and report "solutions: 1" without having all the variables set. So there are variables that still have [0..1] instead of a specific value and val() throws ValOfUnassignedVar. Why does Gecode terminate before it has a solution?
> I call it like this:
> branch(*this, allVariablesArgs, INT_VAR_NONE(), INT_VAL_MIN());
> Using this call on the other hand makes Gecode compute forever (i.e. more than 2 hours):
> branch(*this, allVariablesArgs, INT_VAR_RND(someRnd), INT_VAL_RND(someOtherRnd));
> 
> The problem might be related to how I implemented the copy function. I have my variables inside a std::map<std::string, BoolVar> *and* inside a BoolVarArgs and clone them like this:
> variablesMap = s.variablesMap;
> allVariablesArgs = BoolVarArgs(s.allVariablesArgs);
> I don't know if that's the correct way to go. In particular, my copy implementation never uses the share-parameter.
> After reading the thread "Integer Variable Randomization" on this mailing list, I also tried setting -c-d and -a-d to high values, but still the copy-method was called many times.
> 
> Thank you for any help!
> Philipp
> 
> Platform: Windows 7 x64, Visual Studio 2013 x64, Gecode 4.2.1
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20140518/6cdd8265/attachment.html>

From ostrowsk at cs.uni-potsdam.de  Mon May 19 09:36:27 2014
From: ostrowsk at cs.uni-potsdam.de (Max Ostrowski)
Date: Mon, 19 May 2014 09:36:27 +0200
Subject: [gecode-users] Gecode terminates on incomplete solution
In-Reply-To: <5378E1FE.8010709@gmx.de>
References: <5378E1FE.8010709@gmx.de>
Message-ID: <5379B47B.1030501@cs.uni-potsdam.de>

Hi,

On 05/18/2014 06:38 PM, Philipp Keck wrote:
> Hi,
> 
> I am new to Gecode and also to Constraint Programming. While my first
> problem may be a general CP question (so off-topic here? In that case
> ignore it please.), my second problem is Gecode-specific.
> 
> My first problem is that Gecode either finds a solution immediately
> (<1ms) and without any backtracking (peak-depth equals explored
> nodes-1), or takes longer than I want to wait (at least 2 hours). This
> problem might be related to my problem instances, because or-tools shows
> exactly the same behaviour. My problem instances have 1,000 to 10,000
> boolean variables and 400 to 2,500 constraints. There are both large and
> small instances that can be solved within milliseconds, and both large
> and small instances that take a long time. For those that take more than
> 2 hours, I still am sure that there is a solution, because Gurobi finds
> one when I formulate the same problem as an LP.
> How could I improve the running time of Gecode here? Does adding more
> constraints make finding (any feasible) solution faster (because the
> search space is more restricted and therefore the search tree is
> smaller) or slower (because there are simply less solutions)? Should I
> add redundant constraints?

If adding more constraints make the search faster or not can not be said
in general.
Adding redundant constraints is always worse a try, if you can improve
propagation strength with it.
> 
> For a set of boolean variables, if I want at most one of them to be 1,
> is it better to add "a+b+c+... <= 1" using a linear-Constraint, or
> should I use "a!=b", "a!=c", "b!=c", ... instead? Unfortunately I have
> difficulties finding out the answers by experimenting because Gecode
> runs for such long times. Is there a way to get some output during the
> computation?

The first thing you can try is using global cosntraints that exactly fit
your needs.
In this case, allDifferent or atmost, etc...
They usually perform much better than linear constraints.
(It may be the case that Gecode automatically detects this in your case
and replaces the linear constraints with the global constraints. )

Furthermore, your problem sounds like a PB(Pseudo-Boolean) problem.
So maybe you should try a PB solver.

Best,
Max

> 
> My second problem is a weird behaviour of Gecode terminating with some
> variables remaining unassigned:
> My models have the following structure: I have boolean variables only
> and two kinds of constraints. The first kind of constraints requires
> exactly c variables out of a certain subset to be 1, e.g. "a+c+d+x+y =
> 3" or "a+b = 1". The second kind allows at most one variable to be 1,
> e.g. "a+b+r <= 1". That's all.
> As mentioned above, Gecode either terminates immediately, or takes a
> very long time. However, I have a particular problem instances that
> makes Gecode terminate and report "solutions: 1" without having all the
> variables set. So there are variables that still have [0..1] instead of
> a specific value and val() throws ValOfUnassignedVar. Why does Gecode
> terminate before it has a solution?
> I call it like this:
> branch(*this, allVariablesArgs, INT_VAR_NONE(), INT_VAL_MIN());
> Using this call on the other hand makes Gecode compute forever (i.e.
> more than 2 hours):
> branch(*this, allVariablesArgs, INT_VAR_RND(someRnd),
> INT_VAL_RND(someOtherRnd));
> 
> The problem might be related to how I implemented the copy function. I
> have my variables inside a std::map<std::string, BoolVar> *and* inside a
> BoolVarArgs and clone them like this:
> variablesMap = s.variablesMap;
> allVariablesArgs = BoolVarArgs(s.allVariablesArgs);
> I don't know if that's the correct way to go. In particular, my copy
> implementation never uses the share-parameter.
> After reading the thread "Integer Variable Randomization" on this
> mailing list, I also tried setting -c-d and -a-d to high values, but
> still the copy-method was called many times.
> 
> Thank you for any help!
> Philipp
> 
> Platform: Windows 7 x64, Visual Studio 2013 x64, Gecode 4.2.1
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users



From kisshen at cisco.com  Fri May 23 04:12:51 2014
From: kisshen at cisco.com (Kish Shen)
Date: Fri, 23 May 2014 03:12:51 +0100
Subject: [gecode-users] AFC decay with global AFC in search engines
In-Reply-To: <03d801cf6eb8$aa12f280$fe38d780$@se>
References: <536D1488.406@cisco.com>	<536FE85B.7010206@cisco.com>	<031201cf6dde$38ba6260$aa2f2720$@se>	<53713FAC.4080602@cisco.com>
	<53714494.30109@cisco.com> <03d801cf6eb8$aa12f280$fe38d780$@se>
Message-ID: <537EAEA3.3040807@cisco.com>

Hi Christian,

Thanks for this. I decided to change my code to ude INT_VAR_AFC_* with a 
decay argument, and then I tried to rerun the test. However, I now get
a Gecode exception "AFC: Illegal decay factor" for a factor of 0.0 with

IntAFC afc(*solver, vars, 0.0);

while previously, I was able to set the decay factor to 0 with 
afc_decay(0.0).

I assume this is because of a > vs >= test for the valid value. Should 
this be changed? It seems 0 should be a legal value (even if it is not 
too sensible).

On a related note, from the description in the MPG, I assume there is 
only a single AFC decay factor, so setting the decay factor with

IntAFC afc(*solver, vars, decay)

will also change the "global" decay factor, i.e. the one obtained by 
afc_decay(). Is this correct?

Cheers,

Kish




From cschulte at kth.se  Fri May 23 09:50:37 2014
From: cschulte at kth.se (Christian Schulte)
Date: Fri, 23 May 2014 09:50:37 +0200
Subject: [gecode-users] AFC decay with global AFC in search engines
In-Reply-To: <537EAEA3.3040807@cisco.com>
References: <536D1488.406@cisco.com>	<536FE85B.7010206@cisco.com>	<031201cf6dde$38ba6260$aa2f2720$@se>	<53713FAC.4080602@cisco.com>	<53714494.30109@cisco.com>
	<03d801cf6eb8$aa12f280$fe38d780$@se> <537EAEA3.3040807@cisco.com>
Message-ID: <004d01cf765b$b0472db0$10d58910$@kth.se>

Hi Kish,

Yes, a decay factor of zero makes normally no sense. If you want me to, I
can change that.

Yes, you are right, there is only one global AFC decay factor.

Cheers
Christian

--
Christian Schulte, KTH, web.it.kth.se/~cschulte/

-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Kish Shen
Sent: Friday, May 23, 2014 04:13 AM
To: users at gecode.org
Subject: Re: [gecode-users] AFC decay with global AFC in search engines

Hi Christian,

Thanks for this. I decided to change my code to ude INT_VAR_AFC_* with a
decay argument, and then I tried to rerun the test. However, I now get a
Gecode exception "AFC: Illegal decay factor" for a factor of 0.0 with

IntAFC afc(*solver, vars, 0.0);

while previously, I was able to set the decay factor to 0 with
afc_decay(0.0).

I assume this is because of a > vs >= test for the valid value. Should this
be changed? It seems 0 should be a legal value (even if it is not too
sensible).

On a related note, from the description in the MPG, I assume there is only a
single AFC decay factor, so setting the decay factor with

IntAFC afc(*solver, vars, decay)

will also change the "global" decay factor, i.e. the one obtained by
afc_decay(). Is this correct?

Cheers,

Kish



_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From kisshen at cisco.com  Fri May 23 19:40:07 2014
From: kisshen at cisco.com (Kish Shen)
Date: Fri, 23 May 2014 18:40:07 +0100
Subject: [gecode-users] AFC decay with global AFC in search engines
In-Reply-To: <004b01cf765b$98eeebd0$caccc370$@kth.se>
References: <536D1488.406@cisco.com>	<536FE85B.7010206@cisco.com>	<031201cf6dde$38ba6260$aa2f2720$@se>	<53713FAC.4080602@cisco.com>	<53714494.30109@cisco.com>
	<03d801cf6eb8$aa12f280$fe38d780$@se> <537EAEA3.3040807@cisco.com>
	<004b01cf765b$98eeebd0$caccc370$@kth.se>
Message-ID: <537F87F7.50504@cisco.com>

Hi Christian,

To me, legal but not sensible values should be allowed -- some of the 
variable and value selection strategies implemented by Gecode probably 
are not very sensible also. In addition, the AFC decay factor can be set 
to 0 already using afc_decay(0.0), so making the initialision of an 
IntAFC consistent with that seems reasonable to me.

Also, the decay factor for IntActivity can be set to 0, although I guess 
it might make more sense here, as AFC is only changed when a failure occurs.

Cheers,

Kish

On 23/05/2014 08:49, Christian Schulte wrote:
> Hi Kish,
>
> Yes, a decay factor of zero makes normally no sense. If you want me to, I
> can change that.
>
> Yes, you are right, there is only one global AFC decay factor.
>
> Cheers
> Christian
>
> Christian Schulte, KTH, web.it.kth.se/~cschulte/
>
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
> Of Kish Shen
> Sent: Friday, May 23, 2014 04:13 AM
> To: users at gecode.org
> Subject: Re: [gecode-users] AFC decay with global AFC in search engines
>
> Hi Christian,
>
> Thanks for this. I decided to change my code to ude INT_VAR_AFC_* with a
> decay argument, and then I tried to rerun the test. However, I now get a
> Gecode exception "AFC: Illegal decay factor" for a factor of 0.0 with
>
> IntAFC afc(*solver, vars, 0.0);
>
> while previously, I was able to set the decay factor to 0 with
> afc_decay(0.0).
>
> I assume this is because of a > vs >= test for the valid value. Should this
> be changed? It seems 0 should be a legal value (even if it is not too
> sensible).
>
> On a related note, from the description in the MPG, I assume there is only a
> single AFC decay factor, so setting the decay factor with
>
> IntAFC afc(*solver, vars, decay)
>
> will also change the "global" decay factor, i.e. the one obtained by
> afc_decay(). Is this correct?
>
> Cheers,
>
> Kish
>
>
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>



From cschulte at kth.se  Tue May 27 14:58:03 2014
From: cschulte at kth.se (Christian Schulte)
Date: Tue, 27 May 2014 14:58:03 +0200
Subject: [gecode-users] AFC decay with global AFC in search engines
In-Reply-To: <537F87F7.50504@cisco.com>
References: <536D1488.406@cisco.com>	<536FE85B.7010206@cisco.com>	<031201cf6dde$38ba6260$aa2f2720$@se>	<53713FAC.4080602@cisco.com>	<53714494.30109@cisco.com>	<03d801cf6eb8$aa12f280$fe38d780$@se>
	<537EAEA3.3040807@cisco.com>	<004b01cf765b$98eeebd0$caccc370$@kth.se>
	<537F87F7.50504@cisco.com>
Message-ID: <009501cf79ab$4cb9d790$e62d86b0$@se>

Hi Kish, changed in the trunk. Cheers Christian

--
Christian Schulte, Professor of Computer Science, KTH,
www.ict.kth.se/~cschulte/


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Kish Shen
Sent: Friday, May 23, 2014 7:40 PM
To: users at gecode.org
Subject: Re: [gecode-users] AFC decay with global AFC in search engines

Hi Christian,

To me, legal but not sensible values should be allowed -- some of the
variable and value selection strategies implemented by Gecode probably are
not very sensible also. In addition, the AFC decay factor can be set to 0
already using afc_decay(0.0), so making the initialision of an IntAFC
consistent with that seems reasonable to me.

Also, the decay factor for IntActivity can be set to 0, although I guess it
might make more sense here, as AFC is only changed when a failure occurs.

Cheers,

Kish

On 23/05/2014 08:49, Christian Schulte wrote:
> Hi Kish,
>
> Yes, a decay factor of zero makes normally no sense. If you want me 
> to, I can change that.
>
> Yes, you are right, there is only one global AFC decay factor.
>
> Cheers
> Christian
>
> Christian Schulte, KTH, web.it.kth.se/~cschulte/
>
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On 
> Behalf Of Kish Shen
> Sent: Friday, May 23, 2014 04:13 AM
> To: users at gecode.org
> Subject: Re: [gecode-users] AFC decay with global AFC in search 
> engines
>
> Hi Christian,
>
> Thanks for this. I decided to change my code to ude INT_VAR_AFC_* with 
> a decay argument, and then I tried to rerun the test. However, I now 
> get a Gecode exception "AFC: Illegal decay factor" for a factor of 0.0 
> with
>
> IntAFC afc(*solver, vars, 0.0);
>
> while previously, I was able to set the decay factor to 0 with 
> afc_decay(0.0).
>
> I assume this is because of a > vs >= test for the valid value. Should 
> this be changed? It seems 0 should be a legal value (even if it is not 
> too sensible).
>
> On a related note, from the description in the MPG, I assume there is 
> only a single AFC decay factor, so setting the decay factor with
>
> IntAFC afc(*solver, vars, decay)
>
> will also change the "global" decay factor, i.e. the one obtained by 
> afc_decay(). Is this correct?
>
> Cheers,
>
> Kish
>
>
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



