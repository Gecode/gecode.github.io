From filip.konvicka at logis.cz  Fri Apr  1 14:40:31 2016
From: filip.konvicka at logis.cz (=?UTF-8?Q?Filip_Konvi=c4=8dka?=)
Date: Fri, 1 Apr 2016 14:40:31 +0200
Subject: [gecode-users] Freeze with MSVC 2015 optimized build
In-Reply-To: <046601d0ff63$ebf91840$c3eb48c0$@kth.se>
References: <ms91ji$t2s$1@ger.gmane.org>
	<000b01d0e627$0e3c24c0$2ab46e40$@kth.se> <ms939m$p0e$1@ger.gmane.org>
	<mteeso$vg0$1@ger.gmane.org> <00a001d0f14c$b10d1ee0$13275ca0$@kth.se>
	<mtefpa$f98$1@ger.gmane.org> <00be01d0f156$472d0a80$d5871f80$@kth.se>
	<mteklg$60h$1@ger.gmane.org> <00f201d0f15a$68174310$3845c930$@kth.se>
	<mtem3n$ur8$1@ger.gmane.org> <mten1j$f52$1@ger.gmane.org>
	<004201d0f1fb$dddb3380$99919a80$@kth.se> <mtgsg1$uaj$1@ger.gmane.org>
	<mulddl$hr5$1@ger.gmane.org> <046601d0ff63$ebf91840$c3eb48c0$@kth.se>
Message-ID: <ndlq7v$408$1@ger.gmane.org>

Hi Christian,

Have you had any chance to look into supporting gcc 5 and MSVC 2015?

Thanks,
Filip

> Hi Filip,
>
> Thanks for the information. This really looks like a gcc problem. Guido, can
> you reproduce this behavior?
>
> Cheers
> Christian
>
> --
> Christian Schulte, www.gecode.org/~schulte
> Professor of Computer Science, KTH, cschulte at kth.se
> Expert Researcher, SICS, cschulte at sics.se
>
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
> Of Filip Konvicka
> Sent: Friday, October 2, 2015 09:58 AM
> To: users at gecode.org
> Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build
>
> Hi,
>
> We were looking a bit more into 4.4.0 on Linux where we've also hit some
> issues.
>
> All tests worked fine with gcc 4.9.3.  However, with gcc 5.2.0 many tests
> failed - see the attachements for details:
>     gecode-4.4.0-gcc-5.2.0-failed_tests.list
>     ... list of failed tests (except two memory fails below)
>     gecode-4.4.0-gcc-5.2.0-failed_tests.log
>     ... log from 'test' for failed tests
>
> Two tests ran out of memory (allocated several GBs of memory before getting
> killed by system):
>     Set::Branch::Sparse::3
>     Set::Channel::Sorted
>
> gcc details:
> target=x86_64-linux-gnu
> GCC_VER=5.2.0
> GMP_VER=6.0.0
> MPFR_VER=3.1.3
> MPC_VER=1.0.3
> BINUTILS_VER=2.25
>
> It could also be a gcc bug of course, hard to tell.
>
> Thanks,
> Filip
>




From cschulte at kth.se  Sat Apr  2 14:21:04 2016
From: cschulte at kth.se (Christian Schulte)
Date: Sat, 2 Apr 2016 14:21:04 +0200
Subject: [gecode-users] Freeze with MSVC 2015 optimized build
In-Reply-To: <ndlq7v$408$1@ger.gmane.org>
References: <ms91ji$t2s$1@ger.gmane.org>	<000b01d0e627$0e3c24c0$2ab46e40$@kth.se>
	<ms939m$p0e$1@ger.gmane.org>	<mteeso$vg0$1@ger.gmane.org>
	<00a001d0f14c$b10d1ee0$13275ca0$@kth.se>	<mtefpa$f98$1@ger.gmane.org>
	<00be01d0f156$472d0a80$d5871f80$@kth.se>	<mteklg$60h$1@ger.gmane.org>
	<00f201d0f15a$68174310$3845c930$@kth.se>	<mtem3n$ur8$1@ger.gmane.org>
	<mten1j$f52$1@ger.gmane.org>	<004201d0f1fb$dddb3380$99919a80$@kth.se>
	<mtgsg1$uaj$1@ger.gmane.org>	<mulddl$hr5$1@ger.gmane.org>
	<046601d0ff63$ebf91840$c3eb48c0$@kth.se>
	<ndlq7v$408$1@ger.gmane.org>
Message-ID: <008901d18cda$246e1b90$6d4a52b0$@kth.se>

MSVC2015 works for Gecode.4.4.0 since its initial release, I in fact
uploaded packages to the Gecode website last week. Since last week (Mar 30)
the update 2 to MSVC 2015 finally also compiles the trunk and the upcoming
Gecode 5.0.0.

Don't know about GCC, though.

Cheers
Christian



--
Christian Schulte, www.gecode.org/~schulte 
Professor of Computer Science, KTH, cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se

-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Filip Konvicka
Sent: Friday, April 1, 2016 14:41
To: users at gecode.org
Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build

Hi Christian,

Have you had any chance to look into supporting gcc 5 and MSVC 2015?

Thanks,
Filip

> Hi Filip,
>
> Thanks for the information. This really looks like a gcc problem. 
> Guido, can you reproduce this behavior?
>
> Cheers
> Christian
>
> --
> Christian Schulte, www.gecode.org/~schulte Professor of Computer 
> Science, KTH, cschulte at kth.se Expert Researcher, SICS, 
> cschulte at sics.se
>
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On 
> Behalf Of Filip Konvicka
> Sent: Friday, October 2, 2015 09:58 AM
> To: users at gecode.org
> Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build
>
> Hi,
>
> We were looking a bit more into 4.4.0 on Linux where we've also hit 
> some issues.
>
> All tests worked fine with gcc 4.9.3.  However, with gcc 5.2.0 many 
> tests failed - see the attachements for details:
>     gecode-4.4.0-gcc-5.2.0-failed_tests.list
>     ... list of failed tests (except two memory fails below)
>     gecode-4.4.0-gcc-5.2.0-failed_tests.log
>     ... log from 'test' for failed tests
>
> Two tests ran out of memory (allocated several GBs of memory before 
> getting killed by system):
>     Set::Branch::Sparse::3
>     Set::Channel::Sorted
>
> gcc details:
> target=x86_64-linux-gnu
> GCC_VER=5.2.0
> GMP_VER=6.0.0
> MPFR_VER=3.1.3
> MPC_VER=1.0.3
> BINUTILS_VER=2.25
>
> It could also be a gcc bug of course, hard to tell.
>
> Thanks,
> Filip
>



_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From filip.konvicka at logis.cz  Sat Apr  2 17:24:20 2016
From: filip.konvicka at logis.cz (=?UTF-8?Q?Filip_Konvi=c4=8dka?=)
Date: Sat, 2 Apr 2016 17:24:20 +0200
Subject: [gecode-users] Freeze with MSVC 2015 optimized build
In-Reply-To: <008901d18cda$246e1b90$6d4a52b0$@kth.se>
References: <ms91ji$t2s$1@ger.gmane.org>
	<000b01d0e627$0e3c24c0$2ab46e40$@kth.se> <ms939m$p0e$1@ger.gmane.org>
	<mteeso$vg0$1@ger.gmane.org> <00a001d0f14c$b10d1ee0$13275ca0$@kth.se>
	<mtefpa$f98$1@ger.gmane.org> <00be01d0f156$472d0a80$d5871f80$@kth.se>
	<mteklg$60h$1@ger.gmane.org> <00f201d0f15a$68174310$3845c930$@kth.se>
	<mtem3n$ur8$1@ger.gmane.org> <mten1j$f52$1@ger.gmane.org>
	<004201d0f1fb$dddb3380$99919a80$@kth.se> <mtgsg1$uaj$1@ger.gmane.org>
	<mulddl$hr5$1@ger.gmane.org> <046601d0ff63$ebf91840$c3eb48c0$@kth.se>
	<ndlq7v$408$1@ger.gmane.org> <008901d18cda$246e1b90$6d4a52b0$@kth.se>
Message-ID: <ndoo75$h9n$1@ger.gmane.org>

Christian,

Thanks.  I was referring to this September & October thread - there were 
issues with Gecode freezing on some FloatVar problems (my testcase and 
your "Float::Arithmetic::Div::C") with MSVC 2015, and you said then that 
it might be resolved by not using SSE2 (but that Guido would investigate 
more).  We also identified a number of float tests that were failing on 
GCC 5 (not with GCC 4.9).

I can try re-running our tests here with the current trunk to see if 
something changed - I just thought that I would ask directly whether you 
did something specific to address these issues.  The failures seemed a 
bit non-deterministic...

Thanks,
Filip

> MSVC2015 works for Gecode.4.4.0 since its initial release, I in fact
> uploaded packages to the Gecode website last week. Since last week (Mar 30)
> the update 2 to MSVC 2015 finally also compiles the trunk and the upcoming
> Gecode 5.0.0.
>
> Don't know about GCC, though.
>
> Cheers
> Christian
>
>
>
> --
> Christian Schulte, www.gecode.org/~schulte
> Professor of Computer Science, KTH, cschulte at kth.se
> Expert Researcher, SICS, cschulte at sics.se
>
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
> Of Filip Konvicka
> Sent: Friday, April 1, 2016 14:41
> To: users at gecode.org
> Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build
>
> Hi Christian,
>
> Have you had any chance to look into supporting gcc 5 and MSVC 2015?
>
> Thanks,
> Filip
>
>> Hi Filip,
>>
>> Thanks for the information. This really looks like a gcc problem.
>> Guido, can you reproduce this behavior?
>>
>> Cheers
>> Christian
>>
>> --
>> Christian Schulte, www.gecode.org/~schulte Professor of Computer
>> Science, KTH, cschulte at kth.se Expert Researcher, SICS,
>> cschulte at sics.se
>>
>> -----Original Message-----
>> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On
>> Behalf Of Filip Konvicka
>> Sent: Friday, October 2, 2015 09:58 AM
>> To: users at gecode.org
>> Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build
>>
>> Hi,
>>
>> We were looking a bit more into 4.4.0 on Linux where we've also hit
>> some issues.
>>
>> All tests worked fine with gcc 4.9.3.  However, with gcc 5.2.0 many
>> tests failed - see the attachements for details:
>>      gecode-4.4.0-gcc-5.2.0-failed_tests.list
>>      ... list of failed tests (except two memory fails below)
>>      gecode-4.4.0-gcc-5.2.0-failed_tests.log
>>      ... log from 'test' for failed tests
>>
>> Two tests ran out of memory (allocated several GBs of memory before
>> getting killed by system):
>>      Set::Branch::Sparse::3
>>      Set::Channel::Sorted
>>
>> gcc details:
>> target=x86_64-linux-gnu
>> GCC_VER=5.2.0
>> GMP_VER=6.0.0
>> MPFR_VER=3.1.3
>> MPC_VER=1.0.3
>> BINUTILS_VER=2.25
>>
>> It could also be a gcc bug of course, hard to tell.
>>
>> Thanks,
>> Filip
>>
>
>
>
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
>




From filip.konvicka at logis.cz  Sun Apr  3 22:12:25 2016
From: filip.konvicka at logis.cz (=?UTF-8?Q?Filip_Konvi=c4=8dka?=)
Date: Sun, 3 Apr 2016 22:12:25 +0200
Subject: [gecode-users] Freeze with MSVC 2015 optimized build
In-Reply-To: <ndoo75$h9n$1@ger.gmane.org>
References: <ms91ji$t2s$1@ger.gmane.org>
	<000b01d0e627$0e3c24c0$2ab46e40$@kth.se> <ms939m$p0e$1@ger.gmane.org>
	<mteeso$vg0$1@ger.gmane.org> <00a001d0f14c$b10d1ee0$13275ca0$@kth.se>
	<mtefpa$f98$1@ger.gmane.org> <00be01d0f156$472d0a80$d5871f80$@kth.se>
	<mteklg$60h$1@ger.gmane.org> <00f201d0f15a$68174310$3845c930$@kth.se>
	<mtem3n$ur8$1@ger.gmane.org> <mten1j$f52$1@ger.gmane.org>
	<004201d0f1fb$dddb3380$99919a80$@kth.se> <mtgsg1$uaj$1@ger.gmane.org>
	<mulddl$hr5$1@ger.gmane.org> <046601d0ff63$ebf91840$c3eb48c0$@kth.se>
	<ndlq7v$408$1@ger.gmane.org> <008901d18cda$246e1b90$6d4a52b0$@kth.se>
	<ndoo75$h9n$1@ger.gmane.org>
Message-ID: <ndrtf9$nmi$1@ger.gmane.org>

Hi,

I have updated to MSVC 2015 update 2, compiled the current Gecode trunk 
for x64, and my testcase from the beginning of this thread still freezes 
(the one from Sep 3rd 2015 - I have attached it to this mail for 
convenience).

I also tried running Float::Arithmetic::Div::Sol::A and that test still 
fails.  For some reason 'make check' only runs a small subset of tests, 
so I ran this manually like this:

$ test/test -test Float::Arithmetic::Div::Sol::A
Float::Arithmetic::Div::Sol::A -
Options: -seed 1 -test Float::Arithmetic::Div::Sol::A

Another try failed with a different seed number:
$ test/test -test Float::Arithmetic::Div
Float::Arithmetic::Div::A +++++
Float::Arithmetic::Div::B +++++
Float::Arithmetic::Div::C +++++
Float::Arithmetic::Div::Sol::A -
Options: -seed 1975575111 -test Float::Arithmetic::Div::Sol::A

Thanks,
Filip

> Christian,
>
> Thanks.  I was referring to this September & October thread - there were
> issues with Gecode freezing on some FloatVar problems (my testcase and
> your "Float::Arithmetic::Div::C") with MSVC 2015, and you said then that
> it might be resolved by not using SSE2 (but that Guido would investigate
> more).  We also identified a number of float tests that were failing on
> GCC 5 (not with GCC 4.9).
>
> I can try re-running our tests here with the current trunk to see if
> something changed - I just thought that I would ask directly whether you
> did something specific to address these issues.  The failures seemed a
> bit non-deterministic...
>
> Thanks,
> Filip
>
>> MSVC2015 works for Gecode.4.4.0 since its initial release, I in fact
>> uploaded packages to the Gecode website last week. Since last week
>> (Mar 30)
>> the update 2 to MSVC 2015 finally also compiles the trunk and the
>> upcoming
>> Gecode 5.0.0.
>>
>> Don't know about GCC, though.
>>
>> Cheers
>> Christian
>>
>>
>>
>> --
>> Christian Schulte, www.gecode.org/~schulte
>> Professor of Computer Science, KTH, cschulte at kth.se
>> Expert Researcher, SICS, cschulte at sics.se
>>
>> -----Original Message-----
>> From: users-bounces at gecode.org
>> [mailto:users-bounces at gecode.org] On Behalf
>> Of Filip Konvicka
>> Sent: Friday, April 1, 2016 14:41
>> To: users at gecode.org
>> Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build
>>
>> Hi Christian,
>>
>> Have you had any chance to look into supporting gcc 5 and MSVC 2015?
>>
>> Thanks,
>> Filip
>>
>>> Hi Filip,
>>>
>>> Thanks for the information. This really looks like a gcc problem.
>>> Guido, can you reproduce this behavior?
>>>
>>> Cheers
>>> Christian
>>>
>>> --
>>> Christian Schulte, www.gecode.org/~schulte Professor of Computer
>>> Science, KTH, cschulte at kth.se Expert
>>> Researcher, SICS,
>>> cschulte at sics.se
>>>
>>> -----Original Message-----
>>> From: users-bounces at gecode.org
>>> [mailto:users-bounces at gecode.org] On
>>> Behalf Of Filip Konvicka
>>> Sent: Friday, October 2, 2015 09:58 AM
>>> To: users at gecode.org
>>> Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build
>>>
>>> Hi,
>>>
>>> We were looking a bit more into 4.4.0 on Linux where we've also hit
>>> some issues.
>>>
>>> All tests worked fine with gcc 4.9.3.  However, with gcc 5.2.0 many
>>> tests failed - see the attachements for details:
>>>      gecode-4.4.0-gcc-5.2.0-failed_tests.list
>>>      ... list of failed tests (except two memory fails below)
>>>      gecode-4.4.0-gcc-5.2.0-failed_tests.log
>>>      ... log from 'test' for failed tests
>>>
>>> Two tests ran out of memory (allocated several GBs of memory before
>>> getting killed by system):
>>>      Set::Branch::Sparse::3
>>>      Set::Channel::Sorted
>>>
>>> gcc details:
>>> target=x86_64-linux-gnu
>>> GCC_VER=5.2.0
>>> GMP_VER=6.0.0
>>> MPFR_VER=3.1.3
>>> MPC_VER=1.0.3
>>> BINUTILS_VER=2.25
>>>
>>> It could also be a gcc bug of course, hard to tell.
>>>
>>> Thanks,
>>> Filip
>>>
>>
>>
>>
>> _______________________________________________
>> Gecode users mailing list
>> users at gecode.org
>> https://www.gecode.org/mailman/listinfo/gecode-users
>>




From florent.teichteil at gmail.com  Sun Apr  3 22:18:31 2016
From: florent.teichteil at gmail.com (Florent Teichteil)
Date: Sun, 03 Apr 2016 20:18:31 +0000
Subject: [gecode-users] Poor performance on simple allocation problem: did I
	make something wrong?
Message-ID: <CAMW3hvPonBwmDMjXVDr3_D3YG6s0nqsHQJJ1=VyDwAk5vb2fiw@mail.gmail.com>

Hi all,

I am wondering if I use Gecode the right way since I get poor performances
on a simple optimal allocation problem. The B&B search algorithm keeps
improving the cost but without ever converging (even after several minutes)
while the same problem is solved in less than 100ms with the CBC solver
from COIN. I must say that I am more comfortable with operation research
algorithms than with CP ones, so it is possible that I misuse Gecode.

The problem consists in assigning objects in A to objects in B so as to
maximize the overall revenue.
Allocations are optional, i.e. a given object in B does not need to have an
assigned object from A if it decreases the overall revenue.
By abusing the notation I represent A and B as positive integers and the
corresponding object sets as {0,...,A-1} and {0,...,B-1}

ILP model:
  * Decision variables: x(a,b) in {0,1} for each a in {0,...,A-1} and b in
{0,...,B-1}
  * R(a,b)=floor(A*B*cos(2*PI*a*b/A*B)) is the revenue of the allocation
pair (a,b)
  * max sum_{a in {0,...,A-1}, b in {0,...,B-1}} x(a,b) * R(a,b)
  * for each a in {0,...,A-1}: sum(b in {0,...,B-1}) x(a,b) <= 1
  * for each b in {0,...,B-1}: sum(a in {0,...,A-1}) x(a,b) <= 1

CP model:
  * Decision variables:
      - x(b) in {0,...,A} for each b in {0,...,B-1}; x(b)=A when no object
from A is assigned to b
      - y(b) = R(x(b),b) in {0,...} if x(b) != A else 0, for each b in
{0,...,B-1}
  * with R(a,b)=floor(A*B*cos(2*PI*a*b/A*B)) is the revenue of the
allocation pair (a,b)
  * max sum_{b in {0,...,B-1}} y(b)
  * for each b in {0,...,B-1}: y(b) = floor(A*B*cos(2*PI*x(b)*b/A*B)) if
x(b) != A else 0
  * alldistinct(x)
  * branching with: branch(*this, x, INT_VAR_SIZE_MIN(), INT_VAL_MIN());

In my test I use A=200 and B=100.
The ILP CBC solver can even solve the problem with A=2000 and B=1000 like a
charm.
Note that the number of variables in the ILP model is much larger than in
the CP model.
I tried also to use Gecode with the ILP model but the performances are poor
too.

Why can't Gecode solve this simple problem? Did I make something wrong?
Are MILP solvers much better than CP ones for such optimization problems?
The entire code is given below.

Many thanks in advance!
Florent

#include <gecode/driver.hh>
#include <gecode/int.hh>
#include <gecode/minimodel.hh>

using namespace Gecode;

class Allocation : public MaximizeScript {
protected:
    static const int A = 200;
    static const int B = 100;
    IntVarArray x;
    IntVarArray y;
    IntVar total_reward;

public:
    Allocation(const SizeOptions& opt)
    : MaximizeScript(opt),
      x(*this, B, 0, A),
      y(*this, B, Int::Limits::min, Int::Limits::max),
      total_reward(*this, Int::Limits::min, Int::Limits::max) {
        IntArgs rewards((A+1)*B);
        double PI = std::acos(-1.0);
        for (unsigned int b = 0 ; b < B ; b++) {
            for (unsigned int a = 0 ; a < A ; a++) {
                rewards[a + b * (A+1)] =
static_cast<int>(std::floor(A*B*std::cos(2*PI*((double) a*b)/((double)
A*B))));
                if (rewards[a + b * (A+1)] < 0.0) {
                    rel(*this, x[b] != a);
                }
            }
            rewards[A*(b+1) + b] = 0.0;
        }

        IntSharedArray sc(rewards);
        for (unsigned int b = 0 ; b < B ; b++) {
            rel(*this, y[b] == element(sc, x[b] + b * (A+1)));
        }

        distinct(*this, x);

        rel(*this, total_reward == sum(y));

        branch(*this, x, INT_VAR_SIZE_MIN(), INT_VAL_MIN());
//      branch(*this, x, INT_VAR_DEGREE_MIN(), INT_VAL_MIN());
    }

    virtual void print(std::ostream& os) const {
        os << "total_reward: " << total_reward << std::endl;
        for(int b = 0; b < B; b++) {
            os << x[b] << " ";
        }
        os << std::endl;
    }

    virtual IntVar cost(void) const {
        return total_reward;
    }

    Allocation(bool share, Allocation& s)
    : MaximizeScript(share,s) {
        x.update(*this, share, s.x);
        y.update(*this, share, s.y);
        total_reward.update(*this, share, s.total_reward);
    }

    virtual Space* copy(bool share) {
        return new Allocation(share,*this);
    }

};

int main(int argc, char* argv[]) {
    SizeOptions opt("Allocation");
    opt.solutions(0);
    opt.iterations(20000);
    opt.parse(argc,argv);
    MaximizeScript::run<Allocation,BAB,SizeOptions>(opt);
    return 0;
}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160403/1db018c8/attachment.html>

From filip.konvicka at logis.cz  Sun Apr  3 22:16:35 2016
From: filip.konvicka at logis.cz (=?UTF-8?Q?Filip_Konvi=c4=8dka?=)
Date: Sun, 3 Apr 2016 22:16:35 +0200
Subject: [gecode-users] Freeze with MSVC 2015 optimized build
In-Reply-To: <ndrtf9$nmi$1@ger.gmane.org>
References: <ms91ji$t2s$1@ger.gmane.org>
	<000b01d0e627$0e3c24c0$2ab46e40$@kth.se> <ms939m$p0e$1@ger.gmane.org>
	<mteeso$vg0$1@ger.gmane.org> <00a001d0f14c$b10d1ee0$13275ca0$@kth.se>
	<mtefpa$f98$1@ger.gmane.org> <00be01d0f156$472d0a80$d5871f80$@kth.se>
	<mteklg$60h$1@ger.gmane.org> <00f201d0f15a$68174310$3845c930$@kth.se>
	<mtem3n$ur8$1@ger.gmane.org> <mten1j$f52$1@ger.gmane.org>
	<004201d0f1fb$dddb3380$99919a80$@kth.se> <mtgsg1$uaj$1@ger.gmane.org>
	<mulddl$hr5$1@ger.gmane.org> <046601d0ff63$ebf91840$c3eb48c0$@kth.se>
	<ndlq7v$408$1@ger.gmane.org> <008901d18cda$246e1b90$6d4a52b0$@kth.se>
	<ndoo75$h9n$1@ger.gmane.org> <ndrtf9$nmi$1@ger.gmane.org>
Message-ID: <ndrtn3$rer$1@ger.gmane.org>

Sorry...of course I forgot the attachment, here it is.
Filip

> Hi,
>
> I have updated to MSVC 2015 update 2, compiled the current Gecode trunk
> for x64, and my testcase from the beginning of this thread still freezes
> (the one from Sep 3rd 2015 - I have attached it to this mail for
> convenience).
>
> I also tried running Float::Arithmetic::Div::Sol::A and that test still
> fails.  For some reason 'make check' only runs a small subset of tests,
> so I ran this manually like this:
>
> $ test/test -test Float::Arithmetic::Div::Sol::A
> Float::Arithmetic::Div::Sol::A -
> Options: -seed 1 -test Float::Arithmetic::Div::Sol::A
>
> Another try failed with a different seed number:
> $ test/test -test Float::Arithmetic::Div
> Float::Arithmetic::Div::A +++++
> Float::Arithmetic::Div::B +++++
> Float::Arithmetic::Div::C +++++
> Float::Arithmetic::Div::Sol::A -
> Options: -seed 1975575111 -test Float::Arithmetic::Div::Sol::A
>
> Thanks,
> Filip
>
>> Christian,
>>
>> Thanks.  I was referring to this September & October thread - there were
>> issues with Gecode freezing on some FloatVar problems (my testcase and
>> your "Float::Arithmetic::Div::C") with MSVC 2015, and you said then that
>> it might be resolved by not using SSE2 (but that Guido would investigate
>> more).  We also identified a number of float tests that were failing on
>> GCC 5 (not with GCC 4.9).
>>
>> I can try re-running our tests here with the current trunk to see if
>> something changed - I just thought that I would ask directly whether you
>> did something specific to address these issues.  The failures seemed a
>> bit non-deterministic...
>>
>> Thanks,
>> Filip
>>
>>> MSVC2015 works for Gecode.4.4.0 since its initial release, I in fact
>>> uploaded packages to the Gecode website last week. Since last week
>>> (Mar 30)
>>> the update 2 to MSVC 2015 finally also compiles the trunk and the
>>> upcoming
>>> Gecode 5.0.0.
>>>
>>> Don't know about GCC, though.
>>>
>>> Cheers
>>> Christian
>>>
>>>
>>>
>>> --
>>> Christian Schulte, www.gecode.org/~schulte
>>> Professor of Computer Science, KTH,
>>> cschulte at kth.se
>>> Expert Researcher, SICS, cschulte at sics.se
>>>
>>> -----Original Message-----
>>> From: users-bounces at gecode.org
>>> [mailto:users-bounces at gecode.org] On Behalf
>>> Of Filip Konvicka
>>> Sent: Friday, April 1, 2016 14:41
>>> To: users at gecode.org
>>> Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build
>>>
>>> Hi Christian,
>>>
>>> Have you had any chance to look into supporting gcc 5 and MSVC 2015?
>>>
>>> Thanks,
>>> Filip
>>>
>>>> Hi Filip,
>>>>
>>>> Thanks for the information. This really looks like a gcc problem.
>>>> Guido, can you reproduce this behavior?
>>>>
>>>> Cheers
>>>> Christian
>>>>
>>>> --
>>>> Christian Schulte, www.gecode.org/~schulte Professor of Computer
>>>> Science, KTH, cschulte at kth.se Expert
>>>> Researcher, SICS,
>>>> cschulte at sics.se
>>>>
>>>> -----Original Message-----
>>>> From: users-bounces at gecode.org
>>>> [mailto:users-bounces at gecode.org] On
>>>> Behalf Of Filip Konvicka
>>>> Sent: Friday, October 2, 2015 09:58 AM
>>>> To: users at gecode.org
>>>> Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build
>>>>
>>>> Hi,
>>>>
>>>> We were looking a bit more into 4.4.0 on Linux where we've also hit
>>>> some issues.
>>>>
>>>> All tests worked fine with gcc 4.9.3.  However, with gcc 5.2.0 many
>>>> tests failed - see the attachements for details:
>>>>      gecode-4.4.0-gcc-5.2.0-failed_tests.list
>>>>      ... list of failed tests (except two memory fails below)
>>>>      gecode-4.4.0-gcc-5.2.0-failed_tests.log
>>>>      ... log from 'test' for failed tests
>>>>
>>>> Two tests ran out of memory (allocated several GBs of memory before
>>>> getting killed by system):
>>>>      Set::Branch::Sparse::3
>>>>      Set::Channel::Sorted
>>>>
>>>> gcc details:
>>>> target=x86_64-linux-gnu
>>>> GCC_VER=5.2.0
>>>> GMP_VER=6.0.0
>>>> MPFR_VER=3.1.3
>>>> MPC_VER=1.0.3
>>>> BINUTILS_VER=2.25
>>>>
>>>> It could also be a gcc bug of course, hard to tell.
>>>>
>>>> Thanks,
>>>> Filip
>>>>
>>>
>>>
>>>
>>> _______________________________________________
>>> Gecode users mailing list
>>> users at gecode.org
>>> https://www.gecode.org/mailman/listinfo/gecode-users
>>>

-------------- next part --------------
#pragma warning(push)
#pragma warning(disable : 4251 4355 4800)
#include <gecode/driver.hh>
#include <gecode/int.hh>
#include <gecode/minimodel.hh>
#pragma warning(pop)

//#include <gecode/gist.hh>

using namespace Gecode;

struct LayoutCalculator2 : public Space {
  double min_edge_width;
  double fit_to_width;

  IntVar      total_width;
  IntVar      scroll_area;

  IntVarArray start_times;
  IntVarArray widths;
  FloatVar    scaler;

  /// Constructor for cloning \a s
  LayoutCalculator2(bool share, LayoutCalculator2& s)
    : Space(share,s)
    , min_edge_width(s.min_edge_width)
    , fit_to_width(s.fit_to_width)
  {
    total_width.update(*this, share, s.total_width);
    scroll_area.update(*this, share, s.scroll_area);
    start_times.update(*this, share, s.start_times);
    widths.update(*this, share, s.widths);
    scaler.update(*this, share, s.scaler);
  }

  /// Copy during cloning
  virtual Space*
    copy(bool share) {
      return new LayoutCalculator2(share,*this);
  }

  /// Actual model
  LayoutCalculator2(double min_edge_width, double fit_to_width)
    : min_edge_width(min_edge_width)
    , fit_to_width(fit_to_width)
  {
    const int num_nodes = 2;
    total_width = IntVar(*this, 0, Gecode::Int::Limits::max);
    scroll_area = IntVar(*this, 0, Gecode::Int::Limits::max);
    start_times = IntVarArray(*this, num_nodes, 0, Gecode::Int::Limits::max);
    widths = IntVarArray(*this, num_nodes, 0, Gecode::Int::Limits::max);
    scaler = FloatVar(*this, 0, Gecode::Float::Limits::max);

    {
      FloatVar fl_width(*this, 0, Gecode::Float::Limits::max);
      rel(*this, max(FloatVal(228.),
                     8686.9666660000003
                     * scaler) <= fl_width);
      IntVar int_width(*this, 0, Gecode::Int::Limits::max);
      channel(*this, fl_width, int_width);
      rel(*this, int_width <= widths[0]);
    }
    {
      FloatVar fl_width(*this, 0, Gecode::Float::Limits::max);
      rel(*this, max(FloatVal(265.), 1. * scaler) <= fl_width);
      IntVar int_width(*this, 0, Gecode::Int::Limits::max);
      channel(*this, fl_width, int_width);
      rel(*this, int_width <= widths[0]);
      rel(*this, start_times[0] + widths[0] + (int)min_edge_width <= start_times[1]);
      rel(*this, start_times[1] + widths[1] <= total_width);
    }

    rel(*this, max(0, total_width - (int)fit_to_width) == scroll_area);

    // Minimize scroll area
    branch(*this, scroll_area, INT_VAL_MIN());
    // Maximize scaler
    //branch(*this, scaler, FLOAT_VAL_SPLIT_MAX());
    branch(*this, scaler, FLOAT_VAL_SPLIT_MAX());
    /*
    // Minimize total width (just assign)
    branch(*this, total_width, INT_VAL_MIN());
    // Maximize all start times (push right)
    branch(*this, start_times, INT_VAR_MAX_MIN(), INT_VAL_MAX());
    // Minimize widths
    branch(*this, widths, INT_VAR_MAX_MIN(), INT_VAL_SPLIT_MIN());
    */
  }
};


int main()
{
  LayoutCalculator2 init(50, 893);
  Gecode::Search::TimeStop t(1000);
  Gecode::Search::Options o;
  o.stop = &t;
  Gecode::dfs(&init, o);
  //Gist::dfs(&init);
  return 0;
}


From guido.tack at monash.edu  Mon Apr  4 06:55:40 2016
From: guido.tack at monash.edu (Guido Tack)
Date: Mon, 4 Apr 2016 14:55:40 +1000
Subject: [gecode-users] Poor performance on simple allocation problem:
	did I make something wrong?
In-Reply-To: <CAMW3hvPonBwmDMjXVDr3_D3YG6s0nqsHQJJ1=VyDwAk5vb2fiw@mail.gmail.com>
References: <CAMW3hvPonBwmDMjXVDr3_D3YG6s0nqsHQJJ1=VyDwAk5vb2fiw@mail.gmail.com>
Message-ID: <FA8B450C-BA8A-4F35-A963-0ED762DB678D@monash.edu>

Hi,

there?s nothing wrong with your model, it?s just that it falls into a subclass of problems (linear assignment problems) that is absolutely perfect for linear solvers and quite bad for CP solvers.  Unless you have other side constraints that would make it difficult for a linear or MIP solver to find feasible solutions, a MIP will always be many orders of magnitude faster than a CP solver on this problem class.

Cheers,
Guido

-- 
GUIDO TACK                  
Senior Lecturer

Information Technology
Monash University
Level 6, Room 6.40, Building H, Caulfield Campus
900 Dandenong Road
Caulfield East VIC 3145
Australia

T: +61 3 9903 1214                      
E: guido.tack at monash.edu <mailto:guido.tack at monash.edu>
http://www.csse.monash.edu/~guidot/ <http://www.csse.monash.edu/~guidot/>


> On 4 Apr 2016, at 6:18 AM, Florent Teichteil <florent.teichteil at gmail.com> wrote:
> 
> Hi all,
> 
> I am wondering if I use Gecode the right way since I get poor performances on a simple optimal allocation problem. The B&B search algorithm keeps improving the cost but without ever converging (even after several minutes) while the same problem is solved in less than 100ms with the CBC solver from COIN. I must say that I am more comfortable with operation research algorithms than with CP ones, so it is possible that I misuse Gecode.
> 
> The problem consists in assigning objects in A to objects in B so as to maximize the overall revenue.
> Allocations are optional, i.e. a given object in B does not need to have an assigned object from A if it decreases the overall revenue.
> By abusing the notation I represent A and B as positive integers and the corresponding object sets as {0,...,A-1} and {0,...,B-1}
> 
> ILP model:
>   * Decision variables: x(a,b) in {0,1} for each a in {0,...,A-1} and b in {0,...,B-1}
>   * R(a,b)=floor(A*B*cos(2*PI*a*b/A*B)) is the revenue of the allocation pair (a,b)
>   * max sum_{a in {0,...,A-1}, b in {0,...,B-1}} x(a,b) * R(a,b)
>   * for each a in {0,...,A-1}: sum(b in {0,...,B-1}) x(a,b) <= 1
>   * for each b in {0,...,B-1}: sum(a in {0,...,A-1}) x(a,b) <= 1
> 
> CP model:
>   * Decision variables:
>       - x(b) in {0,...,A} for each b in {0,...,B-1}; x(b)=A when no object from A is assigned to b
>       - y(b) = R(x(b),b) in {0,...} if x(b) != A else 0, for each b in {0,...,B-1}
>   * with R(a,b)=floor(A*B*cos(2*PI*a*b/A*B)) is the revenue of the allocation pair (a,b)
>   * max sum_{b in {0,...,B-1}} y(b)
>   * for each b in {0,...,B-1}: y(b) = floor(A*B*cos(2*PI*x(b)*b/A*B)) if x(b) != A else 0
>   * alldistinct(x)
>   * branching with: branch(*this, x, INT_VAR_SIZE_MIN(), INT_VAL_MIN());
> 
> In my test I use A=200 and B=100.
> The ILP CBC solver can even solve the problem with A=2000 and B=1000 like a charm.
> Note that the number of variables in the ILP model is much larger than in the CP model.
> I tried also to use Gecode with the ILP model but the performances are poor too.
> 
> Why can't Gecode solve this simple problem? Did I make something wrong?
> Are MILP solvers much better than CP ones for such optimization problems? 
> The entire code is given below.
> 
> Many thanks in advance!
> Florent
> 
> #include <gecode/driver.hh>
> #include <gecode/int.hh>
> #include <gecode/minimodel.hh>
> 
> using namespace Gecode;
> 
> class Allocation : public MaximizeScript {
> protected:
>     static const int A = 200; 
>     static const int B = 100;
>     IntVarArray x;
>     IntVarArray y;
>     IntVar total_reward;
> 
> public:
>     Allocation(const SizeOptions& opt)
>     : MaximizeScript(opt),
>       x(*this, B, 0, A),
>       y(*this, B, Int::Limits::min, Int::Limits::max),
>       total_reward(*this, Int::Limits::min, Int::Limits::max) {
>         IntArgs rewards((A+1)*B);
>         double PI = std::acos(-1.0);
>         for (unsigned int b = 0 ; b < B ; b++) {
>             for (unsigned int a = 0 ; a < A ; a++) {
>                 rewards[a + b * (A+1)] = static_cast<int>(std::floor(A*B*std::cos(2*PI*((double) a*b)/((double) A*B))));
>                 if (rewards[a + b * (A+1)] < 0.0) {
>                     rel(*this, x[b] != a);
>                 }
>             }
>             rewards[A*(b+1) + b] = 0.0;
>         }
> 
>         IntSharedArray sc(rewards);
>         for (unsigned int b = 0 ; b < B ; b++) {
>             rel(*this, y[b] == element(sc, x[b] + b * (A+1)));
>         }
> 
>         distinct(*this, x);
> 
>         rel(*this, total_reward == sum(y));
> 
>         branch(*this, x, INT_VAR_SIZE_MIN(), INT_VAL_MIN());
> //      branch(*this, x, INT_VAR_DEGREE_MIN(), INT_VAL_MIN());
>     }
> 
>     virtual void print(std::ostream& os) const {
>         os << "total_reward: " << total_reward << std::endl;
>         for(int b = 0; b < B; b++) {
>             os << x[b] << " ";
>         }
>         os << std::endl;
>     }
> 
>     virtual IntVar cost(void) const {
>         return total_reward;
>     }
> 
>     Allocation(bool share, Allocation& s)
>     : MaximizeScript(share,s) {
>         x.update(*this, share, s.x);
>         y.update(*this, share, s.y);
>         total_reward.update(*this, share, s.total_reward);
>     }
> 
>     virtual Space* copy(bool share) {
>         return new Allocation(share,*this);
>     }
> 
> };
> 
> int main(int argc, char* argv[]) {
>     SizeOptions opt("Allocation");
>     opt.solutions(0);
>     opt.iterations(20000);
>     opt.parse(argc,argv);
>     MaximizeScript::run<Allocation,BAB,SizeOptions>(opt);
>     return 0;
> }
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160404/788ff0e1/attachment.html>

From filip.konvicka at logis.cz  Mon Apr  4 09:14:52 2016
From: filip.konvicka at logis.cz (=?UTF-8?Q?Filip_Konvi=c4=8dka?=)
Date: Mon, 4 Apr 2016 09:14:52 +0200
Subject: [gecode-users] Freeze with MSVC 2015 optimized build
In-Reply-To: <ndrtf9$nmi$1@ger.gmane.org>
References: <ms91ji$t2s$1@ger.gmane.org>
	<000b01d0e627$0e3c24c0$2ab46e40$@kth.se> <ms939m$p0e$1@ger.gmane.org>
	<mteeso$vg0$1@ger.gmane.org> <00a001d0f14c$b10d1ee0$13275ca0$@kth.se>
	<mtefpa$f98$1@ger.gmane.org> <00be01d0f156$472d0a80$d5871f80$@kth.se>
	<mteklg$60h$1@ger.gmane.org> <00f201d0f15a$68174310$3845c930$@kth.se>
	<mtem3n$ur8$1@ger.gmane.org> <mten1j$f52$1@ger.gmane.org>
	<004201d0f1fb$dddb3380$99919a80$@kth.se> <mtgsg1$uaj$1@ger.gmane.org>
	<mulddl$hr5$1@ger.gmane.org> <046601d0ff63$ebf91840$c3eb48c0$@kth.se>
	<ndlq7v$408$1@ger.gmane.org> <008901d18cda$246e1b90$6d4a52b0$@kth.se>
	<ndoo75$h9n$1@ger.gmane.org> <ndrtf9$nmi$1@ger.gmane.org>
Message-ID: <ndt49c$g4f$1@ger.gmane.org>

Hi,

You said that you have uploaded packages recently; I assume that it was 
Gecode-4.4.0-x64-2015.msi.  I compiled and linked using this with MSVC 
2015 Update 2 and it also freezes on the testcase.  Replacing this with 
the MSVC 2013 package (Gecode-4.4.0-x64-2013.msi) works fine, even using 
the same toolset.

Cheers,
Filip

> Hi,
>
> I have updated to MSVC 2015 update 2, compiled the current Gecode trunk
> for x64, and my testcase from the beginning of this thread still freezes
> (the one from Sep 3rd 2015 - I have attached it to this mail for
> convenience).
>
> I also tried running Float::Arithmetic::Div::Sol::A and that test still
> fails.  For some reason 'make check' only runs a small subset of tests,
> so I ran this manually like this:
>
> $ test/test -test Float::Arithmetic::Div::Sol::A
> Float::Arithmetic::Div::Sol::A -
> Options: -seed 1 -test Float::Arithmetic::Div::Sol::A
>
> Another try failed with a different seed number:
> $ test/test -test Float::Arithmetic::Div
> Float::Arithmetic::Div::A +++++
> Float::Arithmetic::Div::B +++++
> Float::Arithmetic::Div::C +++++
> Float::Arithmetic::Div::Sol::A -
> Options: -seed 1975575111 -test Float::Arithmetic::Div::Sol::A
>
> Thanks,
> Filip
>
>> Christian,
>>
>> Thanks.  I was referring to this September & October thread - there were
>> issues with Gecode freezing on some FloatVar problems (my testcase and
>> your "Float::Arithmetic::Div::C") with MSVC 2015, and you said then that
>> it might be resolved by not using SSE2 (but that Guido would investigate
>> more).  We also identified a number of float tests that were failing on
>> GCC 5 (not with GCC 4.9).
>>
>> I can try re-running our tests here with the current trunk to see if
>> something changed - I just thought that I would ask directly whether you
>> did something specific to address these issues.  The failures seemed a
>> bit non-deterministic...
>>
>> Thanks,
>> Filip
>>
>>> MSVC2015 works for Gecode.4.4.0 since its initial release, I in fact
>>> uploaded packages to the Gecode website last week. Since last week
>>> (Mar 30)
>>> the update 2 to MSVC 2015 finally also compiles the trunk and the
>>> upcoming
>>> Gecode 5.0.0.
>>>
>>> Don't know about GCC, though.
>>>
>>> Cheers
>>> Christian
>>>
>>>
>>>
>>> --
>>> Christian Schulte, www.gecode.org/~schulte
>>> Professor of Computer Science, KTH,
>>> cschulte at kth.se
>>> Expert Researcher, SICS, cschulte at sics.se
>>>
>>> -----Original Message-----
>>> From: users-bounces at gecode.org
>>> [mailto:users-bounces at gecode.org] On Behalf
>>> Of Filip Konvicka
>>> Sent: Friday, April 1, 2016 14:41
>>> To: users at gecode.org
>>> Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build
>>>
>>> Hi Christian,
>>>
>>> Have you had any chance to look into supporting gcc 5 and MSVC 2015?
>>>
>>> Thanks,
>>> Filip
>>>
>>>> Hi Filip,
>>>>
>>>> Thanks for the information. This really looks like a gcc problem.
>>>> Guido, can you reproduce this behavior?
>>>>
>>>> Cheers
>>>> Christian
>>>>
>>>> --
>>>> Christian Schulte, www.gecode.org/~schulte Professor of Computer
>>>> Science, KTH, cschulte at kth.se Expert
>>>> Researcher, SICS,
>>>> cschulte at sics.se
>>>>
>>>> -----Original Message-----
>>>> From: users-bounces at gecode.org
>>>> [mailto:users-bounces at gecode.org] On
>>>> Behalf Of Filip Konvicka
>>>> Sent: Friday, October 2, 2015 09:58 AM
>>>> To: users at gecode.org
>>>> Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build
>>>>
>>>> Hi,
>>>>
>>>> We were looking a bit more into 4.4.0 on Linux where we've also hit
>>>> some issues.
>>>>
>>>> All tests worked fine with gcc 4.9.3.  However, with gcc 5.2.0 many
>>>> tests failed - see the attachements for details:
>>>>      gecode-4.4.0-gcc-5.2.0-failed_tests.list
>>>>      ... list of failed tests (except two memory fails below)
>>>>      gecode-4.4.0-gcc-5.2.0-failed_tests.log
>>>>      ... log from 'test' for failed tests
>>>>
>>>> Two tests ran out of memory (allocated several GBs of memory before
>>>> getting killed by system):
>>>>      Set::Branch::Sparse::3
>>>>      Set::Channel::Sorted
>>>>
>>>> gcc details:
>>>> target=x86_64-linux-gnu
>>>> GCC_VER=5.2.0
>>>> GMP_VER=6.0.0
>>>> MPFR_VER=3.1.3
>>>> MPC_VER=1.0.3
>>>> BINUTILS_VER=2.25
>>>>
>>>> It could also be a gcc bug of course, hard to tell.
>>>>
>>>> Thanks,
>>>> Filip
>>>>
>>>
>>>
>>>
>>> _______________________________________________
>>> Gecode users mailing list
>>> users at gecode.org
>>> https://www.gecode.org/mailman/listinfo/gecode-users
>>>




From cschulte at kth.se  Thu Apr  7 20:30:37 2016
From: cschulte at kth.se (Christian Schulte)
Date: Thu, 7 Apr 2016 20:30:37 +0200
Subject: [gecode-users] Freeze with MSVC 2015 optimized build
In-Reply-To: <ndt49c$g4f$1@ger.gmane.org>
References: <ms91ji$t2s$1@ger.gmane.org>	<000b01d0e627$0e3c24c0$2ab46e40$@kth.se>
	<ms939m$p0e$1@ger.gmane.org>	<mteeso$vg0$1@ger.gmane.org>
	<00a001d0f14c$b10d1ee0$13275ca0$@kth.se>	<mtefpa$f98$1@ger.gmane.org>
	<00be01d0f156$472d0a80$d5871f80$@kth.se>	<mteklg$60h$1@ger.gmane.org>
	<00f201d0f15a$68174310$3845c930$@kth.se>	<mtem3n$ur8$1@ger.gmane.org>
	<mten1j$f52$1@ger.gmane.org>	<004201d0f1fb$dddb3380$99919a80$@kth.se>
	<mtgsg1$uaj$1@ger.gmane.org>	<mulddl$hr5$1@ger.gmane.org>
	<046601d0ff63$ebf91840$c3eb48c0$@kth.se>	<ndlq7v$408$1@ger.gmane.org>
	<008901d18cda$246e1b90$6d4a52b0$@kth.se>	<ndoo75$h9n$1@ger.gmane.org>
	<ndrtf9$nmi$1@ger.gmane.org> <ndt49c$g4f$1@ger.gmane.org>
Message-ID: <004f01d190fb$95665e00$c0331a00$@kth.se>

Hi Filip,

Thanks for all the info and checking. I'll have a look a little later.

Best
Christian

--
Christian Schulte, www.gecode.org/~schulte 
Professor of Computer Science, KTH, cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se

-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Filip Konvicka
Sent: Monday, April 4, 2016 09:15
To: users at gecode.org
Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build

Hi,

You said that you have uploaded packages recently; I assume that it was
Gecode-4.4.0-x64-2015.msi.  I compiled and linked using this with MSVC
2015 Update 2 and it also freezes on the testcase.  Replacing this with the
MSVC 2013 package (Gecode-4.4.0-x64-2013.msi) works fine, even using the
same toolset.

Cheers,
Filip

> Hi,
>
> I have updated to MSVC 2015 update 2, compiled the current Gecode 
> trunk for x64, and my testcase from the beginning of this thread still 
> freezes (the one from Sep 3rd 2015 - I have attached it to this mail 
> for convenience).
>
> I also tried running Float::Arithmetic::Div::Sol::A and that test 
> still fails.  For some reason 'make check' only runs a small subset of 
> tests, so I ran this manually like this:
>
> $ test/test -test Float::Arithmetic::Div::Sol::A 
> Float::Arithmetic::Div::Sol::A -
> Options: -seed 1 -test Float::Arithmetic::Div::Sol::A
>
> Another try failed with a different seed number:
> $ test/test -test Float::Arithmetic::Div Float::Arithmetic::Div::A 
> +++++ Float::Arithmetic::Div::B +++++ Float::Arithmetic::Div::C +++++ 
> Float::Arithmetic::Div::Sol::A -
> Options: -seed 1975575111 -test Float::Arithmetic::Div::Sol::A
>
> Thanks,
> Filip
>
>> Christian,
>>
>> Thanks.  I was referring to this September & October thread - there 
>> were issues with Gecode freezing on some FloatVar problems (my 
>> testcase and your "Float::Arithmetic::Div::C") with MSVC 2015, and 
>> you said then that it might be resolved by not using SSE2 (but that 
>> Guido would investigate more).  We also identified a number of float 
>> tests that were failing on GCC 5 (not with GCC 4.9).
>>
>> I can try re-running our tests here with the current trunk to see if 
>> something changed - I just thought that I would ask directly whether 
>> you did something specific to address these issues.  The failures 
>> seemed a bit non-deterministic...
>>
>> Thanks,
>> Filip
>>
>>> MSVC2015 works for Gecode.4.4.0 since its initial release, I in fact 
>>> uploaded packages to the Gecode website last week. Since last week 
>>> (Mar 30) the update 2 to MSVC 2015 finally also compiles the trunk 
>>> and the upcoming Gecode 5.0.0.
>>>
>>> Don't know about GCC, though.
>>>
>>> Cheers
>>> Christian
>>>
>>>
>>>
>>> --
>>> Christian Schulte, www.gecode.org/~schulte Professor of Computer 
>>> Science, KTH, cschulte at kth.se Expert Researcher, SICS, 
>>> cschulte at sics.se
>>>
>>> -----Original Message-----
>>> From: users-bounces at gecode.org
>>> [mailto:users-bounces at gecode.org] On Behalf Of Filip Konvicka
>>> Sent: Friday, April 1, 2016 14:41
>>> To: users at gecode.org
>>> Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build
>>>
>>> Hi Christian,
>>>
>>> Have you had any chance to look into supporting gcc 5 and MSVC 2015?
>>>
>>> Thanks,
>>> Filip
>>>
>>>> Hi Filip,
>>>>
>>>> Thanks for the information. This really looks like a gcc problem.
>>>> Guido, can you reproduce this behavior?
>>>>
>>>> Cheers
>>>> Christian
>>>>
>>>> --
>>>> Christian Schulte, www.gecode.org/~schulte Professor of Computer 
>>>> Science, KTH, cschulte at kth.se Expert Researcher, SICS, 
>>>> cschulte at sics.se
>>>>
>>>> -----Original Message-----
>>>> From: users-bounces at gecode.org
>>>> [mailto:users-bounces at gecode.org] On Behalf Of Filip Konvicka
>>>> Sent: Friday, October 2, 2015 09:58 AM
>>>> To: users at gecode.org
>>>> Subject: Re: [gecode-users] Freeze with MSVC 2015 optimized build
>>>>
>>>> Hi,
>>>>
>>>> We were looking a bit more into 4.4.0 on Linux where we've also hit 
>>>> some issues.
>>>>
>>>> All tests worked fine with gcc 4.9.3.  However, with gcc 5.2.0 many 
>>>> tests failed - see the attachements for details:
>>>>      gecode-4.4.0-gcc-5.2.0-failed_tests.list
>>>>      ... list of failed tests (except two memory fails below)
>>>>      gecode-4.4.0-gcc-5.2.0-failed_tests.log
>>>>      ... log from 'test' for failed tests
>>>>
>>>> Two tests ran out of memory (allocated several GBs of memory before 
>>>> getting killed by system):
>>>>      Set::Branch::Sparse::3
>>>>      Set::Channel::Sorted
>>>>
>>>> gcc details:
>>>> target=x86_64-linux-gnu
>>>> GCC_VER=5.2.0
>>>> GMP_VER=6.0.0
>>>> MPFR_VER=3.1.3
>>>> MPC_VER=1.0.3
>>>> BINUTILS_VER=2.25
>>>>
>>>> It could also be a gcc bug of course, hard to tell.
>>>>
>>>> Thanks,
>>>> Filip
>>>>
>>>
>>>
>>>
>>> _______________________________________________
>>> Gecode users mailing list
>>> users at gecode.org
>>> https://www.gecode.org/mailman/listinfo/gecode-users
>>>



_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From conrad.drescher at sap.com  Fri Apr  8 14:23:38 2016
From: conrad.drescher at sap.com (Drescher, Conrad)
Date: Fri, 8 Apr 2016 12:23:38 +0000
Subject: [gecode-users] Smart pointer in propagator?
Message-ID: <474800fa36ea45e3b66fe0e255bd77a1@DEROTE13DE07.global.corp.sap>

Hi there,

we were thinking of storing a smart pointer in a propagator that is asking its home space to call its dispose()-method upon home space deletion. In the absence of a virtual destructor for class Propagator we're not sure it's a smart idea. Reading MPG 30.2 did not entirely clarify the situation - could you please elaborate?

Many thanks!
Conrad

Dr. Conrad Drescher
Senior Developer | AI DEV SCM PLM DE
SAP SE | Dietmar-Hopp-Allee 16 | 69190 Walldorf | Germany
T +49 6227 7-77888 | M +49 160 90684883 | E conrad.drescher at sap.com
www.sap.com<http://www.sap.com/>

Please consider the impact on the environment before printing this e-mail.


Pflichtangaben/Mandatory Disclosure Statements:
http://www.sap.com/company/legal/impressum.epx

Diese E-Mail kann Betriebs- oder Gesch?ftsgeheimnisse oder sonstige vertrauliche Informationen enthalten. Sollten Sie diese E-Mail irrt?mlich erhalten haben, ist Ihnen eine Kenntnisnahme des Inhalts, eine Vervielf?ltigung oder Weitergabe der E-Mail ausdr?cklich untersagt. Bitte benachrichtigen Sie uns und vernichten Sie die empfangene E-Mail. Vielen Dank.

This e-mail may contain trade secrets or privileged, undisclosed, or otherwise confidential information. If you have received this e-mail in error, you are hereby notified that any review, copying, or distribution of it is strictly prohibited. Please inform us immediately and destroy the original transmittal. Thank you for your cooperation.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160408/c2ca9937/attachment.html>

From cschulte at kth.se  Tue Apr 12 21:21:50 2016
From: cschulte at kth.se (Christian Schulte)
Date: Tue, 12 Apr 2016 21:21:50 +0200
Subject: [gecode-users] Smart pointer in propagator?
In-Reply-To: <474800fa36ea45e3b66fe0e255bd77a1@DEROTE13DE07.global.corp.sap>
References: <474800fa36ea45e3b66fe0e255bd77a1@DEROTE13DE07.global.corp.sap>
Message-ID: <018e01d194f0$912b2200$b3816600$@kth.se>

Hi Conrad,

There is a catch here: storing a smart pointer (or any other data structure
that has a destructor) in an object is okay, provided that:
1. You register the propagator so that its dispose() member function is
called when the propagator is deleted. But that you say you do.
2. You add an explicit call to the smart pointer?s destructor in the
propagator?s dispose() function, for example: if p is the smart pointer of
say type unique_ptr<T>, then add p.?unique_ptr<T>() to the dispose() member
function.

That should do the trick. Is this worth being added as a tip to MPG?

Cheers
Christian

--
Christian Schulte, http://www.gecode.org/~schulte
Professor of Computer Science, KTH, mailto:cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se

From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Drescher, Conrad
Sent: Friday, April 8, 2016 14:24
To: users at gecode.org
Subject: [gecode-users] Smart pointer in propagator?

Hi there,

we were thinking of storing a smart pointer in a propagator that is asking
its home space to call its dispose()-method upon home space deletion. In the
absence of a virtual destructor for class Propagator we?re not sure it?s a
smart idea. Reading MPG 30.2 did not entirely clarify the situation ? could
you please elaborate?

Many thanks!
Conrad

Dr. Conrad Drescher
Senior Developer | AI DEV SCM PLM DE
SAP SE | Dietmar-Hopp-Allee 16 | 69190 Walldorf | Germany
T +49 6227 7-77888 | M +49 160 90684883 | E mailto:conrad.drescher at sap.com
http://www.sap.com/

Please consider the impact on the environment before printing this e-mail.


Pflichtangaben/Mandatory Disclosure Statements: 
http://www.sap.com/company/legal/impressum.epx

Diese E-Mail kann Betriebs- oder Gesch?ftsgeheimnisse oder sonstige
vertrauliche Informationen enthalten. Sollten Sie diese E-Mail irrt?mlich
erhalten haben, ist Ihnen eine Kenntnisnahme des Inhalts, eine
Vervielf?ltigung oder Weitergabe der E-Mail ausdr?cklich untersagt. Bitte
benachrichtigen Sie uns und vernichten Sie die empfangene E-Mail. Vielen
Dank. 

This e-mail may contain trade secrets or privileged, undisclosed, or
otherwise confidential information. If you have received this e-mail in
error, you are hereby notified that any review, copying, or distribution of
it is strictly prohibited. Please inform us immediately and destroy the
original transmittal. Thank you for your cooperation.




From conrad.drescher at sap.com  Wed Apr 13 16:56:46 2016
From: conrad.drescher at sap.com (Drescher, Conrad)
Date: Wed, 13 Apr 2016 14:56:46 +0000
Subject: [gecode-users] Smart pointer in propagator?
In-Reply-To: <018e01d194f0$912b2200$b3816600$@kth.se>
References: <474800fa36ea45e3b66fe0e255bd77a1@DEROTE13DE07.global.corp.sap>
	<018e01d194f0$912b2200$b3816600$@kth.se>
Message-ID: <29c92dc8ee94452a97dee7ed4aa210a4@DEROTE13DE07.global.corp.sap>

Hi Christian,

and many thanks for confirming we're not completely off the track.

We have a propagator that has a shared_ptr member. We follow your basic guidelines and in the propagator dispose function we reset the shared pointer (decreasing the reference count). On Linux with gcc 4.8 that compiles fine and behaves as expected. On Windows with Visual Studio 2015 we get a warning: 

warning C4265: 'Less': class has virtual functions, but destructor is not virtual
           instances of this class may not be destructed correctly

(and we're living in a "warning-as-errors"-environment).

Would you happen to have some advice on that issue, too?

Many thanks!
Conrad

The example below can be used to reproduce the behavior on Windows (it extends the na?ve Less-constraint from MPG with an otherwise useless shared pointer).

#include <memory>
#include <iostream>
#include <gecode/driver.hh>
#include <gecode/int.hh>
#include <gecode/minimodel.hh>
#include <gecode/search.hh>
#include <gecode/kernel.hh>
#include <gecode/support.hh>

using namespace Gecode;

class TestObj{
private:
	int i;
public:
	TestObj(int i1) : i(i1) {
		std::cout << "Constructed" << std::endl;
	}
	~TestObj(){
		std::cout << "Destroyed" << std::endl;
	}
};

class Less : public Propagator {
protected:
	Int::IntView x0, x1;
	std::shared_ptr<TestObj> p;
public:
	// posting
	Less(Space& home, Int::IntView y0, Int::IntView y1, std::shared_ptr<TestObj> p1) : Propagator(home), x0(y0), x1(y1) {
		x0.subscribe(home,*this,Int::PC_INT_DOM);
		x1.subscribe(home,*this,Int::PC_INT_DOM);
		p = p1;
        home.notice(*this, AP_DISPOSE);
	}
	static ExecStatus post(Space& home, Int::IntView x0, Int::IntView x1, std::shared_ptr<TestObj> p) {
		(void) new (home) Less(home,x0,x1,p); return ES_OK;
	}
	// disposal
	virtual size_t dispose(Space& home) {
		x0.cancel(home,*this,Int::PC_INT_DOM);
		x1.cancel(home,*this,Int::PC_INT_DOM);
		p.reset();
		//p.~shared_ptr<TestObj>();
		(void) Propagator::dispose(home);
		home.ignore(*this,AP_DISPOSE);
		return sizeof(*this);
	}
	// copying
	Less(Space& home, bool share, Less& prop) : Propagator(home,share,prop), p(prop.p) {
		x0.update(home,share,prop.x0);
		x1.update(home,share,prop.x1);
	}
	virtual Propagator* copy(Space& home, bool share) {
		return new (home) Less(home,share,*this);
	}
	// cost computation
	virtual PropCost cost(const Space&, const ModEventDelta&) const {
		return PropCost::binary(PropCost::LO);
	}
	// propagation
	virtual ExecStatus propagate(Space& home, const ModEventDelta&) {
		if (x0.le(home,x1.max()) == Int::ME_INT_FAILED)
			return ES_FAILED;
		if (x1.gr(home,x0.min()) == Int::ME_INT_FAILED)
			return ES_FAILED;
		if (x0.assigned() && x1.assigned())
			return home.ES_SUBSUMED(*this);
		else return ES_NOFIX;
	}
};

void less(Space& home, IntVar x0, IntVar x1, std::shared_ptr<TestObj> p) { // constraint post function
	Int::IntView y0(x0), y1(x1);
	if (Less::post(home,y0,y1,p) != ES_OK) home.fail();

}

class ExampleSpace : public Script {
protected:
  /// Arrays of ints
  IntVarArray intvars;
public:
  /// Actual model

  ExampleSpace(const Options& opt) : Script(opt), intvars(*this,2,0,10) {
     std::shared_ptr<TestObj> p = std::make_shared<TestObj>(1);
	 less(*this,intvars[0],intvars[1],p);
	 branch(*this, intvars, INT_VAR_SIZE_MIN(), INT_VAL_MIN() );
  }
  /// Print solution
  virtual void
  print(std::ostream& os) const {
    os << "\t" << intvars << std::endl;
  }

  /// Constructor for cloning \a s
  ExampleSpace(bool share, ExampleSpace& s) : Script(share,s) {
    intvars.update(*this, share, s.intvars);
  }
  /// Copy during cloning
  virtual Space*
  copy(bool share) {
    return new ExampleSpace(true,*this);
  }
};

int
main(int argc, char* argv[]) {
  Options opt("ExampleSpace");
  opt.parse(argc,argv);
  Script::run<ExampleSpace,DFS,Options>(opt);
  return 0;
}

-----Original Message-----
From: Christian Schulte [mailto:cschulte at kth.se] 
Sent: Dienstag, 12. April 2016 21:22
To: Drescher, Conrad <conrad.drescher at sap.com>; users at gecode.org
Subject: RE: [gecode-users] Smart pointer in propagator?

Hi Conrad,

There is a catch here: storing a smart pointer (or any other data structure
that has a destructor) in an object is okay, provided that:
1. You register the propagator so that its dispose() member function is
called when the propagator is deleted. But that you say you do.
2. You add an explicit call to the smart pointer's destructor in the
propagator's dispose() function, for example: if p is the smart pointer of
say type unique_ptr<T>, then add p.?unique_ptr<T>() to the dispose() member
function.

That should do the trick. Is this worth being added as a tip to MPG?

Cheers
Christian

--
Christian Schulte, http://www.gecode.org/~schulte
Professor of Computer Science, KTH, mailto:cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se

From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Drescher, Conrad
Sent: Friday, April 8, 2016 14:24
To: users at gecode.org
Subject: [gecode-users] Smart pointer in propagator?

Hi there,

we were thinking of storing a smart pointer in a propagator that is asking
its home space to call its dispose()-method upon home space deletion. In the
absence of a virtual destructor for class Propagator we're not sure it's a
smart idea. Reading MPG 30.2 did not entirely clarify the situation - could
you please elaborate?

Many thanks!
Conrad

Dr. Conrad Drescher
Senior Developer | AI DEV SCM PLM DE
SAP SE | Dietmar-Hopp-Allee 16 | 69190 Walldorf | Germany
T +49 6227 7-77888 | M +49 160 90684883 | E mailto:conrad.drescher at sap.com
http://www.sap.com/

Please consider the impact on the environment before printing this e-mail.


Pflichtangaben/Mandatory Disclosure Statements: 
http://www.sap.com/company/legal/impressum.epx

Diese E-Mail kann Betriebs- oder Gesch?ftsgeheimnisse oder sonstige
vertrauliche Informationen enthalten. Sollten Sie diese E-Mail irrt?mlich
erhalten haben, ist Ihnen eine Kenntnisnahme des Inhalts, eine
Vervielf?ltigung oder Weitergabe der E-Mail ausdr?cklich untersagt. Bitte
benachrichtigen Sie uns und vernichten Sie die empfangene E-Mail. Vielen
Dank. 

This e-mail may contain trade secrets or privileged, undisclosed, or
otherwise confidential information. If you have received this e-mail in
error, you are hereby notified that any review, copying, or distribution of
it is strictly prohibited. Please inform us immediately and destroy the
original transmittal. Thank you for your cooperation.




From cschulte at kth.se  Wed Apr 13 20:57:41 2016
From: cschulte at kth.se (Christian Schulte)
Date: Wed, 13 Apr 2016 20:57:41 +0200
Subject: [gecode-users] Smart pointer in propagator?
In-Reply-To: <29c92dc8ee94452a97dee7ed4aa210a4@DEROTE13DE07.global.corp.sap>
References: <474800fa36ea45e3b66fe0e255bd77a1@DEROTE13DE07.global.corp.sap>
	<018e01d194f0$912b2200$b3816600$@kth.se>
	<29c92dc8ee94452a97dee7ed4aa210a4@DEROTE13DE07.global.corp.sap>
Message-ID: <00b301d195b6$5c126170$14372450$@kth.se>

Hi Conrad,

That's easy: you do not define a destructor, that's why you get a warning:
 - The class Propagator has a virtual destructor just to avoid warnings.
 - Just define a destructor and the warning goes away.

I guess it comes from the fact that your Less class has a member which
itself has a destructor.

I'd rather ignore it but if you do like warnings at least add an
assert(false) to the destructor!

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte
Professor of Computer Science, KTH, cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se

-----Original Message-----
From: Drescher, Conrad [mailto:conrad.drescher at sap.com] 
Sent: Wednesday, April 13, 2016 16:57
To: Schulte, Christian <cschulte at kth.se>; users at gecode.org
Subject: RE: [gecode-users] Smart pointer in propagator?

Hi Christian,

and many thanks for confirming we're not completely off the track.

We have a propagator that has a shared_ptr member. We follow your basic
guidelines and in the propagator dispose function we reset the shared
pointer (decreasing the reference count). On Linux with gcc 4.8 that
compiles fine and behaves as expected. On Windows with Visual Studio 2015 we
get a warning: 

warning C4265: 'Less': class has virtual functions, but destructor is not
virtual
           instances of this class may not be destructed correctly

(and we're living in a "warning-as-errors"-environment).

Would you happen to have some advice on that issue, too?

Many thanks!
Conrad

The example below can be used to reproduce the behavior on Windows (it
extends the na?ve Less-constraint from MPG with an otherwise useless shared
pointer).

#include <memory>
#include <iostream>
#include <gecode/driver.hh>
#include <gecode/int.hh>
#include <gecode/minimodel.hh>
#include <gecode/search.hh>
#include <gecode/kernel.hh>
#include <gecode/support.hh>

using namespace Gecode;

class TestObj{
private:
	int i;
public:
	TestObj(int i1) : i(i1) {
		std::cout << "Constructed" << std::endl;
	}
	~TestObj(){
		std::cout << "Destroyed" << std::endl;
	}
};

class Less : public Propagator {
protected:
	Int::IntView x0, x1;
	std::shared_ptr<TestObj> p;
public:
	// posting
	Less(Space& home, Int::IntView y0, Int::IntView y1,
std::shared_ptr<TestObj> p1) : Propagator(home), x0(y0), x1(y1) {
		x0.subscribe(home,*this,Int::PC_INT_DOM);
		x1.subscribe(home,*this,Int::PC_INT_DOM);
		p = p1;
        home.notice(*this, AP_DISPOSE);
	}
	static ExecStatus post(Space& home, Int::IntView x0, Int::IntView
x1, std::shared_ptr<TestObj> p) {
		(void) new (home) Less(home,x0,x1,p); return ES_OK;
	}
	// disposal
	virtual size_t dispose(Space& home) {
		x0.cancel(home,*this,Int::PC_INT_DOM);
		x1.cancel(home,*this,Int::PC_INT_DOM);
		p.reset();
		//p.~shared_ptr<TestObj>();
		(void) Propagator::dispose(home);
		home.ignore(*this,AP_DISPOSE);
		return sizeof(*this);
	}
	// copying
	Less(Space& home, bool share, Less& prop) :
Propagator(home,share,prop), p(prop.p) {
		x0.update(home,share,prop.x0);
		x1.update(home,share,prop.x1);
	}
	virtual Propagator* copy(Space& home, bool share) {
		return new (home) Less(home,share,*this);
	}
	// cost computation
	virtual PropCost cost(const Space&, const ModEventDelta&) const {
		return PropCost::binary(PropCost::LO);
	}
	// propagation
	virtual ExecStatus propagate(Space& home, const ModEventDelta&) {
		if (x0.le(home,x1.max()) == Int::ME_INT_FAILED)
			return ES_FAILED;
		if (x1.gr(home,x0.min()) == Int::ME_INT_FAILED)
			return ES_FAILED;
		if (x0.assigned() && x1.assigned())
			return home.ES_SUBSUMED(*this);
		else return ES_NOFIX;
	}
};

void less(Space& home, IntVar x0, IntVar x1, std::shared_ptr<TestObj> p) {
// constraint post function
	Int::IntView y0(x0), y1(x1);
	if (Less::post(home,y0,y1,p) != ES_OK) home.fail();

}

class ExampleSpace : public Script {
protected:
  /// Arrays of ints
  IntVarArray intvars;
public:
  /// Actual model

  ExampleSpace(const Options& opt) : Script(opt), intvars(*this,2,0,10) {
     std::shared_ptr<TestObj> p = std::make_shared<TestObj>(1);
	 less(*this,intvars[0],intvars[1],p);
	 branch(*this, intvars, INT_VAR_SIZE_MIN(), INT_VAL_MIN() );
  }
  /// Print solution
  virtual void
  print(std::ostream& os) const {
    os << "\t" << intvars << std::endl;
  }

  /// Constructor for cloning \a s
  ExampleSpace(bool share, ExampleSpace& s) : Script(share,s) {
    intvars.update(*this, share, s.intvars);
  }
  /// Copy during cloning
  virtual Space*
  copy(bool share) {
    return new ExampleSpace(true,*this);
  }
};

int
main(int argc, char* argv[]) {
  Options opt("ExampleSpace");
  opt.parse(argc,argv);
  Script::run<ExampleSpace,DFS,Options>(opt);
  return 0;
}

-----Original Message-----
From: Christian Schulte [mailto:cschulte at kth.se]
Sent: Dienstag, 12. April 2016 21:22
To: Drescher, Conrad <conrad.drescher at sap.com>; users at gecode.org
Subject: RE: [gecode-users] Smart pointer in propagator?

Hi Conrad,

There is a catch here: storing a smart pointer (or any other data structure
that has a destructor) in an object is okay, provided that:
1. You register the propagator so that its dispose() member function is
called when the propagator is deleted. But that you say you do.
2. You add an explicit call to the smart pointer's destructor in the
propagator's dispose() function, for example: if p is the smart pointer of
say type unique_ptr<T>, then add p.?unique_ptr<T>() to the dispose() member
function.

That should do the trick. Is this worth being added as a tip to MPG?

Cheers
Christian

--
Christian Schulte, http://www.gecode.org/~schulte Professor of Computer
Science, KTH, mailto:cschulte at kth.se Expert Researcher, SICS,
cschulte at sics.se

From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Drescher, Conrad
Sent: Friday, April 8, 2016 14:24
To: users at gecode.org
Subject: [gecode-users] Smart pointer in propagator?

Hi there,

we were thinking of storing a smart pointer in a propagator that is asking
its home space to call its dispose()-method upon home space deletion. In the
absence of a virtual destructor for class Propagator we're not sure it's a
smart idea. Reading MPG 30.2 did not entirely clarify the situation - could
you please elaborate?

Many thanks!
Conrad

Dr. Conrad Drescher
Senior Developer | AI DEV SCM PLM DE
SAP SE | Dietmar-Hopp-Allee 16 | 69190 Walldorf | Germany T +49 6227 7-77888
| M +49 160 90684883 | E mailto:conrad.drescher at sap.com http://www.sap.com/

Please consider the impact on the environment before printing this e-mail.


Pflichtangaben/Mandatory Disclosure Statements: 
http://www.sap.com/company/legal/impressum.epx

Diese E-Mail kann Betriebs- oder Gesch?ftsgeheimnisse oder sonstige
vertrauliche Informationen enthalten. Sollten Sie diese E-Mail irrt?mlich
erhalten haben, ist Ihnen eine Kenntnisnahme des Inhalts, eine
Vervielf?ltigung oder Weitergabe der E-Mail ausdr?cklich untersagt. Bitte
benachrichtigen Sie uns und vernichten Sie die empfangene E-Mail. Vielen
Dank. 

This e-mail may contain trade secrets or privileged, undisclosed, or
otherwise confidential information. If you have received this e-mail in
error, you are hereby notified that any review, copying, or distribution of
it is strictly prohibited. Please inform us immediately and destroy the
original transmittal. Thank you for your cooperation.


-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4599 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20160413/3916da9a/attachment.bin>

From conrad.drescher at sap.com  Thu Apr 14 15:57:43 2016
From: conrad.drescher at sap.com (Drescher, Conrad)
Date: Thu, 14 Apr 2016 13:57:43 +0000
Subject: [gecode-users] Smart pointer in propagator?
In-Reply-To: <00b301d195b6$5c126170$14372450$@kth.se>
References: <474800fa36ea45e3b66fe0e255bd77a1@DEROTE13DE07.global.corp.sap>
	<018e01d194f0$912b2200$b3816600$@kth.se>
	<29c92dc8ee94452a97dee7ed4aa210a4@DEROTE13DE07.global.corp.sap>
	<00b301d195b6$5c126170$14372450$@kth.se>
Message-ID: <4f1c429012b54318b6e2029772f0e7ba@DEROTE13DE07.global.corp.sap>

Hi Christian,

and thanks again. I think I found something: It seems whether class Propagator has a virtual destructor depends on the compiler. In class Actor in core.hpp it says:

#ifndef __GNUC__
    /// Not used (uses dispose instead)
    static void  operator delete(void* p);
#endif
    /// Not used
    static void* operator new(size_t s);
    //@}
#ifdef __GNUC__
  public:
    /// To avoid warnings from GCC
    GECODE_KERNEL_EXPORT virtual ~Actor(void);
    /// Not used (uses dispose instead)
    static void  operator delete(void* p);
#endif

Do you think we could get the same on Windows without causing any harm?

Best wishes,
Conrad


-----Original Message-----
From: Christian Schulte [mailto:cschulte at kth.se] 
Sent: Mittwoch, 13. April 2016 20:58
To: Drescher, Conrad <conrad.drescher at sap.com>; users at gecode.org
Subject: RE: [gecode-users] Smart pointer in propagator?

* PGP - S/MIME Signed by an unverified key: 13.04.2016 at 20:57:41

Hi Conrad,

That's easy: you do not define a destructor, that's why you get a warning:
 - The class Propagator has a virtual destructor just to avoid warnings.
 - Just define a destructor and the warning goes away.

I guess it comes from the fact that your Less class has a member which
itself has a destructor.

I'd rather ignore it but if you do like warnings at least add an
assert(false) to the destructor!

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte
Professor of Computer Science, KTH, cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se

-----Original Message-----
From: Drescher, Conrad [mailto:conrad.drescher at sap.com] 
Sent: Wednesday, April 13, 2016 16:57
To: Schulte, Christian <cschulte at kth.se>; users at gecode.org
Subject: RE: [gecode-users] Smart pointer in propagator?

Hi Christian,

and many thanks for confirming we're not completely off the track.

We have a propagator that has a shared_ptr member. We follow your basic
guidelines and in the propagator dispose function we reset the shared
pointer (decreasing the reference count). On Linux with gcc 4.8 that
compiles fine and behaves as expected. On Windows with Visual Studio 2015 we
get a warning: 

warning C4265: 'Less': class has virtual functions, but destructor is not
virtual
           instances of this class may not be destructed correctly

(and we're living in a "warning-as-errors"-environment).

Would you happen to have some advice on that issue, too?

Many thanks!
Conrad

The example below can be used to reproduce the behavior on Windows (it
extends the na?ve Less-constraint from MPG with an otherwise useless shared
pointer).

#include <memory>
#include <iostream>
#include <gecode/driver.hh>
#include <gecode/int.hh>
#include <gecode/minimodel.hh>
#include <gecode/search.hh>
#include <gecode/kernel.hh>
#include <gecode/support.hh>

using namespace Gecode;

class TestObj{
private:
	int i;
public:
	TestObj(int i1) : i(i1) {
		std::cout << "Constructed" << std::endl;
	}
	~TestObj(){
		std::cout << "Destroyed" << std::endl;
	}
};

class Less : public Propagator {
protected:
	Int::IntView x0, x1;
	std::shared_ptr<TestObj> p;
public:
	// posting
	Less(Space& home, Int::IntView y0, Int::IntView y1,
std::shared_ptr<TestObj> p1) : Propagator(home), x0(y0), x1(y1) {
		x0.subscribe(home,*this,Int::PC_INT_DOM);
		x1.subscribe(home,*this,Int::PC_INT_DOM);
		p = p1;
        home.notice(*this, AP_DISPOSE);
	}
	static ExecStatus post(Space& home, Int::IntView x0, Int::IntView
x1, std::shared_ptr<TestObj> p) {
		(void) new (home) Less(home,x0,x1,p); return ES_OK;
	}
	// disposal
	virtual size_t dispose(Space& home) {
		x0.cancel(home,*this,Int::PC_INT_DOM);
		x1.cancel(home,*this,Int::PC_INT_DOM);
		p.reset();
		//p.~shared_ptr<TestObj>();
		(void) Propagator::dispose(home);
		home.ignore(*this,AP_DISPOSE);
		return sizeof(*this);
	}
	// copying
	Less(Space& home, bool share, Less& prop) :
Propagator(home,share,prop), p(prop.p) {
		x0.update(home,share,prop.x0);
		x1.update(home,share,prop.x1);
	}
	virtual Propagator* copy(Space& home, bool share) {
		return new (home) Less(home,share,*this);
	}
	// cost computation
	virtual PropCost cost(const Space&, const ModEventDelta&) const {
		return PropCost::binary(PropCost::LO);
	}
	// propagation
	virtual ExecStatus propagate(Space& home, const ModEventDelta&) {
		if (x0.le(home,x1.max()) == Int::ME_INT_FAILED)
			return ES_FAILED;
		if (x1.gr(home,x0.min()) == Int::ME_INT_FAILED)
			return ES_FAILED;
		if (x0.assigned() && x1.assigned())
			return home.ES_SUBSUMED(*this);
		else return ES_NOFIX;
	}
};

void less(Space& home, IntVar x0, IntVar x1, std::shared_ptr<TestObj> p) {
// constraint post function
	Int::IntView y0(x0), y1(x1);
	if (Less::post(home,y0,y1,p) != ES_OK) home.fail();

}

class ExampleSpace : public Script {
protected:
  /// Arrays of ints
  IntVarArray intvars;
public:
  /// Actual model

  ExampleSpace(const Options& opt) : Script(opt), intvars(*this,2,0,10) {
     std::shared_ptr<TestObj> p = std::make_shared<TestObj>(1);
	 less(*this,intvars[0],intvars[1],p);
	 branch(*this, intvars, INT_VAR_SIZE_MIN(), INT_VAL_MIN() );
  }
  /// Print solution
  virtual void
  print(std::ostream& os) const {
    os << "\t" << intvars << std::endl;
  }

  /// Constructor for cloning \a s
  ExampleSpace(bool share, ExampleSpace& s) : Script(share,s) {
    intvars.update(*this, share, s.intvars);
  }
  /// Copy during cloning
  virtual Space*
  copy(bool share) {
    return new ExampleSpace(true,*this);
  }
};

int
main(int argc, char* argv[]) {
  Options opt("ExampleSpace");
  opt.parse(argc,argv);
  Script::run<ExampleSpace,DFS,Options>(opt);
  return 0;
}

-----Original Message-----
From: Christian Schulte [mailto:cschulte at kth.se]
Sent: Dienstag, 12. April 2016 21:22
To: Drescher, Conrad <conrad.drescher at sap.com>; users at gecode.org
Subject: RE: [gecode-users] Smart pointer in propagator?

Hi Conrad,

There is a catch here: storing a smart pointer (or any other data structure
that has a destructor) in an object is okay, provided that:
1. You register the propagator so that its dispose() member function is
called when the propagator is deleted. But that you say you do.
2. You add an explicit call to the smart pointer's destructor in the
propagator's dispose() function, for example: if p is the smart pointer of
say type unique_ptr<T>, then add p.?unique_ptr<T>() to the dispose() member
function.

That should do the trick. Is this worth being added as a tip to MPG?

Cheers
Christian

--
Christian Schulte, http://www.gecode.org/~schulte Professor of Computer
Science, KTH, mailto:cschulte at kth.se Expert Researcher, SICS,
cschulte at sics.se

From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Drescher, Conrad
Sent: Friday, April 8, 2016 14:24
To: users at gecode.org
Subject: [gecode-users] Smart pointer in propagator?

Hi there,

we were thinking of storing a smart pointer in a propagator that is asking
its home space to call its dispose()-method upon home space deletion. In the
absence of a virtual destructor for class Propagator we're not sure it's a
smart idea. Reading MPG 30.2 did not entirely clarify the situation - could
you please elaborate?

Many thanks!
Conrad

Dr. Conrad Drescher
Senior Developer | AI DEV SCM PLM DE
SAP SE | Dietmar-Hopp-Allee 16 | 69190 Walldorf | Germany T +49 6227 7-77888
| M +49 160 90684883 | E mailto:conrad.drescher at sap.com http://www.sap.com/

Please consider the impact on the environment before printing this e-mail.


Pflichtangaben/Mandatory Disclosure Statements: 
http://www.sap.com/company/legal/impressum.epx

Diese E-Mail kann Betriebs- oder Gesch?ftsgeheimnisse oder sonstige
vertrauliche Informationen enthalten. Sollten Sie diese E-Mail irrt?mlich
erhalten haben, ist Ihnen eine Kenntnisnahme des Inhalts, eine
Vervielf?ltigung oder Weitergabe der E-Mail ausdr?cklich untersagt. Bitte
benachrichtigen Sie uns und vernichten Sie die empfangene E-Mail. Vielen
Dank. 

This e-mail may contain trade secrets or privileged, undisclosed, or
otherwise confidential information. If you have received this e-mail in
error, you are hereby notified that any review, copying, or distribution of
it is strictly prohibited. Please inform us immediately and destroy the
original transmittal. Thank you for your cooperation.



* Christian Schulte <cschulte at kth.se>
* Issuer: TERENA - Unverified


From cschulte at kth.se  Thu Apr 14 21:11:51 2016
From: cschulte at kth.se (Christian Schulte)
Date: Thu, 14 Apr 2016 21:11:51 +0200
Subject: [gecode-users] Smart pointer in propagator?
In-Reply-To: <4f1c429012b54318b6e2029772f0e7ba@DEROTE13DE07.global.corp.sap>
References: <474800fa36ea45e3b66fe0e255bd77a1@DEROTE13DE07.global.corp.sap>
	<018e01d194f0$912b2200$b3816600$@kth.se>
	<29c92dc8ee94452a97dee7ed4aa210a4@DEROTE13DE07.global.corp.sap>
	<00b301d195b6$5c126170$14372450$@kth.se>
	<4f1c429012b54318b6e2029772f0e7ba@DEROTE13DE07.global.corp.sap>
Message-ID: <002901d19681$80de3990$829aacb0$@kth.se>

Hi Conrad,

I actually did that already yesterday when I added the destructor for NGL.

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte
Professor of Computer Science, KTH, cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se

-----Original Message-----
From: Drescher, Conrad [mailto:conrad.drescher at sap.com] 
Sent: Thursday, April 14, 2016 15:58
To: cschulte at kth.se; users at gecode.org
Subject: RE: [gecode-users] Smart pointer in propagator?

Hi Christian,

and thanks again. I think I found something: It seems whether class
Propagator has a virtual destructor depends on the compiler. In class Actor
in core.hpp it says:

#ifndef __GNUC__
    /// Not used (uses dispose instead)
    static void  operator delete(void* p); #endif
    /// Not used
    static void* operator new(size_t s);
    //@}
#ifdef __GNUC__
  public:
    /// To avoid warnings from GCC
    GECODE_KERNEL_EXPORT virtual ~Actor(void);
    /// Not used (uses dispose instead)
    static void  operator delete(void* p); #endif

Do you think we could get the same on Windows without causing any harm?

Best wishes,
Conrad


-----Original Message-----
From: Christian Schulte [mailto:cschulte at kth.se]
Sent: Mittwoch, 13. April 2016 20:58
To: Drescher, Conrad <conrad.drescher at sap.com>; users at gecode.org
Subject: RE: [gecode-users] Smart pointer in propagator?

* PGP - S/MIME Signed by an unverified key: 13.04.2016 at 20:57:41

Hi Conrad,

That's easy: you do not define a destructor, that's why you get a warning:
 - The class Propagator has a virtual destructor just to avoid warnings.
 - Just define a destructor and the warning goes away.

I guess it comes from the fact that your Less class has a member which
itself has a destructor.

I'd rather ignore it but if you do like warnings at least add an
assert(false) to the destructor!

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte Professor of Computer Science,
KTH, cschulte at kth.se Expert Researcher, SICS, cschulte at sics.se

-----Original Message-----
From: Drescher, Conrad [mailto:conrad.drescher at sap.com]
Sent: Wednesday, April 13, 2016 16:57
To: Schulte, Christian <cschulte at kth.se>; users at gecode.org
Subject: RE: [gecode-users] Smart pointer in propagator?

Hi Christian,

and many thanks for confirming we're not completely off the track.

We have a propagator that has a shared_ptr member. We follow your basic
guidelines and in the propagator dispose function we reset the shared
pointer (decreasing the reference count). On Linux with gcc 4.8 that
compiles fine and behaves as expected. On Windows with Visual Studio 2015 we
get a warning: 

warning C4265: 'Less': class has virtual functions, but destructor is not
virtual
           instances of this class may not be destructed correctly

(and we're living in a "warning-as-errors"-environment).

Would you happen to have some advice on that issue, too?

Many thanks!
Conrad

The example below can be used to reproduce the behavior on Windows (it
extends the na?ve Less-constraint from MPG with an otherwise useless shared
pointer).

#include <memory>
#include <iostream>
#include <gecode/driver.hh>
#include <gecode/int.hh>
#include <gecode/minimodel.hh>
#include <gecode/search.hh>
#include <gecode/kernel.hh>
#include <gecode/support.hh>

using namespace Gecode;

class TestObj{
private:
	int i;
public:
	TestObj(int i1) : i(i1) {
		std::cout << "Constructed" << std::endl;
	}
	~TestObj(){
		std::cout << "Destroyed" << std::endl;
	}
};

class Less : public Propagator {
protected:
	Int::IntView x0, x1;
	std::shared_ptr<TestObj> p;
public:
	// posting
	Less(Space& home, Int::IntView y0, Int::IntView y1,
std::shared_ptr<TestObj> p1) : Propagator(home), x0(y0), x1(y1) {
		x0.subscribe(home,*this,Int::PC_INT_DOM);
		x1.subscribe(home,*this,Int::PC_INT_DOM);
		p = p1;
        home.notice(*this, AP_DISPOSE);
	}
	static ExecStatus post(Space& home, Int::IntView x0, Int::IntView
x1, std::shared_ptr<TestObj> p) {
		(void) new (home) Less(home,x0,x1,p); return ES_OK;
	}
	// disposal
	virtual size_t dispose(Space& home) {
		x0.cancel(home,*this,Int::PC_INT_DOM);
		x1.cancel(home,*this,Int::PC_INT_DOM);
		p.reset();
		//p.~shared_ptr<TestObj>();
		(void) Propagator::dispose(home);
		home.ignore(*this,AP_DISPOSE);
		return sizeof(*this);
	}
	// copying
	Less(Space& home, bool share, Less& prop) :
Propagator(home,share,prop), p(prop.p) {
		x0.update(home,share,prop.x0);
		x1.update(home,share,prop.x1);
	}
	virtual Propagator* copy(Space& home, bool share) {
		return new (home) Less(home,share,*this);
	}
	// cost computation
	virtual PropCost cost(const Space&, const ModEventDelta&) const {
		return PropCost::binary(PropCost::LO);
	}
	// propagation
	virtual ExecStatus propagate(Space& home, const ModEventDelta&) {
		if (x0.le(home,x1.max()) == Int::ME_INT_FAILED)
			return ES_FAILED;
		if (x1.gr(home,x0.min()) == Int::ME_INT_FAILED)
			return ES_FAILED;
		if (x0.assigned() && x1.assigned())
			return home.ES_SUBSUMED(*this);
		else return ES_NOFIX;
	}
};

void less(Space& home, IntVar x0, IntVar x1, std::shared_ptr<TestObj> p) {
// constraint post function
	Int::IntView y0(x0), y1(x1);
	if (Less::post(home,y0,y1,p) != ES_OK) home.fail();

}

class ExampleSpace : public Script {
protected:
  /// Arrays of ints
  IntVarArray intvars;
public:
  /// Actual model

  ExampleSpace(const Options& opt) : Script(opt), intvars(*this,2,0,10) {
     std::shared_ptr<TestObj> p = std::make_shared<TestObj>(1);
	 less(*this,intvars[0],intvars[1],p);
	 branch(*this, intvars, INT_VAR_SIZE_MIN(), INT_VAL_MIN() );
  }
  /// Print solution
  virtual void
  print(std::ostream& os) const {
    os << "\t" << intvars << std::endl;
  }

  /// Constructor for cloning \a s
  ExampleSpace(bool share, ExampleSpace& s) : Script(share,s) {
    intvars.update(*this, share, s.intvars);
  }
  /// Copy during cloning
  virtual Space*
  copy(bool share) {
    return new ExampleSpace(true,*this);
  }
};

int
main(int argc, char* argv[]) {
  Options opt("ExampleSpace");
  opt.parse(argc,argv);
  Script::run<ExampleSpace,DFS,Options>(opt);
  return 0;
}

-----Original Message-----
From: Christian Schulte [mailto:cschulte at kth.se]
Sent: Dienstag, 12. April 2016 21:22
To: Drescher, Conrad <conrad.drescher at sap.com>; users at gecode.org
Subject: RE: [gecode-users] Smart pointer in propagator?

Hi Conrad,

There is a catch here: storing a smart pointer (or any other data structure
that has a destructor) in an object is okay, provided that:
1. You register the propagator so that its dispose() member function is
called when the propagator is deleted. But that you say you do.
2. You add an explicit call to the smart pointer's destructor in the
propagator's dispose() function, for example: if p is the smart pointer of
say type unique_ptr<T>, then add p.?unique_ptr<T>() to the dispose() member
function.

That should do the trick. Is this worth being added as a tip to MPG?

Cheers
Christian

--
Christian Schulte, http://www.gecode.org/~schulte Professor of Computer
Science, KTH, mailto:cschulte at kth.se Expert Researcher, SICS,
cschulte at sics.se

From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Drescher, Conrad
Sent: Friday, April 8, 2016 14:24
To: users at gecode.org
Subject: [gecode-users] Smart pointer in propagator?

Hi there,

we were thinking of storing a smart pointer in a propagator that is asking
its home space to call its dispose()-method upon home space deletion. In the
absence of a virtual destructor for class Propagator we're not sure it's a
smart idea. Reading MPG 30.2 did not entirely clarify the situation - could
you please elaborate?

Many thanks!
Conrad

Dr. Conrad Drescher
Senior Developer | AI DEV SCM PLM DE
SAP SE | Dietmar-Hopp-Allee 16 | 69190 Walldorf | Germany T +49 6227 7-77888
| M +49 160 90684883 | E mailto:conrad.drescher at sap.com 
| http://www.sap.com/

Please consider the impact on the environment before printing this e-mail.


Pflichtangaben/Mandatory Disclosure Statements: 
http://www.sap.com/company/legal/impressum.epx

Diese E-Mail kann Betriebs- oder Gesch?ftsgeheimnisse oder sonstige
vertrauliche Informationen enthalten. Sollten Sie diese E-Mail irrt?mlich
erhalten haben, ist Ihnen eine Kenntnisnahme des Inhalts, eine
Vervielf?ltigung oder Weitergabe der E-Mail ausdr?cklich untersagt. Bitte
benachrichtigen Sie uns und vernichten Sie die empfangene E-Mail. Vielen
Dank. 

This e-mail may contain trade secrets or privileged, undisclosed, or
otherwise confidential information. If you have received this e-mail in
error, you are hereby notified that any review, copying, or distribution of
it is strictly prohibited. Please inform us immediately and destroy the
original transmittal. Thank you for your cooperation.



* Christian Schulte <cschulte at kth.se>
* Issuer: TERENA - Unverified
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4599 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20160414/1ba15cc7/attachment.bin>

From yunusacikoz at gmail.com  Wed Apr 20 09:11:11 2016
From: yunusacikoz at gmail.com (Yunus Acikoz)
Date: Wed, 20 Apr 2016 10:11:11 +0300
Subject: [gecode-users] Scheduling A Propagator After Backtrack
Message-ID: <CAGSNhThjiON9dFp6H_9ZYow_TmS86iM4xA6YmKY3uL1b3-xpdA@mail.gmail.com>

Hi,

I would like to know if it's possible to schedule a custom propagator such
that it is immediately propagated after backtracking. I mean something like
executing the code below in the copy function of the propagator:

        auto copy_propagator = new(home)AdvisedPropagator(home, share,
*this);
        Gecode::Int::IntView::schedule(home, *copy_propagator,
Gecode::Int::ME_INT_DOM);


So the newly generated copy of the propagator (without its council being
copied) is scheduled to be run when the search engine turns back to that
node. Does it make sense at all?

I use advisors and they consume too much memory. Each advisor holds the
previous state of the domain of its subscribed view as an IntSet, an unsigned
short index and an enum to keep info about which variable array it belongs
to.
I want to initialize advisors lazily, so that they are only created when
the propagator is actually used. I thought maybe I could do it in
"propagate" function with an initial propagation.

Thanks in advance,
Cheers,
Yunus Acikoz
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160420/a2600c20/attachment.html>

From cschulte at kth.se  Wed Apr 20 09:33:30 2016
From: cschulte at kth.se (Christian Schulte)
Date: Wed, 20 Apr 2016 09:33:30 +0200
Subject: [gecode-users] Scheduling A Propagator After Backtrack
In-Reply-To: <CAGSNhThjiON9dFp6H_9ZYow_TmS86iM4xA6YmKY3uL1b3-xpdA@mail.gmail.com>
References: <CAGSNhThjiON9dFp6H_9ZYow_TmS86iM4xA6YmKY3uL1b3-xpdA@mail.gmail.com>
Message-ID: <09c601d19ad6$eff3b4a0$cfdb1de0$@kth.se>

Hi Yunus,



The point is: you cannot schedule a propagator during copying (the system will 
crash).



Copying lazily is normally an excellent idea, many Gecode propagators do it. 
One way to do it is to use a flag whether the propagator has been run. When 
you clone the propagator you set it to false and in the propagate() function 
you can check whether you have run the propagator.



Would that do for you?



Storing the whole previous domain sounds very excessive to me, though and 
integer sets are definitely not an efficient data structure for that purpose. 
Maybe you could also start thinking about maintaining less information?



Hope that helps.



Cheers

Christian



--

Christian Schulte, www.gecode.org/~schulte

Professor of Computer Science, KTH, cschulte at kth.se

Expert Researcher, SICS, cschulte at sics.se



From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf Of 
Yunus Acikoz
Sent: Wednesday, April 20, 2016 09:11
To: users at gecode.org
Subject: [gecode-users] Scheduling A Propagator After Backtrack



Hi,



I would like to know if it's possible to schedule a custom propagator such 
that it is immediately propagated after backtracking. I mean something like 
executing the code below in the copy function of the propagator:



        auto copy_propagator = new(home)AdvisedPropagator(home, share, *this);

        Gecode::Int::IntView::schedule(home, *copy_propagator, 
Gecode::Int::ME_INT_DOM);





So the newly generated copy of the propagator (without its council being 
copied) is scheduled to be run when the search engine turns back to that node. 
Does it make sense at all?



I use advisors and they consume too much memory. Each advisor holds the 
previous state of the domain of its subscribed view as an IntSet, an unsigned 
short index and an enum to keep info about which variable array it belongs to.

I want to initialize advisors lazily, so that they are only created when the 
propagator is actually used. I thought maybe I could do it in "propagate" 
function with an initial propagation.



Thanks in advance,

Cheers,

Yunus Acikoz

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160420/1ec9521a/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4623 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20160420/1ec9521a/attachment.bin>

From yunusacikoz at gmail.com  Wed Apr 20 09:51:57 2016
From: yunusacikoz at gmail.com (Yunus Acikoz)
Date: Wed, 20 Apr 2016 10:51:57 +0300
Subject: [gecode-users] Scheduling A Propagator After Backtrack
In-Reply-To: <09c601d19ad6$eff3b4a0$cfdb1de0$@kth.se>
References: <CAGSNhThjiON9dFp6H_9ZYow_TmS86iM4xA6YmKY3uL1b3-xpdA@mail.gmail.com>
	<09c601d19ad6$eff3b4a0$cfdb1de0$@kth.se>
Message-ID: <CAGSNhTgTk1XV7q6BGc3TiuRLM5H=bJXxGTSgCqwKHSWeYtAQ_g@mail.gmail.com>

Using a flag is a good idea, but without initializing the council and the
advisors, there's nothing to run the propagator if I understood correctly.
Am I right?
How about subscribing the propagator to views in the beginning and then
canceling the subscription once the advisors are initialized in the first
call of propagate()?  To be honest, it doesn't sound very wise to me but
just an idea.

About the previous domain thing: I need to know which values are removed
from my integer views to use them in a labeling algorithm. That was the
only way I could think of.

Cheers,
Yunus Acikoz

On Wed, Apr 20, 2016 at 10:33 AM, Christian Schulte <cschulte at kth.se> wrote:

> Hi Yunus,
>
>
>
> The point is: you cannot schedule a propagator during copying (the system
> will crash).
>
>
>
> Copying lazily is normally an excellent idea, many Gecode propagators do
> it. One way to do it is to use a flag whether the propagator has been run.
> When you clone the propagator you set it to false and in the propagate()
> function you can check whether you have run the propagator.
>
>
>
> Would that do for you?
>
>
>
> Storing the whole previous domain sounds very excessive to me, though and
> integer sets are definitely not an efficient data structure for that
> purpose. Maybe you could also start thinking about maintaining less
> information?
>
>
>
> Hope that helps.
>
>
>
> Cheers
>
> Christian
>
>
>
> --
>
> Christian Schulte, www.gecode.org/~schulte
>
> Professor of Computer Science, KTH, cschulte at kth.se
>
> Expert Researcher, SICS, cschulte at sics.se
>
>
>
> *From:* users-bounces at gecode.org [mailto:users-bounces at gecode.org] *On
> Behalf Of *Yunus Acikoz
> *Sent:* Wednesday, April 20, 2016 09:11
> *To:* users at gecode.org
> *Subject:* [gecode-users] Scheduling A Propagator After Backtrack
>
>
>
> Hi,
>
>
>
> I would like to know if it's possible to schedule a custom propagator such
> that it is immediately propagated after backtracking. I mean something like
> executing the code below in the copy function of the propagator:
>
>
>
>         auto copy_propagator = new(home)AdvisedPropagator(home, share,
> *this);
>
>         Gecode::Int::IntView::schedule(home, *copy_propagator,
> Gecode::Int::ME_INT_DOM);
>
>
>
>
>
> So the newly generated copy of the propagator (without its council being
> copied) is scheduled to be run when the search engine turns back to that
> node. Does it make sense at all?
>
>
>
> I use advisors and they consume too much memory. Each advisor holds the
> previous state of the domain of its subscribed view as an IntSet, an unsigned
> short index and an enum to keep info about which variable array it
> belongs to.
>
> I want to initialize advisors lazily, so that they are only created when
> the propagator is actually used. I thought maybe I could do it in
> "propagate" function with an initial propagation.
>
>
>
> Thanks in advance,
>
> Cheers,
>
> Yunus Acikoz
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160420/40c4ebe2/attachment-0001.html>

From cschulte at kth.se  Wed Apr 20 16:35:48 2016
From: cschulte at kth.se (Christian Schulte)
Date: Wed, 20 Apr 2016 16:35:48 +0200
Subject: [gecode-users] Scheduling A Propagator After Backtrack
In-Reply-To: <CAGSNhTgTk1XV7q6BGc3TiuRLM5H=bJXxGTSgCqwKHSWeYtAQ_g@mail.gmail.com>
References: <CAGSNhThjiON9dFp6H_9ZYow_TmS86iM4xA6YmKY3uL1b3-xpdA@mail.gmail.com>	<09c601d19ad6$eff3b4a0$cfdb1de0$@kth.se>
	<CAGSNhTgTk1XV7q6BGc3TiuRLM5H=bJXxGTSgCqwKHSWeYtAQ_g@mail.gmail.com>
Message-ID: <0aec01d19b11$eecaea40$cc60bec0$@kth.se>

No, you need to keep advisor and council: they will not take much memory, it?s really the sets that eat memory. That might mean that you have to take out the integer set information from your advisors (you do not say so but that is my guess here). Subscriptions by propagators also take memory!

 

Then you need to check the flag when an advisor is run. That should work.

 

Cheers

Christian

 

--

Christian Schulte, www.gecode.org/~schulte

Professor of Computer Science, KTH,  <mailto:cschulte at kth.se> cschulte at kth.se

Expert Researcher, SICS,  <mailto:cschulte at sics.se> cschulte at sics.se

 

From: Yunus Acikoz [mailto:yunusacikoz at gmail.com] 
Sent: Wednesday, April 20, 2016 09:52
To: Christian Schulte
Cc: users at gecode.org
Subject: Re: [gecode-users] Scheduling A Propagator After Backtrack

 

Using a flag is a good idea, but without initializing the council and the advisors, there's nothing to run the propagator if I understood correctly. Am I right?

How about subscribing the propagator to views in the beginning and then canceling the subscription once the advisors are initialized in the first call of propagate()?  To be honest, it doesn't sound very wise to me but just an idea.

 

About the previous domain thing: I need to know which values are removed from my integer views to use them in a labeling algorithm. That was the only way I could think of.

 

Cheers,

Yunus Acikoz

 

On Wed, Apr 20, 2016 at 10:33 AM, Christian Schulte <cschulte at kth.se> wrote:

Hi Yunus,

 

The point is: you cannot schedule a propagator during copying (the system will crash).

 

Copying lazily is normally an excellent idea, many Gecode propagators do it. One way to do it is to use a flag whether the propagator has been run. When you clone the propagator you set it to false and in the propagate() function you can check whether you have run the propagator.

 

Would that do for you?

 

Storing the whole previous domain sounds very excessive to me, though and integer sets are definitely not an efficient data structure for that purpose. Maybe you could also start thinking about maintaining less information?

 

Hope that helps.

 

Cheers

Christian

 

--

Christian Schulte, www.gecode.org/~schulte

Professor of Computer Science, KTH, cschulte at kth.se

Expert Researcher, SICS, cschulte at sics.se

 

From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf Of Yunus Acikoz
Sent: Wednesday, April 20, 2016 09:11
To: users at gecode.org
Subject: [gecode-users] Scheduling A Propagator After Backtrack

 

Hi,

 

I would like to know if it's possible to schedule a custom propagator such that it is immediately propagated after backtracking. I mean something like executing the code below in the copy function of the propagator:

 

        auto copy_propagator = new(home)AdvisedPropagator(home, share, *this);

        Gecode::Int::IntView::schedule(home, *copy_propagator, Gecode::Int::ME_INT_DOM);

 

 

So the newly generated copy of the propagator (without its council being copied) is scheduled to be run when the search engine turns back to that node. Does it make sense at all?

 

I use advisors and they consume too much memory. Each advisor holds the previous state of the domain of its subscribed view as an IntSet, an unsigned short index and an enum to keep info about which variable array it belongs to.

I want to initialize advisors lazily, so that they are only created when the propagator is actually used. I thought maybe I could do it in "propagate" function with an initial propagation.

 

Thanks in advance,

Cheers,

Yunus Acikoz

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160420/8da981bb/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4623 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20160420/8da981bb/attachment.bin>

From geoffzoet at hotmail.com  Tue Apr 26 10:27:35 2016
From: geoffzoet at hotmail.com (Geoffroy Zoetardt)
Date: Tue, 26 Apr 2016 10:27:35 +0200
Subject: [gecode-users] Advices for creating new variable type?
Message-ID: <BLU436-SMTP638D6707ED493809D68104A6630@phx.gbl>

Hi everyone,

I?m actually developing a binding between Gecode and OpenMusic (composition software made by the IRCAM).
During this project, I want to create new type of variable closer to the musical objects already existing in OpenMusic (OM).
For example, in OM there is a Note object with some attributes such as the pitch, the velocity, the duration and I want to create a NoteVar in Gecode to use all possibilities of constraint programming on Note object.
For now, my idea is to implement each attribute as an IntVar content in the NoteVar object because there are mainly two application that I need to do with NoteVar:
- Be able to apply constraints and search on attribute individually (reason for implementing  them as IntVar).
- Be able to apply constraints and search on the NoteVar object.
Then I would like to have your advices on ?  What would be the best idea of implementation for NoteVar to easily apply the constraints and the search on this object? ?.
I hope that it is clear enough.
Already thank you!

Geoffroy Zoetardt

From cschulte at kth.se  Tue Apr 26 11:02:00 2016
From: cschulte at kth.se (Christian Schulte)
Date: Tue, 26 Apr 2016 11:02:00 +0200
Subject: [gecode-users] Advices for creating new variable type?
In-Reply-To: <BLU436-SMTP638D6707ED493809D68104A6630@phx.gbl>
References: <BLU436-SMTP638D6707ED493809D68104A6630@phx.gbl>
Message-ID: <003901d19f9a$4b819ae0$e284d0a0$@kth.se>

Hi Geoffroy,

The key question here is whether you intend to also implement propapators that are specific to a NoteVar.

If yes, then you will have to have a look at the Variable implementation part in MPG.

If not, you can see a NoteVar just as modeling tool for which you provide your own constraint post functions but no dedicated propagators as all can be expressed by constraints over integer variables. Much easier.

I'd try to give the latter a shot first.

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte
Professor of Computer Science, KTH, cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se

-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf Of Geoffroy Zoetardt
Sent: Tuesday, April 26, 2016 10:28
To: users at gecode.org
Subject: [gecode-users] Advices for creating new variable type?

Hi everyone,

I?m actually developing a binding between Gecode and OpenMusic (composition software made by the IRCAM).
During this project, I want to create new type of variable closer to the musical objects already existing in OpenMusic (OM).
For example, in OM there is a Note object with some attributes such as the pitch, the velocity, the duration and I want to create a NoteVar in Gecode to use all possibilities of constraint programming on Note object.
For now, my idea is to implement each attribute as an IntVar content in the NoteVar object because there are mainly two application that I need to do with NoteVar:
- Be able to apply constraints and search on attribute individually (reason for implementing  them as IntVar).
- Be able to apply constraints and search on the NoteVar object.
Then I would like to have your advices on ?  What would be the best idea of implementation for NoteVar to easily apply the constraints and the search on this object? ?.
I hope that it is clear enough.
Already thank you!

Geoffroy Zoetardt
_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4623 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20160426/8d9a8cdb/attachment.bin>

From Torsten.Anders at beds.ac.uk  Tue Apr 26 12:55:35 2016
From: Torsten.Anders at beds.ac.uk (Torsten Anders)
Date: Tue, 26 Apr 2016 10:55:35 +0000
Subject: [gecode-users] Advices for creating new variable type?
In-Reply-To: <BLU436-SMTP638D6707ED493809D68104A6630@phx.gbl>
References: <BLU436-SMTP638D6707ED493809D68104A6630@phx.gbl>
Message-ID: <8C5253F9-DBEA-45FC-AE5D-5AAFA45BFC5B@beds.ac.uk>

Dear Geoffroy,

> For example, in OM there is a Note object with some attributes such as the pitch, the velocity, the duration and I want to create a NoteVar in Gecode to use all possibilities of constraint programming on Note object.

Why not represent your note object with several variables, e.g., of integer domain for the pitch and duration. That way you get all the constraint propagators defined for that domain for free (otherwise you would have to code that all yourself for your new domain, I understand). Besides, you will also need propagation between the different parameters of a note object, i.e., it should not be a single variable. 

Some comments on the individual note parameters. By representing pitches and durations as integers you are limiting what the result can express, but this may still be a good compromise. For example, for pitches you could allow for arbitrary equal temperaments with an integer representation, which is relatively generic. For music in just intonation you would ideally have a domain of ratios (which you do not have in Gecode, AFAIK), and for unequal temperaments a domain of reals/floats (which you could have), but an approximation with integers with a high number of pitches per octave (e.g., 1200 for cent resolution) should be fine. 

For duration and other rhythmic parameters the situation is a bit more tricky. By limiting yourself to integers you are always limited with respect to contemporary music practice, where you have nested tuplets etc. If you are willing to limit your results to music with a fixed set of possible tuplets and without nesting, then an integer-based representation is fine. 

I suggest you make a velocity parameter only optional to avoid creating lots of variables later that are virtually never used. From the many music CSPs that I know of, velocities are very rarely required. If you want to implement those, then it might make actually sense to implement the full or at least large parts of the MIDI protocol for constraint programming (or consider OSC instead), i.e., not just note velocities, but also the MIDI channel of notes, other events like CC messages etc. That may lead to new applications.   

> What would be the best idea of implementation for NoteVar to easily apply the constraints and the search on this object? 

I am happy to discuss the advantages and disadvantages of different constraint-based music representations off-list. You may also want to have a look at the following literature survey, that compares the design of multiple music constraint systems in quite some detail. 

  Anders, T. & Miranda, E. R. (2011) Constraint Programming Systems for Modeling Music Theories and Composition. ACM Computing Surveys. 43 (4), 30:1?30:38.

Best wishes,
Torsten

--
Dr Torsten Anders
Course Leader, Music Technology
University of Bedfordshire
Park Square, Room A315
http://www.torsten-anders.de



On 26 Apr 2016, at 09:27, Geoffroy Zoetardt <geoffzoet at hotmail.com> wrote:
> Hi everyone,
> 
> I?m actually developing a binding between Gecode and OpenMusic (composition software made by the IRCAM).
> During this project, I want to create new type of variable closer to the musical objects already existing in OpenMusic (OM).
> For example, in OM there is a Note object with some attributes such as the pitch, the velocity, the duration and I want to create a NoteVar in Gecode to use all possibilities of constraint programming on Note object.
> For now, my idea is to implement each attribute as an IntVar content in the NoteVar object because there are mainly two application that I need to do with NoteVar:
> - Be able to apply constraints and search on attribute individually (reason for implementing  them as IntVar).
> - Be able to apply constraints and search on the NoteVar object.
> Then I would like to have your advices on ?  What would be the best idea of implementation for NoteVar to easily apply the constraints and the search on this object? ?.
> I hope that it is clear enough.
> Already thank you!
> 
> Geoffroy Zoetardt
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users



From geoffzoet at hotmail.com  Tue Apr 26 15:01:38 2016
From: geoffzoet at hotmail.com (Geoffroy Zoetardt)
Date: Tue, 26 Apr 2016 15:01:38 +0200
Subject: [gecode-users] Advices for creating new variable type?
In-Reply-To: <003901d19f9a$4b819ae0$e284d0a0$@kth.se>
References: <BLU436-SMTP638D6707ED493809D68104A6630@phx.gbl>
	<003901d19f9a$4b819ae0$e284d0a0$@kth.se>
Message-ID: <BLU436-SMTP2066A3E810C69F1A3C1A399A6630@phx.gbl>

Hi Christian,

For now, I don?t intend to implement specific propagators.
Concerning the constraint post functions, is there a special way to do it through gecode?
Thanks you for you quick answer!

Geoffroy
> Le 26 avr. 2016 ? 11:02, Christian Schulte <cschulte at kth.se> a ?crit :
> 
> Hi Geoffroy,
> 
> The key question here is whether you intend to also implement propapators that are specific to a NoteVar.
> 
> If yes, then you will have to have a look at the Variable implementation part in MPG.
> 
> If not, you can see a NoteVar just as modeling tool for which you provide your own constraint post functions but no dedicated propagators as all can be expressed by constraints over integer variables. Much easier.
> 
> I'd try to give the latter a shot first.
> 
> Cheers
> Christian
> 
> --
> Christian Schulte, www.gecode.org/~schulte
> Professor of Computer Science, KTH, cschulte at kth.se
> Expert Researcher, SICS, cschulte at sics.se
> 
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf Of Geoffroy Zoetardt
> Sent: Tuesday, April 26, 2016 10:28
> To: users at gecode.org
> Subject: [gecode-users] Advices for creating new variable type?
> 
> Hi everyone,
> 
> I?m actually developing a binding between Gecode and OpenMusic (composition software made by the IRCAM).
> During this project, I want to create new type of variable closer to the musical objects already existing in OpenMusic (OM).
> For example, in OM there is a Note object with some attributes such as the pitch, the velocity, the duration and I want to create a NoteVar in Gecode to use all possibilities of constraint programming on Note object.
> For now, my idea is to implement each attribute as an IntVar content in the NoteVar object because there are mainly two application that I need to do with NoteVar:
> - Be able to apply constraints and search on attribute individually (reason for implementing  them as IntVar).
> - Be able to apply constraints and search on the NoteVar object.
> Then I would like to have your advices on ?  What would be the best idea of implementation for NoteVar to easily apply the constraints and the search on this object? ?.
> I hope that it is clear enough.
> Already thank you!
> 
> Geoffroy Zoetardt
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users



From cschulte at kth.se  Tue Apr 26 15:02:21 2016
From: cschulte at kth.se (Christian Schulte)
Date: Tue, 26 Apr 2016 15:02:21 +0200
Subject: [gecode-users] Advices for creating new variable type?
In-Reply-To: <BLU436-SMTP2066A3E810C69F1A3C1A399A6630@phx.gbl>
References: <BLU436-SMTP638D6707ED493809D68104A6630@phx.gbl>
	<003901d19f9a$4b819ae0$e284d0a0$@kth.se>
	<BLU436-SMTP2066A3E810C69F1A3C1A399A6630@phx.gbl>
Message-ID: <00c901d19fbb$e0671dd0$a1355970$@kth.se>

Hi,

No special way: you will just have to implement something in terms of your NoteVar. Frankly, I do not really know what you are after...

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte
Professor of Computer Science, KTH, cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se

-----Original Message-----
From: Geoffroy Zoetardt [mailto:geoffzoet at hotmail.com] 
Sent: Tuesday, April 26, 2016 15:02
To: cschulte at kth.se
Cc: users at gecode.org
Subject: Re: [gecode-users] Advices for creating new variable type?

Hi Christian,

For now, I don?t intend to implement specific propagators.
Concerning the constraint post functions, is there a special way to do it through gecode?
Thanks you for you quick answer!

Geoffroy
> Le 26 avr. 2016 ? 11:02, Christian Schulte <cschulte at kth.se> a ?crit :
> 
> Hi Geoffroy,
> 
> The key question here is whether you intend to also implement propapators that are specific to a NoteVar.
> 
> If yes, then you will have to have a look at the Variable implementation part in MPG.
> 
> If not, you can see a NoteVar just as modeling tool for which you provide your own constraint post functions but no dedicated propagators as all can be expressed by constraints over integer variables. Much easier.
> 
> I'd try to give the latter a shot first.
> 
> Cheers
> Christian
> 
> --
> Christian Schulte, www.gecode.org/~schulte Professor of Computer 
> Science, KTH, cschulte at kth.se Expert Researcher, SICS, 
> cschulte at sics.se
> 
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On 
> Behalf Of Geoffroy Zoetardt
> Sent: Tuesday, April 26, 2016 10:28
> To: users at gecode.org
> Subject: [gecode-users] Advices for creating new variable type?
> 
> Hi everyone,
> 
> I?m actually developing a binding between Gecode and OpenMusic (composition software made by the IRCAM).
> During this project, I want to create new type of variable closer to the musical objects already existing in OpenMusic (OM).
> For example, in OM there is a Note object with some attributes such as the pitch, the velocity, the duration and I want to create a NoteVar in Gecode to use all possibilities of constraint programming on Note object.
> For now, my idea is to implement each attribute as an IntVar content in the NoteVar object because there are mainly two application that I need to do with NoteVar:
> - Be able to apply constraints and search on attribute individually (reason for implementing  them as IntVar).
> - Be able to apply constraints and search on the NoteVar object.
> Then I would like to have your advices on ?  What would be the best idea of implementation for NoteVar to easily apply the constraints and the search on this object? ?.
> I hope that it is clear enough.
> Already thank you!
> 
> Geoffroy Zoetardt
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4599 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20160426/52bbf5ed/attachment.bin>

