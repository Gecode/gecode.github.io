From brosseaufabien at gmail.com  Sat Sep  3 20:57:42 2016
From: brosseaufabien at gmail.com (Fabien Brosseau)
Date: Sat, 3 Sep 2016 20:57:42 +0200
Subject: [gecode-users] Installation
Message-ID: <CAJTv5jJbb1CDoR2mZ32WQbX99wgi_c-muOr8briPtqcAfu_FYA@mail.gmail.com>

Hello everyone,

I am trying to use Gecode for a little project but i am not able to make it
work.

On windows 7 (64 bits) :
i am trying to use it with a Code::Blocks project. But when I try to
compile a project with an example file, I have some errors :

   - header not working in "x86gcc_rounding_control.hpp" file  "This header
   only works on x86 CPUs"  -> so why it's called ?
   - "_forceinline" which doesn't name a type


On Ubuntu 14.04 :

i get the gecode package and i tried to use it in a qt project.

I have set INCLUDEPATH and LIBS (files are not installed where
documentation said) but I still have undefined reference errors.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160903/bbf4711f/attachment.html>

From cschulte at kth.se  Sun Sep  4 11:22:54 2016
From: cschulte at kth.se (Christian Schulte)
Date: Sun, 4 Sep 2016 11:22:54 +0200
Subject: [gecode-users] Installation
In-Reply-To: <CAJTv5jJbb1CDoR2mZ32WQbX99wgi_c-muOr8briPtqcAfu_FYA@mail.gmail.com>
References: <CAJTv5jJbb1CDoR2mZ32WQbX99wgi_c-muOr8briPtqcAfu_FYA@mail.gmail.com>
Message-ID: <006801d2068d$fc1b7920$f4526b60$@kth.se>

Hi,



The windows errors seem to indicate that you installed a package for x86 but 
use a x64 compiler.



On Linux: are you sure that you have installed all necessary Qt packages?



Did you read the information on how to install Gecode in MPG?



Best

Christian



--

Christian Schulte, www.gecode.org/~schulte <http://www.gecode.org/~schulte>

Professor of Computer Science, KTH, cschulte at kth.se <mailto:cschulte at kth.se>

Expert Researcher, SICS, cschulte at sics.se



From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf Of 
Fabien Brosseau
Sent: Saturday, September 3, 2016 20:58
To: users at gecode.org
Subject: [gecode-users] Installation



Hello everyone,

I am trying to use Gecode for a little project but i am not able to make it 
work.

On windows 7 (64 bits) :

i am trying to use it with a Code::Blocks project. But when I try to compile a 
project with an example file, I have some errors :

*	header not working in "x86gcc_rounding_control.hpp" file  "This header only 
works on x86 CPUs"  -> so why it's called ?
*	"_forceinline" which doesn't name a type



On Ubuntu 14.04 :

i get the gecode package and i tried to use it in a qt project.

I have set INCLUDEPATH and LIBS (files are not installed where documentation 
said) but I still have undefined reference errors.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160904/1554b4e5/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4599 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20160904/1554b4e5/attachment.bin>

From cschulte at kth.se  Tue Sep  6 09:03:48 2016
From: cschulte at kth.se (Christian Schulte)
Date: Tue, 6 Sep 2016 09:03:48 +0200
Subject: [gecode-users] Installation
In-Reply-To: <CAJTv5jLNB7wGGQJeJ4cQw1MZgtzjjfbBmr17fJYSZrxd4qdbyg@mail.gmail.com>
References: <CAJTv5jJbb1CDoR2mZ32WQbX99wgi_c-muOr8briPtqcAfu_FYA@mail.gmail.com>
	<006801d2068d$fc1b7920$f4526b60$@kth.se>
	<CAJTv5jLqWC82UZnb2hyxE5HY_=Se4Nkqda0LYPw8a--daoN=Tw@mail.gmail.com>
	<CAJTv5jLNB7wGGQJeJ4cQw1MZgtzjjfbBmr17fJYSZrxd4qdbyg@mail.gmail.com>
Message-ID: <002e01d2080c$d1d2f960$7578ec20$@kth.se>

Hi,

 

This is a seriously outdated version and we will not really follow up on how Ubuntu has packaged Gecode. So, please download the latest version from the Gecode webpages. You have to compile it yourself, however that?s easy and explained in MPG.

 

Best

Christian

 

--

Christian Schulte,  <http://www.gecode.org/~schulte> www.gecode.org/~schulte

Professor of Computer Science, KTH,  <mailto:cschulte at kth.se> cschulte at kth.se

Expert Researcher, SICS, cschulte at sics.se

 

From: Fabien Brosseau [mailto:brosseaufabien at gmail.com] 
Sent: Monday, September 5, 2016 21:05
To: cschulte at kth.se
Subject: Re: [gecode-users] Installation

 

and the gecode version installed is 4.2.1-1

 

2016-09-05 21:03 GMT+02:00 Fabien Brosseau <brosseaufabien at gmail.com <mailto:brosseaufabien at gmail.com> >:

I install it using apt-get install.

Headers are in "/usr/include/gecode" and .so files are in "/usr/lib/x86_64-linux-gnu".

.so files have the following name for example : libgecodesearch.so

 

So in the .pro file I have added :

INCLUDEPATH += /usr/include

LIBS += -L"/usr/lib/x86_64-linux-gnu"

             -llibgecodeflatzinc

             -llibgecodedriver

             -llibgecodegist

             -llibgecodesearch

             -llibgecodeminimodel

             -llibgecodeset

             -llibgecodefloat

             -llibgecodeint

             -llibgecodekernel

             -llibgecodesupport

And the error that I have is : undefined reference to 'Gecode::Search::Options::def'

I am trying to run the sendMoreMoney example.



I have also tried the following format for LIBS :
-L"/usr/lib/x86_64-linux-gnu/lib"
             -lgecodeflatzinc
             -lgecodedriver
             -lgecodegist
             -lgecodesearch
             -lgecodeminimodel
             -lgecodeset
             -lgecodefloat
             -lgecodeint
             -lgecodekernel
             -lgecodesupport

I have also set LD_LIBRAY_PATH but no success ...

 

2016-09-04 11:22 GMT+02:00 Christian Schulte <cschulte at kth.se <mailto:cschulte at kth.se> >:

Hi,

 

The windows errors seem to indicate that you installed a package for x86 but use a x64 compiler.

 

On Linux: are you sure that you have installed all necessary Qt packages?

 

Did you read the information on how to install Gecode in MPG?

 

Best

Christian

 

--

Christian Schulte, www.gecode.org/~schulte <http://www.gecode.org/~schulte> 

Professor of Computer Science, KTH, cschulte at kth.se <mailto:cschulte at kth.se> 

Expert Researcher, SICS, cschulte at sics.se <mailto:cschulte at sics.se> 

 

From: users-bounces at gecode.org <mailto:users-bounces at gecode.org>  [mailto:users-bounces at gecode.org <mailto:users-bounces at gecode.org> ] On Behalf Of Fabien Brosseau
Sent: Saturday, September 3, 2016 20:58
To: users at gecode.org <mailto:users at gecode.org> 
Subject: [gecode-users] Installation

 

Hello everyone,

I am trying to use Gecode for a little project but i am not able to make it work.

On windows 7 (64 bits) :

i am trying to use it with a Code::Blocks project. But when I try to compile a project with an example file, I have some errors :

*	header not working in "x86gcc_rounding_control.hpp" file  "This header only works on x86 CPUs"  -> so why it's called ?
*	"_forceinline" which doesn't name a type

 

On Ubuntu 14.04 :

i get the gecode package and i tried to use it in a qt project.

I have set INCLUDEPATH and LIBS (files are not installed where documentation said) but I still have undefined reference errors. 

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160906/b2d069bb/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4599 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20160906/b2d069bb/attachment.bin>

From cschulte at kth.se  Fri Sep  9 10:20:55 2016
From: cschulte at kth.se (Christian Schulte)
Date: Fri, 9 Sep 2016 10:20:55 +0200
Subject: [gecode-users] Installation
In-Reply-To: <CAJTv5jJfpOC+4cbQG=MaXHjxNNP_jATA6h94f93i6jjVb3q-7g@mail.gmail.com>
References: <CAJTv5jJbb1CDoR2mZ32WQbX99wgi_c-muOr8briPtqcAfu_FYA@mail.gmail.com>
	<006801d2068d$fc1b7920$f4526b60$@kth.se>
	<CAJTv5jLqWC82UZnb2hyxE5HY_=Se4Nkqda0LYPw8a--daoN=Tw@mail.gmail.com>
	<CAJTv5jLNB7wGGQJeJ4cQw1MZgtzjjfbBmr17fJYSZrxd4qdbyg@mail.gmail.com>
	<002e01d2080c$d1d2f960$7578ec20$@kth.se>
	<CAJTv5jJfpOC+4cbQG=MaXHjxNNP_jATA6h94f93i6jjVb3q-7g@mail.gmail.com>
Message-ID: <01a001d20a73$16c65860$44530920$@kth.se>

Did you follow the instructions in MPG? If not, please send me the version of your gcc and the exact error message.

 

The thing is: the 4.4.0 version has been installed on Linux several thousand times and should work like a charm.

 

Cheers

Christian

 

PS: Always include the mailing list.

 

--

Christian Schulte,  <http://www.gecode.org/~schulte> www.gecode.org/~schulte

Professor of Computer Science, KTH,  <mailto:cschulte at kth.se> cschulte at kth.se

Expert Researcher, SICS, cschulte at sics.se

 

From: Fabien Brosseau [mailto:brosseaufabien at gmail.com] 
Sent: Thursday, September 8, 2016 21:52
To: Christian Schulte <cschulte at kth.se>
Subject: Re: [gecode-users] Installation

 

Hi Christian,

I have downloaded the 4.4.0 version. All the building and install step work fine.

 I have modified the include path to:
 /usr/local/include

and the lib path to
 /usr/local/lib 

I took a cpp file from the examples (nonogram) but i still get the same errors.

 

2016-09-06 9:03 GMT+02:00 Christian Schulte <cschulte at kth.se <mailto:cschulte at kth.se> >:

Hi,

 

This is a seriously outdated version and we will not really follow up on how Ubuntu has packaged Gecode. So, please download the latest version from the Gecode webpages. You have to compile it yourself, however that?s easy and explained in MPG.

 

Best

Christian

 

--

Christian Schulte,  <http://www.gecode.org/~schulte> www.gecode.org/~schulte

Professor of Computer Science, KTH,  <mailto:cschulte at kth.se> cschulte at kth.se

Expert Researcher, SICS, cschulte at sics.se <mailto:cschulte at sics.se> 

 

From: Fabien Brosseau [mailto:brosseaufabien at gmail.com <mailto:brosseaufabien at gmail.com> ] 
Sent: Monday, September 5, 2016 21:05
To: cschulte at kth.se <mailto:cschulte at kth.se> 
Subject: Re: [gecode-users] Installation

 

and the gecode version installed is 4.2.1-1

 

2016-09-05 21:03 GMT+02:00 Fabien Brosseau <brosseaufabien at gmail.com <mailto:brosseaufabien at gmail.com> >:

I install it using apt-get install.

Headers are in "/usr/include/gecode" and .so files are in "/usr/lib/x86_64-linux-gnu".

.so files have the following name for example : libgecodesearch.so

 

So in the .pro file I have added :

INCLUDEPATH += /usr/include

LIBS += -L"/usr/lib/x86_64-linux-gnu"

             -llibgecodeflatzinc

             -llibgecodedriver

             -llibgecodegist

             -llibgecodesearch

             -llibgecodeminimodel

             -llibgecodeset

             -llibgecodefloat

             -llibgecodeint

             -llibgecodekernel

             -llibgecodesupport

And the error that I have is : undefined reference to 'Gecode::Search::Options::def'

I am trying to run the sendMoreMoney example.

I have also tried the following format for LIBS :
-L"/usr/lib/x86_64-linux-gnu/lib"
             -lgecodeflatzinc
             -lgecodedriver
             -lgecodegist
             -lgecodesearch
             -lgecodeminimodel
             -lgecodeset
             -lgecodefloat
             -lgecodeint
             -lgecodekernel
             -lgecodesupport

I have also set LD_LIBRAY_PATH but no success ...

 

2016-09-04 11:22 GMT+02:00 Christian Schulte <cschulte at kth.se <mailto:cschulte at kth.se> >:

Hi,

 

The windows errors seem to indicate that you installed a package for x86 but use a x64 compiler.

 

On Linux: are you sure that you have installed all necessary Qt packages?

 

Did you read the information on how to install Gecode in MPG?

 

Best

Christian

 

--

Christian Schulte, www.gecode.org/~schulte <http://www.gecode.org/~schulte> 

Professor of Computer Science, KTH, cschulte at kth.se <mailto:cschulte at kth.se> 

Expert Researcher, SICS, cschulte at sics.se <mailto:cschulte at sics.se> 

 

From: users-bounces at gecode.org <mailto:users-bounces at gecode.org>  [mailto:users-bounces at gecode.org <mailto:users-bounces at gecode.org> ] On Behalf Of Fabien Brosseau
Sent: Saturday, September 3, 2016 20:58
To: users at gecode.org <mailto:users at gecode.org> 
Subject: [gecode-users] Installation

 

Hello everyone,

I am trying to use Gecode for a little project but i am not able to make it work.

On windows 7 (64 bits) :

i am trying to use it with a Code::Blocks project. But when I try to compile a project with an example file, I have some errors :

*	header not working in "x86gcc_rounding_control.hpp" file  "This header only works on x86 CPUs"  -> so why it's called ?
*	"_forceinline" which doesn't name a type

 

On Ubuntu 14.04 :

i get the gecode package and i tried to use it in a qt project.

I have set INCLUDEPATH and LIBS (files are not installed where documentation said) but I still have undefined reference errors. 

 

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160909/975eb368/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4599 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20160909/975eb368/attachment-0001.bin>

From delmotte at mad-environnement.com  Tue Sep 13 14:54:38 2016
From: delmotte at mad-environnement.com (Sebastien Delmotte)
Date: Tue, 13 Sep 2016 14:54:38 +0200
Subject: [gecode-users] Cost optimization problem
Message-ID: <003501d20dbd$fd2b9e80$f782db80$@mad-environnement.com>

Dear All,

I have a problem with using Gecode to solve an optimization problem.

Problem description:
- I have a recipe with two sub-components. Each component has a coefficient
corresponding to its amount in the recipe. So the sum of the sub-components
coefficients must be equal to 1;
- Each of the two sub-components is composed of several raw materials. Each
raw material has a coefficient corresponding to its amount in its
sub-component. So, for each sub-component, the sum of the raw materials
coefficients is equal to 1;
- At the recipe level, I have some constraints on the raw materials amount
(e.g. raw material 1 must be in a given interval). The amount of each raw
material in the recipe is equal to the product of the coefficient of this
raw material by the coefficient of its sub-component
- I have to minimize the cost of the recipe accounting for the cost of each
raw materials. This cost is equal to the sum of the product of each raw
material coefficient by its unit cost.

Code

#include <gecode/driver.hh>
#include <gecode/int.hh>
#include <gecode/minimodel.hh>
using namespace Gecode;
class Tests : public FloatMinimizeScript? {
protected:
??? FloatVarArray _rms_in_sub_c_1; // raw mat in sub-comp1
??? FloatVarArray _rms_in_sub_c_2; // raw mat in sub-comp2
??? FloatVarArray _sub_c; // 2 sub-comp
??? FloatVar _cost; // cost
public:
??? Tests(const Options& o)
:FloatMinimizeScript(o),_rms_in_sub_c_1(*this,4,0,1),_rms_in_sub_c_2(*this,3
,0,1),_sub_c(*this,2,0,1),_cost(*this,0,1000)
??? {
//sum of raw mat in sub-comp =1
FloatVar all_rms_sub1 = expr(*this,sum(_rms_in_sub_c_1));
rel(*this,all_rms_sub1 ,FRT_EQ,1);
FloatVar all_rms_sub2 = expr(*this,sum(_rms_in_sub_c_2));
rel(*this,all_rms_sub2 ,FRT_EQ,1);
// sum of sub-comp =1
FloatVar sm = expr(*this,sum(_sub_c));
rel(*this,sm ,FRT_EQ,1);
// Global constraints on raw mat in recipe
FloatVar rm_0_sub_coef1= expr(*this,_rms_in_sub_c_1[0]*_sub_c[0]);
rel(*this,rm_0_sub_coef1,FRT_GQ,0);
FloatVar rm_1_sub_coef1= expr(*this,_rms_in_sub_c_1[1]*_sub_c[0]);
rel(*this,rm_1_sub_coef1,FRT_GQ,0);
FloatVar rm_2_sub_coef1= expr(*this,_rms_in_sub_c_1[2]*_sub_c[0]);
rel(*this,rm_2_sub_coef1,FRT_GQ,0);
FloatVar rm_3_sub_coef1= expr(*this,_rms_in_sub_c_1[3]*_sub_c[0]);
rel(*this,rm_3_sub_coef1,FRT_GQ,0);
FloatVar rm_0_sub_coef2= expr(*this,_rms_in_sub_c_2[0]*_sub_c[1]);
rel(*this,rm_0_sub_coef2,FRT_GQ,0);
FloatVar rm_1_sub_coef2= expr(*this,_rms_in_sub_c_2[1]*_sub_c[1]);
rel(*this,rm_1_sub_coef2,FRT_GQ,0);
FloatVar rm_2_sub_coef2= expr(*this,_rms_in_sub_c_2[2]*_sub_c[1]);
rel(*this,rm_2_sub_coef2,FRT_GQ,0);

// Cost
_cost = expr(*this,_sub_c[0]*(_rms_in_sub_c_1[0]*12 +_rms_in_sub_c_1[1]*14 +
_rms_in_sub_c_1[2] * 22 +_rms_in_sub_c_1[3] * 17 )
+_sub_c[1]*(_rms_in_sub_c_2[0]*9 +_rms_in_sub_c_2[1]*2 + _rms_in_sub_c_2[2]
* 18 ));
FloatVarArgs all;
for(int i = 0; i <4; i++) all << _rms_in_sub_c_1[i];
for(int i = 0; i <3; i++) all << _rms_in_sub_c_2[i];
for(int i = 0; i <2; i++) all << _sub_c[i];

branch(*this, all, FLOAT_VAR_NONE(), FLOAT_VAL_SPLIT_MIN());
??? }

virtual void
print(std::ostream& os) const {
os << "sub-component : " << _sub_c << "\nrms 1 : "<< _rms_in_sub_c_1<<
"\nrms2 : "<< _rms_in_sub_c_2 <<"\ncost : "<< _cost << std::endl;
??? }

virtual FloatVar cost(void) const{
return _cost;
??? }
Tests(bool share, Tests& s) : FloatMinimizeScript(share,s) {
_sub_c.update (*this, share, s._sub_c);
_rms_in_sub_c_1.update(*this, share, s._rms_in_sub_c_1);
_rms_in_sub_c_2.update(*this, share, s._rms_in_sub_c_2);
_cost.update(*this, share, s._cost);
??? }

virtual Space*
copy(bool share) {
return new Tests(share,*this);
??? }
};
int main(int argc, char* argv[]) {
Options opt("Test");
opt.solutions(0);
FloatMinimizeScript::run<Tests,BAB,Options>(opt);
return 0;
}

When executing this code, the result is :
sub-component : {0, 1}
rms in sub-component 1 : {0, 0, 0, 1}
rms in sub-component 2 : {0, 0, 1}
cost : [18..18]

Exception: FloatVar::val: Attempt to access value of unassigned variable.

Problems:
1- The resulting solution is trivial but absolutely not optimal for the
cost: only the second sub-component has a positive coefficient (=1) with
only one raw material which is not the cheapest one;
2- In this example, all the constraints for the raw materials are: greater
than 0. But if I change the value of the constraints (e.g. greater than
0.1), I don?t get any solution;
3- There is an exception error: FloatVar::val: Attempt to access value of
unassigned variable. This error disappears when I add the variable cost in
the branching, but the solution is still non optimal.

I think I have a problem with handling gecode because the problem is simple,
but I have no idea about the origin of the problem. 
With many thanks in advance.
Best regards,
S.D.




From brosseaufabien at gmail.com  Tue Sep 13 16:52:53 2016
From: brosseaufabien at gmail.com (Fabien Brosseau)
Date: Tue, 13 Sep 2016 16:52:53 +0200
Subject: [gecode-users] Installation
In-Reply-To: <01a001d20a73$16c65860$44530920$@kth.se>
References: <CAJTv5jJbb1CDoR2mZ32WQbX99wgi_c-muOr8briPtqcAfu_FYA@mail.gmail.com>
	<006801d2068d$fc1b7920$f4526b60$@kth.se>
	<CAJTv5jLqWC82UZnb2hyxE5HY_=Se4Nkqda0LYPw8a--daoN=Tw@mail.gmail.com>
	<CAJTv5jLNB7wGGQJeJ4cQw1MZgtzjjfbBmr17fJYSZrxd4qdbyg@mail.gmail.com>
	<002e01d2080c$d1d2f960$7578ec20$@kth.se>
	<CAJTv5jJfpOC+4cbQG=MaXHjxNNP_jATA6h94f93i6jjVb3q-7g@mail.gmail.com>
	<01a001d20a73$16c65860$44530920$@kth.se>
Message-ID: <CAJTv5j+rsG5dTdM3PXZv1pyw01vOwzGGkJ_UoD=hwZdPK-qH1g@mail.gmail.com>

Hello Chrsitian,

I managed to make it work using g++ command as they are told in the
documentation.

But It stills not working in the Qt project. I have errors like that (more
than 300 errors) :
undefined reference to 'Gecode::SizeOptions::SizeOptions(char const*)'

but i have set the path to headers and libs :
INCLUDEPATH += /usr/local/include
LIBS += -L/usr/local/lib
             -lgecodeflatzinc
             -lgecodedriver
             -lgecodegist
             -lgecodesearch
             -lgecodeminimodel
             -lgecodeset
             -lgecodefloat
             -lgecodeint
             -lgecodekernel
             -lgecodesupport

Anyway it seems more like a problem of qt configuration project than a
gecode problem.

Thanks for your time and your help.



2016-09-09 10:20 GMT+02:00 Christian Schulte <cschulte at kth.se>:

> Did you follow the instructions in MPG? If not, please send me the version
> of your gcc and the exact error message.
>
>
>
> The thing is: the 4.4.0 version has been installed on Linux several
> thousand times and should work like a charm.
>
>
>
> Cheers
>
> Christian
>
>
>
> PS: Always include the mailing list.
>
>
>
> --
>
> Christian Schulte, www.gecode.org/~schulte
>
> Professor of Computer Science, KTH, cschulte at kth.se
>
> Expert Researcher, SICS, cschulte at sics.se
>
>
>
> *From:* Fabien Brosseau [mailto:brosseaufabien at gmail.com]
> *Sent:* Thursday, September 8, 2016 21:52
> *To:* Christian Schulte <cschulte at kth.se>
> *Subject:* Re: [gecode-users] Installation
>
>
>
> Hi Christian,
>
> I have downloaded the 4.4.0 version. All the building and install step
> work fine.
>
>  I have modified the include path to:
>  /usr/local/include
>
> and the lib path to
>  /usr/local/lib
>
> I took a cpp file from the examples (nonogram) but i still get the same
> errors.
>
>
>
> 2016-09-06 9:03 GMT+02:00 Christian Schulte <cschulte at kth.se>:
>
> Hi,
>
>
>
> This is a seriously outdated version and we will not really follow up on
> how Ubuntu has packaged Gecode. So, please download the latest version from
> the Gecode webpages. You have to compile it yourself, however that?s easy
> and explained in MPG.
>
>
>
> Best
>
> Christian
>
>
>
> --
>
> Christian Schulte, www.gecode.org/~schulte
>
> Professor of Computer Science, KTH, cschulte at kth.se
>
> Expert Researcher, SICS, cschulte at sics.se
>
>
>
> *From:* Fabien Brosseau [mailto:brosseaufabien at gmail.com]
> *Sent:* Monday, September 5, 2016 21:05
> *To:* cschulte at kth.se
> *Subject:* Re: [gecode-users] Installation
>
>
>
> and the gecode version installed is 4.2.1-1
>
>
>
> 2016-09-05 21:03 GMT+02:00 Fabien Brosseau <brosseaufabien at gmail.com>:
>
> I install it using apt-get install.
>
> Headers are in "/usr/include/gecode" and .so files are in
> "/usr/lib/x86_64-linux-gnu".
>
> .so files have the following name for example : libgecodesearch.so
>
>
>
> So in the .pro file I have added :
>
> INCLUDEPATH += /usr/include
>
> LIBS += -L"/usr/lib/x86_64-linux-gnu"
>
>              -llibgecodeflatzinc
>
>              -llibgecodedriver
>
>              -llibgecodegist
>
>              -llibgecodesearch
>
>              -llibgecodeminimodel
>
>              -llibgecodeset
>
>              -llibgecodefloat
>
>              -llibgecodeint
>
>              -llibgecodekernel
>
>              -llibgecodesupport
>
> And the error that I have is : undefined reference to
> 'Gecode::Search::Options::def'
>
> I am trying to run the sendMoreMoney example.
>
> I have also tried the following format for LIBS :
> -L"/usr/lib/x86_64-linux-gnu/lib"
>              -lgecodeflatzinc
>              -lgecodedriver
>              -lgecodegist
>              -lgecodesearch
>              -lgecodeminimodel
>              -lgecodeset
>              -lgecodefloat
>              -lgecodeint
>              -lgecodekernel
>              -lgecodesupport
>
> I have also set LD_LIBRAY_PATH but no success ...
>
>
>
> 2016-09-04 11:22 GMT+02:00 Christian Schulte <cschulte at kth.se>:
>
> Hi,
>
>
>
> The windows errors seem to indicate that you installed a package for x86
> but use a x64 compiler.
>
>
>
> On Linux: are you sure that you have installed all necessary Qt packages?
>
>
>
> Did you read the information on how to install Gecode in MPG?
>
>
>
> Best
>
> Christian
>
>
>
> --
>
> Christian Schulte, www.gecode.org/~schulte
>
> Professor of Computer Science, KTH, cschulte at kth.se
>
> Expert Researcher, SICS, cschulte at sics.se
>
>
>
> *From:* users-bounces at gecode.org [mailto:users-bounces at gecode.org] *On
> Behalf Of *Fabien Brosseau
> *Sent:* Saturday, September 3, 2016 20:58
> *To:* users at gecode.org
> *Subject:* [gecode-users] Installation
>
>
>
> Hello everyone,
>
> I am trying to use Gecode for a little project but i am not able to make
> it work.
>
> On windows 7 (64 bits) :
>
> i am trying to use it with a Code::Blocks project. But when I try to
> compile a project with an example file, I have some errors :
>
>    - header not working in "x86gcc_rounding_control.hpp" file  "This
>    header only works on x86 CPUs"  -> so why it's called ?
>    - "_forceinline" which doesn't name a type
>
>
>
> On Ubuntu 14.04 :
>
> i get the gecode package and i tried to use it in a qt project.
>
> I have set INCLUDEPATH and LIBS (files are not installed where
> documentation said) but I still have undefined reference errors.
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160913/c6261ab7/attachment-0001.html>

From cschulte at kth.se  Thu Sep 15 17:03:06 2016
From: cschulte at kth.se (Christian Schulte)
Date: Thu, 15 Sep 2016 17:03:06 +0200
Subject: [gecode-users] Cost optimization problem
In-Reply-To: <003501d20dbd$fd2b9e80$f782db80$@mad-environnement.com>
References: <003501d20dbd$fd2b9e80$f782db80$@mad-environnement.com>
Message-ID: <018c01d20f62$43deeb20$cb9cc160$@kth.se>

Hi,

Sorry but I think this is really a modelling issue and not a Gecode issue,
as you have already figured out 3).

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte
Professor of Computer Science, KTH, cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Sebastien Delmotte
Sent: Tuesday, September 13, 2016 14:55
To: users at gecode.org
Subject: [gecode-users] Cost optimization problem

Dear All,

I have a problem with using Gecode to solve an optimization problem.

Problem description:
- I have a recipe with two sub-components. Each component has a coefficient
corresponding to its amount in the recipe. So the sum of the sub-components
coefficients must be equal to 1;
- Each of the two sub-components is composed of several raw materials. Each
raw material has a coefficient corresponding to its amount in its
sub-component. So, for each sub-component, the sum of the raw materials
coefficients is equal to 1;
- At the recipe level, I have some constraints on the raw materials amount
(e.g. raw material 1 must be in a given interval). The amount of each raw
material in the recipe is equal to the product of the coefficient of this
raw material by the coefficient of its sub-component
- I have to minimize the cost of the recipe accounting for the cost of each
raw materials. This cost is equal to the sum of the product of each raw
material coefficient by its unit cost.

Code

#include <gecode/driver.hh>
#include <gecode/int.hh>
#include <gecode/minimodel.hh>
using namespace Gecode;
class Tests : public FloatMinimizeScript? {
protected:
??? FloatVarArray _rms_in_sub_c_1; // raw mat in sub-comp1
??? FloatVarArray _rms_in_sub_c_2; // raw mat in sub-comp2
??? FloatVarArray _sub_c; // 2 sub-comp
??? FloatVar _cost; // cost
public:
??? Tests(const Options& o)
:FloatMinimizeScript(o),_rms_in_sub_c_1(*this,4,0,1),_rms_in_sub_c_2(*this,3
,0,1),_sub_c(*this,2,0,1),_cost(*this,0,1000)
??? {
//sum of raw mat in sub-comp =1
FloatVar all_rms_sub1 = expr(*this,sum(_rms_in_sub_c_1));
rel(*this,all_rms_sub1 ,FRT_EQ,1);
FloatVar all_rms_sub2 = expr(*this,sum(_rms_in_sub_c_2));
rel(*this,all_rms_sub2 ,FRT_EQ,1);
// sum of sub-comp =1
FloatVar sm = expr(*this,sum(_sub_c));
rel(*this,sm ,FRT_EQ,1);
// Global constraints on raw mat in recipe FloatVar rm_0_sub_coef1=
expr(*this,_rms_in_sub_c_1[0]*_sub_c[0]);
rel(*this,rm_0_sub_coef1,FRT_GQ,0);
FloatVar rm_1_sub_coef1= expr(*this,_rms_in_sub_c_1[1]*_sub_c[0]);
rel(*this,rm_1_sub_coef1,FRT_GQ,0);
FloatVar rm_2_sub_coef1= expr(*this,_rms_in_sub_c_1[2]*_sub_c[0]);
rel(*this,rm_2_sub_coef1,FRT_GQ,0);
FloatVar rm_3_sub_coef1= expr(*this,_rms_in_sub_c_1[3]*_sub_c[0]);
rel(*this,rm_3_sub_coef1,FRT_GQ,0);
FloatVar rm_0_sub_coef2= expr(*this,_rms_in_sub_c_2[0]*_sub_c[1]);
rel(*this,rm_0_sub_coef2,FRT_GQ,0);
FloatVar rm_1_sub_coef2= expr(*this,_rms_in_sub_c_2[1]*_sub_c[1]);
rel(*this,rm_1_sub_coef2,FRT_GQ,0);
FloatVar rm_2_sub_coef2= expr(*this,_rms_in_sub_c_2[2]*_sub_c[1]);
rel(*this,rm_2_sub_coef2,FRT_GQ,0);

// Cost
_cost = expr(*this,_sub_c[0]*(_rms_in_sub_c_1[0]*12 +_rms_in_sub_c_1[1]*14 +
_rms_in_sub_c_1[2] * 22 +_rms_in_sub_c_1[3] * 17 )
+_sub_c[1]*(_rms_in_sub_c_2[0]*9 +_rms_in_sub_c_2[1]*2 + 
+_rms_in_sub_c_2[2]
* 18 ));
FloatVarArgs all;
for(int i = 0; i <4; i++) all << _rms_in_sub_c_1[i]; for(int i = 0; i <3;
i++) all << _rms_in_sub_c_2[i]; for(int i = 0; i <2; i++) all << _sub_c[i];

branch(*this, all, FLOAT_VAR_NONE(), FLOAT_VAL_SPLIT_MIN());
??? }

virtual void
print(std::ostream& os) const {
os << "sub-component : " << _sub_c << "\nrms 1 : "<< _rms_in_sub_c_1<<
"\nrms2 : "<< _rms_in_sub_c_2 <<"\ncost : "<< _cost << std::endl;
??? }

virtual FloatVar cost(void) const{
return _cost;
??? }
Tests(bool share, Tests& s) : FloatMinimizeScript(share,s) { _sub_c.update
(*this, share, s._sub_c); _rms_in_sub_c_1.update(*this, share,
s._rms_in_sub_c_1); _rms_in_sub_c_2.update(*this, share, s._rms_in_sub_c_2);
_cost.update(*this, share, s._cost);
??? }

virtual Space*
copy(bool share) {
return new Tests(share,*this);
??? }
};
int main(int argc, char* argv[]) {
Options opt("Test");
opt.solutions(0);
FloatMinimizeScript::run<Tests,BAB,Options>(opt);
return 0;
}

When executing this code, the result is :
sub-component : {0, 1}
rms in sub-component 1 : {0, 0, 0, 1}
rms in sub-component 2 : {0, 0, 1}
cost : [18..18]

Exception: FloatVar::val: Attempt to access value of unassigned variable.

Problems:
1- The resulting solution is trivial but absolutely not optimal for the
cost: only the second sub-component has a positive coefficient (=1) with
only one raw material which is not the cheapest one;
2- In this example, all the constraints for the raw materials are: greater
than 0. But if I change the value of the constraints (e.g. greater than
0.1), I don't get any solution;
3- There is an exception error: FloatVar::val: Attempt to access value of
unassigned variable. This error disappears when I add the variable cost in
the branching, but the solution is still non optimal.

I think I have a problem with handling gecode because the problem is simple,
but I have no idea about the origin of the problem. 
With many thanks in advance.
Best regards,
S.D.



_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4623 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20160915/b4de555a/attachment.bin>

From delmotte at mad-environnement.com  Fri Sep 16 13:08:19 2016
From: delmotte at mad-environnement.com (Sebastien Delmotte)
Date: Fri, 16 Sep 2016 13:08:19 +0200
Subject: [gecode-users] Cost optimization problem
In-Reply-To: <018c01d20f62$43deeb20$cb9cc160$@kth.se>
References: <003501d20dbd$fd2b9e80$f782db80$@mad-environnement.com>
	<018c01d20f62$43deeb20$cb9cc160$@kth.se>
Message-ID: <004601d2100a$a2b676b0$e8236410$@mad-environnement.com>

Dear Christian,

Thank you for your answer.

When I transform all the code from float variables to integer variables (in
changing the constraints from 1 to 100 for example), that works perfectly.
So maybe my implementation for float variables is not good. I will try to
find why.

Best regards,

SD

-----Message d'origine-----
De?: Christian Schulte [mailto:cschulte at kth.se] 
Envoy??: jeudi 15 septembre 2016 17:03
??: 'Sebastien Delmotte'; users at gecode.org
Objet?: RE: [gecode-users] Cost optimization problem

Hi,

Sorry but I think this is really a modelling issue and not a Gecode issue,
as you have already figured out 3).

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte
Professor of Computer Science, KTH, cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Sebastien Delmotte
Sent: Tuesday, September 13, 2016 14:55
To: users at gecode.org
Subject: [gecode-users] Cost optimization problem

Dear All,

I have a problem with using Gecode to solve an optimization problem.

Problem description:
- I have a recipe with two sub-components. Each component has a coefficient
corresponding to its amount in the recipe. So the sum of the sub-components
coefficients must be equal to 1;
- Each of the two sub-components is composed of several raw materials. Each
raw material has a coefficient corresponding to its amount in its
sub-component. So, for each sub-component, the sum of the raw materials
coefficients is equal to 1;
- At the recipe level, I have some constraints on the raw materials amount
(e.g. raw material 1 must be in a given interval). The amount of each raw
material in the recipe is equal to the product of the coefficient of this
raw material by the coefficient of its sub-component
- I have to minimize the cost of the recipe accounting for the cost of each
raw materials. This cost is equal to the sum of the product of each raw
material coefficient by its unit cost.

Code

#include <gecode/driver.hh>
#include <gecode/int.hh>
#include <gecode/minimodel.hh>
using namespace Gecode;
class Tests : public FloatMinimizeScript? {
protected:
??? FloatVarArray _rms_in_sub_c_1; // raw mat in sub-comp1
??? FloatVarArray _rms_in_sub_c_2; // raw mat in sub-comp2
??? FloatVarArray _sub_c; // 2 sub-comp
??? FloatVar _cost; // cost
public:
??? Tests(const Options& o)
:FloatMinimizeScript(o),_rms_in_sub_c_1(*this,4,0,1),_rms_in_sub_c_2(*this,3
,0,1),_sub_c(*this,2,0,1),_cost(*this,0,1000)
??? {
//sum of raw mat in sub-comp =1
FloatVar all_rms_sub1 = expr(*this,sum(_rms_in_sub_c_1));
rel(*this,all_rms_sub1 ,FRT_EQ,1);
FloatVar all_rms_sub2 = expr(*this,sum(_rms_in_sub_c_2));
rel(*this,all_rms_sub2 ,FRT_EQ,1);
// sum of sub-comp =1
FloatVar sm = expr(*this,sum(_sub_c));
rel(*this,sm ,FRT_EQ,1);
// Global constraints on raw mat in recipe FloatVar rm_0_sub_coef1=
expr(*this,_rms_in_sub_c_1[0]*_sub_c[0]);
rel(*this,rm_0_sub_coef1,FRT_GQ,0);
FloatVar rm_1_sub_coef1= expr(*this,_rms_in_sub_c_1[1]*_sub_c[0]);
rel(*this,rm_1_sub_coef1,FRT_GQ,0);
FloatVar rm_2_sub_coef1= expr(*this,_rms_in_sub_c_1[2]*_sub_c[0]);
rel(*this,rm_2_sub_coef1,FRT_GQ,0);
FloatVar rm_3_sub_coef1= expr(*this,_rms_in_sub_c_1[3]*_sub_c[0]);
rel(*this,rm_3_sub_coef1,FRT_GQ,0);
FloatVar rm_0_sub_coef2= expr(*this,_rms_in_sub_c_2[0]*_sub_c[1]);
rel(*this,rm_0_sub_coef2,FRT_GQ,0);
FloatVar rm_1_sub_coef2= expr(*this,_rms_in_sub_c_2[1]*_sub_c[1]);
rel(*this,rm_1_sub_coef2,FRT_GQ,0);
FloatVar rm_2_sub_coef2= expr(*this,_rms_in_sub_c_2[2]*_sub_c[1]);
rel(*this,rm_2_sub_coef2,FRT_GQ,0);

// Cost
_cost = expr(*this,_sub_c[0]*(_rms_in_sub_c_1[0]*12 +_rms_in_sub_c_1[1]*14 +
_rms_in_sub_c_1[2] * 22 +_rms_in_sub_c_1[3] * 17 )
+_sub_c[1]*(_rms_in_sub_c_2[0]*9 +_rms_in_sub_c_2[1]*2 + 
+_rms_in_sub_c_2[2]
* 18 ));
FloatVarArgs all;
for(int i = 0; i <4; i++) all << _rms_in_sub_c_1[i]; for(int i = 0; i <3;
i++) all << _rms_in_sub_c_2[i]; for(int i = 0; i <2; i++) all << _sub_c[i];

branch(*this, all, FLOAT_VAR_NONE(), FLOAT_VAL_SPLIT_MIN());
??? }

virtual void
print(std::ostream& os) const {
os << "sub-component : " << _sub_c << "\nrms 1 : "<< _rms_in_sub_c_1<<
"\nrms2 : "<< _rms_in_sub_c_2 <<"\ncost : "<< _cost << std::endl;
??? }

virtual FloatVar cost(void) const{
return _cost;
??? }
Tests(bool share, Tests& s) : FloatMinimizeScript(share,s) { _sub_c.update
(*this, share, s._sub_c); _rms_in_sub_c_1.update(*this, share,
s._rms_in_sub_c_1); _rms_in_sub_c_2.update(*this, share, s._rms_in_sub_c_2);
_cost.update(*this, share, s._cost);
??? }

virtual Space*
copy(bool share) {
return new Tests(share,*this);
??? }
};
int main(int argc, char* argv[]) {
Options opt("Test");
opt.solutions(0);
FloatMinimizeScript::run<Tests,BAB,Options>(opt);
return 0;
}

When executing this code, the result is :
sub-component : {0, 1}
rms in sub-component 1 : {0, 0, 0, 1}
rms in sub-component 2 : {0, 0, 1}
cost : [18..18]

Exception: FloatVar::val: Attempt to access value of unassigned variable.

Problems:
1- The resulting solution is trivial but absolutely not optimal for the
cost: only the second sub-component has a positive coefficient (=1) with
only one raw material which is not the cheapest one;
2- In this example, all the constraints for the raw materials are: greater
than 0. But if I change the value of the constraints (e.g. greater than
0.1), I don't get any solution;
3- There is an exception error: FloatVar::val: Attempt to access value of
unassigned variable. This error disappears when I add the variable cost in
the branching, but the solution is still non optimal.

I think I have a problem with handling gecode because the problem is simple,
but I have no idea about the origin of the problem. 
With many thanks in advance.
Best regards,
S.D.



_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From cschulte at kth.se  Fri Sep 16 13:17:46 2016
From: cschulte at kth.se (Christian Schulte)
Date: Fri, 16 Sep 2016 13:17:46 +0200
Subject: [gecode-users] Cost optimization problem
In-Reply-To: <004601d2100a$a2b676b0$e8236410$@mad-environnement.com>
References: <003501d20dbd$fd2b9e80$f782db80$@mad-environnement.com>	<018c01d20f62$43deeb20$cb9cc160$@kth.se>
	<004601d2100a$a2b676b0$e8236410$@mad-environnement.com>
Message-ID: <000401d2100b$f45c73b0$dd155b10$@kth.se>

Hi,

That's strange... Did you try to play with the step value as explained in
MPG 7.3?

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte
Professor of Computer Science, KTH, cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se

-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Sebastien Delmotte
Sent: Friday, September 16, 2016 13:08
To: cschulte at kth.se; users at gecode.org
Subject: Re: [gecode-users] Cost optimization problem

Dear Christian,

Thank you for your answer.

When I transform all the code from float variables to integer variables (in
changing the constraints from 1 to 100 for example), that works perfectly.
So maybe my implementation for float variables is not good. I will try to
find why.

Best regards,

SD

-----Message d'origine-----
De?: Christian Schulte [mailto:cschulte at kth.se] Envoy??: jeudi 15 septembre
2016 17:03 ??: 'Sebastien Delmotte'; users at gecode.org Objet?: RE:
[gecode-users] Cost optimization problem

Hi,

Sorry but I think this is really a modelling issue and not a Gecode issue,
as you have already figured out 3).

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte Professor of Computer Science,
KTH, cschulte at kth.se Expert Researcher, SICS, cschulte at sics.se


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Sebastien Delmotte
Sent: Tuesday, September 13, 2016 14:55
To: users at gecode.org
Subject: [gecode-users] Cost optimization problem

Dear All,

I have a problem with using Gecode to solve an optimization problem.

Problem description:
- I have a recipe with two sub-components. Each component has a coefficient
corresponding to its amount in the recipe. So the sum of the sub-components
coefficients must be equal to 1;
- Each of the two sub-components is composed of several raw materials. Each
raw material has a coefficient corresponding to its amount in its
sub-component. So, for each sub-component, the sum of the raw materials
coefficients is equal to 1;
- At the recipe level, I have some constraints on the raw materials amount
(e.g. raw material 1 must be in a given interval). The amount of each raw
material in the recipe is equal to the product of the coefficient of this
raw material by the coefficient of its sub-component
- I have to minimize the cost of the recipe accounting for the cost of each
raw materials. This cost is equal to the sum of the product of each raw
material coefficient by its unit cost.

Code

#include <gecode/driver.hh>
#include <gecode/int.hh>
#include <gecode/minimodel.hh>
using namespace Gecode;
class Tests : public FloatMinimizeScript? {
protected:
??? FloatVarArray _rms_in_sub_c_1; // raw mat in sub-comp1
??? FloatVarArray _rms_in_sub_c_2; // raw mat in sub-comp2
??? FloatVarArray _sub_c; // 2 sub-comp
??? FloatVar _cost; // cost
public:
??? Tests(const Options& o)
:FloatMinimizeScript(o),_rms_in_sub_c_1(*this,4,0,1),_rms_in_sub_c_2(*this,3
,0,1),_sub_c(*this,2,0,1),_cost(*this,0,1000)
??? {
//sum of raw mat in sub-comp =1
FloatVar all_rms_sub1 = expr(*this,sum(_rms_in_sub_c_1));
rel(*this,all_rms_sub1 ,FRT_EQ,1);
FloatVar all_rms_sub2 = expr(*this,sum(_rms_in_sub_c_2));
rel(*this,all_rms_sub2 ,FRT_EQ,1);
// sum of sub-comp =1
FloatVar sm = expr(*this,sum(_sub_c));
rel(*this,sm ,FRT_EQ,1);
// Global constraints on raw mat in recipe FloatVar rm_0_sub_coef1=
expr(*this,_rms_in_sub_c_1[0]*_sub_c[0]);
rel(*this,rm_0_sub_coef1,FRT_GQ,0);
FloatVar rm_1_sub_coef1= expr(*this,_rms_in_sub_c_1[1]*_sub_c[0]);
rel(*this,rm_1_sub_coef1,FRT_GQ,0);
FloatVar rm_2_sub_coef1= expr(*this,_rms_in_sub_c_1[2]*_sub_c[0]);
rel(*this,rm_2_sub_coef1,FRT_GQ,0);
FloatVar rm_3_sub_coef1= expr(*this,_rms_in_sub_c_1[3]*_sub_c[0]);
rel(*this,rm_3_sub_coef1,FRT_GQ,0);
FloatVar rm_0_sub_coef2= expr(*this,_rms_in_sub_c_2[0]*_sub_c[1]);
rel(*this,rm_0_sub_coef2,FRT_GQ,0);
FloatVar rm_1_sub_coef2= expr(*this,_rms_in_sub_c_2[1]*_sub_c[1]);
rel(*this,rm_1_sub_coef2,FRT_GQ,0);
FloatVar rm_2_sub_coef2= expr(*this,_rms_in_sub_c_2[2]*_sub_c[1]);
rel(*this,rm_2_sub_coef2,FRT_GQ,0);

// Cost
_cost = expr(*this,_sub_c[0]*(_rms_in_sub_c_1[0]*12 +_rms_in_sub_c_1[1]*14 +
_rms_in_sub_c_1[2] * 22 +_rms_in_sub_c_1[3] * 17 )
+_sub_c[1]*(_rms_in_sub_c_2[0]*9 +_rms_in_sub_c_2[1]*2 + 
+_rms_in_sub_c_2[2]
* 18 ));
FloatVarArgs all;
for(int i = 0; i <4; i++) all << _rms_in_sub_c_1[i]; for(int i = 0; i <3;
i++) all << _rms_in_sub_c_2[i]; for(int i = 0; i <2; i++) all << 
i++_sub_c[i];

branch(*this, all, FLOAT_VAR_NONE(), FLOAT_VAL_SPLIT_MIN());
??? }

virtual void
print(std::ostream& os) const {
os << "sub-component : " << _sub_c << "\nrms 1 : "<< _rms_in_sub_c_1<<
"\nrms2 : "<< _rms_in_sub_c_2 <<"\ncost : "<< _cost << std::endl;
??? }

virtual FloatVar cost(void) const{
return _cost;
??? }
Tests(bool share, Tests& s) : FloatMinimizeScript(share,s) { _sub_c.update
(*this, share, s._sub_c); _rms_in_sub_c_1.update(*this, share,
s._rms_in_sub_c_1); _rms_in_sub_c_2.update(*this, share, s._rms_in_sub_c_2);
_cost.update(*this, share, s._cost);
??? }

virtual Space*
copy(bool share) {
return new Tests(share,*this);
??? }
};
int main(int argc, char* argv[]) {
Options opt("Test");
opt.solutions(0);
FloatMinimizeScript::run<Tests,BAB,Options>(opt);
return 0;
}

When executing this code, the result is :
sub-component : {0, 1}
rms in sub-component 1 : {0, 0, 0, 1}
rms in sub-component 2 : {0, 0, 1}
cost : [18..18]

Exception: FloatVar::val: Attempt to access value of unassigned variable.

Problems:
1- The resulting solution is trivial but absolutely not optimal for the
cost: only the second sub-component has a positive coefficient (=1) with
only one raw material which is not the cheapest one;
2- In this example, all the constraints for the raw materials are: greater
than 0. But if I change the value of the constraints (e.g. greater than
0.1), I don't get any solution;
3- There is an exception error: FloatVar::val: Attempt to access value of
unassigned variable. This error disappears when I add the variable cost in
the branching, but the solution is still non optimal.

I think I have a problem with handling gecode because the problem is simple,
but I have no idea about the origin of the problem. 
With many thanks in advance.
Best regards,
S.D.



_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4599 bytes
Desc: not available
URL: <http://www.gecode.org/pipermail/users/attachments/20160916/532d2257/attachment.bin>

From delmotte at mad-environnement.com  Tue Sep 20 10:36:45 2016
From: delmotte at mad-environnement.com (Sebastien Delmotte)
Date: Tue, 20 Sep 2016 10:36:45 +0200
Subject: [gecode-users] Cost optimization problem
In-Reply-To: <000401d2100b$f45c73b0$dd155b10$@kth.se>
References: <003501d20dbd$fd2b9e80$f782db80$@mad-environnement.com>	<018c01d20f62$43deeb20$cb9cc160$@kth.se>
	<004601d2100a$a2b676b0$e8236410$@mad-environnement.com>
	<000401d2100b$f45c73b0$dd155b10$@kth.se>
Message-ID: <004d01d2131a$1f5de3d0$5e19ab70$@mad-environnement.com>

Dear Christian,

I've tried to play with the step value but it doesn't change anything. An
exception related to an unassigned variable (cost) still occurs and it
prevents the search to be processed. I really don't understand why it works
with exactly the same code with floats converted to integers, but I surely
don't use correctly the gecode options. 

I think I will continue with integers for the moment.

Thank you very much.

S. D.

-----Message d'origine-----
De?: Christian Schulte [mailto:cschulte at kth.se] 
Envoy??: vendredi 16 septembre 2016 13:18
??: 'Sebastien Delmotte'; users at gecode.org
Objet?: RE: [gecode-users] Cost optimization problem

Hi,

That's strange... Did you try to play with the step value as explained in
MPG 7.3?

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte
Professor of Computer Science, KTH, cschulte at kth.se
Expert Researcher, SICS, cschulte at sics.se

-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Sebastien Delmotte
Sent: Friday, September 16, 2016 13:08
To: cschulte at kth.se; users at gecode.org
Subject: Re: [gecode-users] Cost optimization problem

Dear Christian,

Thank you for your answer.

When I transform all the code from float variables to integer variables (in
changing the constraints from 1 to 100 for example), that works perfectly.
So maybe my implementation for float variables is not good. I will try to
find why.

Best regards,

SD

-----Message d'origine-----
De?: Christian Schulte [mailto:cschulte at kth.se] Envoy??: jeudi 15 septembre
2016 17:03 ??: 'Sebastien Delmotte'; users at gecode.org Objet?: RE:
[gecode-users] Cost optimization problem

Hi,

Sorry but I think this is really a modelling issue and not a Gecode issue,
as you have already figured out 3).

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte Professor of Computer Science,
KTH, cschulte at kth.se Expert Researcher, SICS, cschulte at sics.se


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Sebastien Delmotte
Sent: Tuesday, September 13, 2016 14:55
To: users at gecode.org
Subject: [gecode-users] Cost optimization problem

Dear All,

I have a problem with using Gecode to solve an optimization problem.

Problem description:
- I have a recipe with two sub-components. Each component has a coefficient
corresponding to its amount in the recipe. So the sum of the sub-components
coefficients must be equal to 1;
- Each of the two sub-components is composed of several raw materials. Each
raw material has a coefficient corresponding to its amount in its
sub-component. So, for each sub-component, the sum of the raw materials
coefficients is equal to 1;
- At the recipe level, I have some constraints on the raw materials amount
(e.g. raw material 1 must be in a given interval). The amount of each raw
material in the recipe is equal to the product of the coefficient of this
raw material by the coefficient of its sub-component
- I have to minimize the cost of the recipe accounting for the cost of each
raw materials. This cost is equal to the sum of the product of each raw
material coefficient by its unit cost.

Code

#include <gecode/driver.hh>
#include <gecode/int.hh>
#include <gecode/minimodel.hh>
using namespace Gecode;
class Tests : public FloatMinimizeScript? {
protected:
??? FloatVarArray _rms_in_sub_c_1; // raw mat in sub-comp1
??? FloatVarArray _rms_in_sub_c_2; // raw mat in sub-comp2
??? FloatVarArray _sub_c; // 2 sub-comp
??? FloatVar _cost; // cost
public:
??? Tests(const Options& o)
:FloatMinimizeScript(o),_rms_in_sub_c_1(*this,4,0,1),_rms_in_sub_c_2(*this,3
,0,1),_sub_c(*this,2,0,1),_cost(*this,0,1000)
??? {
//sum of raw mat in sub-comp =1
FloatVar all_rms_sub1 = expr(*this,sum(_rms_in_sub_c_1));
rel(*this,all_rms_sub1 ,FRT_EQ,1);
FloatVar all_rms_sub2 = expr(*this,sum(_rms_in_sub_c_2));
rel(*this,all_rms_sub2 ,FRT_EQ,1);
// sum of sub-comp =1
FloatVar sm = expr(*this,sum(_sub_c));
rel(*this,sm ,FRT_EQ,1);
// Global constraints on raw mat in recipe FloatVar rm_0_sub_coef1=
expr(*this,_rms_in_sub_c_1[0]*_sub_c[0]);
rel(*this,rm_0_sub_coef1,FRT_GQ,0);
FloatVar rm_1_sub_coef1= expr(*this,_rms_in_sub_c_1[1]*_sub_c[0]);
rel(*this,rm_1_sub_coef1,FRT_GQ,0);
FloatVar rm_2_sub_coef1= expr(*this,_rms_in_sub_c_1[2]*_sub_c[0]);
rel(*this,rm_2_sub_coef1,FRT_GQ,0);
FloatVar rm_3_sub_coef1= expr(*this,_rms_in_sub_c_1[3]*_sub_c[0]);
rel(*this,rm_3_sub_coef1,FRT_GQ,0);
FloatVar rm_0_sub_coef2= expr(*this,_rms_in_sub_c_2[0]*_sub_c[1]);
rel(*this,rm_0_sub_coef2,FRT_GQ,0);
FloatVar rm_1_sub_coef2= expr(*this,_rms_in_sub_c_2[1]*_sub_c[1]);
rel(*this,rm_1_sub_coef2,FRT_GQ,0);
FloatVar rm_2_sub_coef2= expr(*this,_rms_in_sub_c_2[2]*_sub_c[1]);
rel(*this,rm_2_sub_coef2,FRT_GQ,0);

// Cost
_cost = expr(*this,_sub_c[0]*(_rms_in_sub_c_1[0]*12 +_rms_in_sub_c_1[1]*14 +
_rms_in_sub_c_1[2] * 22 +_rms_in_sub_c_1[3] * 17 )
+_sub_c[1]*(_rms_in_sub_c_2[0]*9 +_rms_in_sub_c_2[1]*2 + 
+_rms_in_sub_c_2[2]
* 18 ));
FloatVarArgs all;
for(int i = 0; i <4; i++) all << _rms_in_sub_c_1[i]; for(int i = 0; i <3;
i++) all << _rms_in_sub_c_2[i]; for(int i = 0; i <2; i++) all << 
i++_sub_c[i];

branch(*this, all, FLOAT_VAR_NONE(), FLOAT_VAL_SPLIT_MIN());
??? }

virtual void
print(std::ostream& os) const {
os << "sub-component : " << _sub_c << "\nrms 1 : "<< _rms_in_sub_c_1<<
"\nrms2 : "<< _rms_in_sub_c_2 <<"\ncost : "<< _cost << std::endl;
??? }

virtual FloatVar cost(void) const{
return _cost;
??? }
Tests(bool share, Tests& s) : FloatMinimizeScript(share,s) { _sub_c.update
(*this, share, s._sub_c); _rms_in_sub_c_1.update(*this, share,
s._rms_in_sub_c_1); _rms_in_sub_c_2.update(*this, share, s._rms_in_sub_c_2);
_cost.update(*this, share, s._cost);
??? }

virtual Space*
copy(bool share) {
return new Tests(share,*this);
??? }
};
int main(int argc, char* argv[]) {
Options opt("Test");
opt.solutions(0);
FloatMinimizeScript::run<Tests,BAB,Options>(opt);
return 0;
}

When executing this code, the result is :
sub-component : {0, 1}
rms in sub-component 1 : {0, 0, 0, 1}
rms in sub-component 2 : {0, 0, 1}
cost : [18..18]

Exception: FloatVar::val: Attempt to access value of unassigned variable.

Problems:
1- The resulting solution is trivial but absolutely not optimal for the
cost: only the second sub-component has a positive coefficient (=1) with
only one raw material which is not the cheapest one;
2- In this example, all the constraints for the raw materials are: greater
than 0. But if I change the value of the constraints (e.g. greater than
0.1), I don't get any solution;
3- There is an exception error: FloatVar::val: Attempt to access value of
unassigned variable. This error disappears when I add the variable cost in
the branching, but the solution is still non optimal.

I think I have a problem with handling gecode because the problem is simple,
but I have no idea about the origin of the problem. 
With many thanks in advance.
Best regards,
S.D.



_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From delmotte at mad-environnement.com  Thu Sep 22 11:59:02 2016
From: delmotte at mad-environnement.com (Sebastien Delmotte)
Date: Thu, 22 Sep 2016 11:59:02 +0200
Subject: [gecode-users] Cost optimization problem
In-Reply-To: <004d01d2131a$1f5de3d0$5e19ab70$@mad-environnement.com>
References: <003501d20dbd$fd2b9e80$f782db80$@mad-environnement.com>	<018c01d20f62$43deeb20$cb9cc160$@kth.se>	<004601d2100a$a2b676b0$e8236410$@mad-environnement.com>	<000401d2100b$f45c73b0$dd155b10$@kth.se>
	<004d01d2131a$1f5de3d0$5e19ab70$@mad-environnement.com>
Message-ID: <007201d214b7$f3a8c3a0$dafa4ae0$@mad-environnement.com>

Dear All,

I'm back with my issue of cost optimization with float variables.

I can't solve my problem with integers because : (i) the transformation of
my model from float to integer makes me using coefficients with high value
which cause the overtaking of int size; (ii) even with smaller values, the
time of optimization is around 11h20 for optimizing only 6 coefficients (and
I have more to optimize).

So, I've tested another example: (i)  I've taken the Hakank diet code
(http://www.hakank.org/gecode/) written with integer variables; (ii) I've
transformed the code to solve the model with float variables instead of
integer variables.

The result is similar than with my model: an exception occurs about
"unassigned variable" which is probably the cost variable. (I put the code
at the end of this message).

So it seems that the issue is not a modelling one. Do you have an idea about
the origin of this exception which occurs with the two models I've tested?

Do you known some other float optimization examples which are solved with
gecode?

Thank you in advance.

Best regards,

S. D.

Adapted Hakank Code:

#include <gecode/driver.hh>
#include <gecode/float.hh>
#include <gecode/minimodel.hh>

using namespace Gecode;


class Tests : public FloatMinimizeScript  {
protected:
    FloatVarArray x;          // amount of each product
    FloatVar t_cost;          // total cost to minimize
    static const int n = 4; // number of products

public:

    Tests(const Options& o) :FloatMinimizeScript(o),
        x(*this, n, 0, 1000),
        t_cost(*this, 0, 1000)
    {

        float _price[]  = { 50.f, 20.f, 30.f, 80.f}; // in cents
        float limits[]  = {500.f,  6.f, 10.f,  8.f}; // requirements for
each nutrition type

        // nutritions for each product
        float _calories[]  = {400.f, 200.f, 150.f, 500.f};
        float _chocolate[] = {  3.f,   2.f,   0.f,   0.f};
        float _sugar[]     = {  2.f,   2.f,   4.f,   4.f};
        float _fat[]       = {  2.f,   4.f,   1.f,   5.f};

        FloatVarArgs v_calories;
        FloatVarArgs v_chocolate;
        FloatVarArgs v_fat;
        FloatVarArgs v_sugar;
        FloatVarArgs v_costs;
        for(int i = 0;i<4;++i)
        {
            v_calories << expr(*this,x[i]*_calories[i]);
            v_chocolate << expr(*this,x[i]*_chocolate[i]);
            v_fat << expr(*this,x[i]*_fat[i]);
            v_sugar << expr(*this,x[i]*_sugar[i]);
            v_costs << expr(*this,x[i]*_price[i]);
        }
        rel(*this,expr(*this,sum(v_calories)),FRT_GQ,limits[0]);
        rel(*this,expr(*this,sum(v_chocolate)),FRT_GQ,limits[1]);
        rel(*this,expr(*this,sum(v_sugar)),FRT_GQ,limits[2]);
        rel(*this,expr(*this,sum(v_fat)),FRT_GQ,limits[3]);
        t_cost = expr(*this,sum(v_costs));

        branch(*this, x, FLOAT_VAR_NONE(), FLOAT_VAL_SPLIT_MIN());

    }

    // Prfloat solution
    virtual void
    prfloat(std::ostream& os) const {
        os << "\t" << x << " t_cost: " << t_cost << std::endl;
    }

    virtual FloatVar cost(void) const{
        return t_cost;
    }

    Tests(bool share, Tests& s) : FloatMinimizeScript(share,s) {
        x.update(*this, share, s.x);
        t_cost.update(*this, share, s.t_cost);
    }

    virtual Space*
    copy(bool share) {
        return new Tests(share,*this);
    }
};


float main(float argc, char* argv[]) {

    Options opt("Test");
    opt.solutions(1e9);
    //opt.threads(8);
    FloatMinimizeScript::run<Tests,BAB,Options>(opt);
    return 0;
}


-----Message d'origine-----
De?: users-bounces at gecode.org [mailto:users-bounces at gecode.org] De la part
de Sebastien Delmotte
Envoy??: mardi 20 septembre 2016 10:37
??: cschulte at kth.se
Cc?: users at gecode.org
Objet?: Re: [gecode-users] Cost optimization problem

Dear Christian,

I've tried to play with the step value but it doesn't change anything. An
exception related to an unassigned variable (cost) still occurs and it
prevents the search to be processed. I really don't understand why it works
with exactly the same code with floats converted to integers, but I surely
don't use correctly the gecode options. 

I think I will continue with integers for the moment.

Thank you very much.

S. D.

-----Message d'origine-----
De?: Christian Schulte [mailto:cschulte at kth.se] Envoy??: vendredi 16
septembre 2016 13:18 ??: 'Sebastien Delmotte'; users at gecode.org Objet?: RE:
[gecode-users] Cost optimization problem

Hi,

That's strange... Did you try to play with the step value as explained in
MPG 7.3?

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte Professor of Computer Science,
KTH, cschulte at kth.se Expert Researcher, SICS, cschulte at sics.se

-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Sebastien Delmotte
Sent: Friday, September 16, 2016 13:08
To: cschulte at kth.se; users at gecode.org
Subject: Re: [gecode-users] Cost optimization problem

Dear Christian,

Thank you for your answer.

When I transform all the code from float variables to integer variables (in
changing the constraints from 1 to 100 for example), that works perfectly.
So maybe my implementation for float variables is not good. I will try to
find why.

Best regards,

SD

-----Message d'origine-----
De?: Christian Schulte [mailto:cschulte at kth.se] Envoy??: jeudi 15 septembre
2016 17:03 ??: 'Sebastien Delmotte'; users at gecode.org Objet?: RE:
[gecode-users] Cost optimization problem

Hi,

Sorry but I think this is really a modelling issue and not a Gecode issue,
as you have already figured out 3).

Cheers
Christian

--
Christian Schulte, www.gecode.org/~schulte Professor of Computer Science,
KTH, cschulte at kth.se Expert Researcher, SICS, cschulte at sics.se


-----Original Message-----
From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
Of Sebastien Delmotte
Sent: Tuesday, September 13, 2016 14:55
To: users at gecode.org
Subject: [gecode-users] Cost optimization problem

Dear All,

I have a problem with using Gecode to solve an optimization problem.

Problem description:
- I have a recipe with two sub-components. Each component has a coefficient
corresponding to its amount in the recipe. So the sum of the sub-components
coefficients must be equal to 1;
- Each of the two sub-components is composed of several raw materials. Each
raw material has a coefficient corresponding to its amount in its
sub-component. So, for each sub-component, the sum of the raw materials
coefficients is equal to 1;
- At the recipe level, I have some constraints on the raw materials amount
(e.g. raw material 1 must be in a given interval). The amount of each raw
material in the recipe is equal to the product of the coefficient of this
raw material by the coefficient of its sub-component
- I have to minimize the cost of the recipe accounting for the cost of each
raw materials. This cost is equal to the sum of the product of each raw
material coefficient by its unit cost.

Code

#include <gecode/driver.hh>
#include <gecode/int.hh>
#include <gecode/minimodel.hh>
using namespace Gecode;
class Tests : public FloatMinimizeScript? {
protected:
??? FloatVarArray _rms_in_sub_c_1; // raw mat in sub-comp1
??? FloatVarArray _rms_in_sub_c_2; // raw mat in sub-comp2
??? FloatVarArray _sub_c; // 2 sub-comp
??? FloatVar _cost; // cost
public:
??? Tests(const Options& o)
:FloatMinimizeScript(o),_rms_in_sub_c_1(*this,4,0,1),_rms_in_sub_c_2(*this,3
,0,1),_sub_c(*this,2,0,1),_cost(*this,0,1000)
??? {
//sum of raw mat in sub-comp =1
FloatVar all_rms_sub1 = expr(*this,sum(_rms_in_sub_c_1));
rel(*this,all_rms_sub1 ,FRT_EQ,1);
FloatVar all_rms_sub2 = expr(*this,sum(_rms_in_sub_c_2));
rel(*this,all_rms_sub2 ,FRT_EQ,1);
// sum of sub-comp =1
FloatVar sm = expr(*this,sum(_sub_c));
rel(*this,sm ,FRT_EQ,1);
// Global constraints on raw mat in recipe FloatVar rm_0_sub_coef1=
expr(*this,_rms_in_sub_c_1[0]*_sub_c[0]);
rel(*this,rm_0_sub_coef1,FRT_GQ,0);
FloatVar rm_1_sub_coef1= expr(*this,_rms_in_sub_c_1[1]*_sub_c[0]);
rel(*this,rm_1_sub_coef1,FRT_GQ,0);
FloatVar rm_2_sub_coef1= expr(*this,_rms_in_sub_c_1[2]*_sub_c[0]);
rel(*this,rm_2_sub_coef1,FRT_GQ,0);
FloatVar rm_3_sub_coef1= expr(*this,_rms_in_sub_c_1[3]*_sub_c[0]);
rel(*this,rm_3_sub_coef1,FRT_GQ,0);
FloatVar rm_0_sub_coef2= expr(*this,_rms_in_sub_c_2[0]*_sub_c[1]);
rel(*this,rm_0_sub_coef2,FRT_GQ,0);
FloatVar rm_1_sub_coef2= expr(*this,_rms_in_sub_c_2[1]*_sub_c[1]);
rel(*this,rm_1_sub_coef2,FRT_GQ,0);
FloatVar rm_2_sub_coef2= expr(*this,_rms_in_sub_c_2[2]*_sub_c[1]);
rel(*this,rm_2_sub_coef2,FRT_GQ,0);

// Cost
_cost = expr(*this,_sub_c[0]*(_rms_in_sub_c_1[0]*12 +_rms_in_sub_c_1[1]*14 +
_rms_in_sub_c_1[2] * 22 +_rms_in_sub_c_1[3] * 17 )
+_sub_c[1]*(_rms_in_sub_c_2[0]*9 +_rms_in_sub_c_2[1]*2 + 
+_rms_in_sub_c_2[2]
* 18 ));
FloatVarArgs all;
for(int i = 0; i <4; i++) all << _rms_in_sub_c_1[i]; for(int i = 0; i <3;
i++) all << _rms_in_sub_c_2[i]; for(int i = 0; i <2; i++) all << 
i++_sub_c[i];

branch(*this, all, FLOAT_VAR_NONE(), FLOAT_VAL_SPLIT_MIN());
??? }

virtual void
print(std::ostream& os) const {
os << "sub-component : " << _sub_c << "\nrms 1 : "<< _rms_in_sub_c_1<<
"\nrms2 : "<< _rms_in_sub_c_2 <<"\ncost : "<< _cost << std::endl;
??? }

virtual FloatVar cost(void) const{
return _cost;
??? }
Tests(bool share, Tests& s) : FloatMinimizeScript(share,s) { _sub_c.update
(*this, share, s._sub_c); _rms_in_sub_c_1.update(*this, share,
s._rms_in_sub_c_1); _rms_in_sub_c_2.update(*this, share, s._rms_in_sub_c_2);
_cost.update(*this, share, s._cost);
??? }

virtual Space*
copy(bool share) {
return new Tests(share,*this);
??? }
};
int main(int argc, char* argv[]) {
Options opt("Test");
opt.solutions(0);
FloatMinimizeScript::run<Tests,BAB,Options>(opt);
return 0;
}

When executing this code, the result is :
sub-component : {0, 1}
rms in sub-component 1 : {0, 0, 0, 1}
rms in sub-component 2 : {0, 0, 1}
cost : [18..18]

Exception: FloatVar::val: Attempt to access value of unassigned variable.

Problems:
1- The resulting solution is trivial but absolutely not optimal for the
cost: only the second sub-component has a positive coefficient (=1) with
only one raw material which is not the cheapest one;
2- In this example, all the constraints for the raw materials are: greater
than 0. But if I change the value of the constraints (e.g. greater than
0.1), I don't get any solution;
3- There is an exception error: FloatVar::val: Attempt to access value of
unassigned variable. This error disappears when I add the variable cost in
the branching, but the solution is still non optimal.

I think I have a problem with handling gecode because the problem is simple,
but I have no idea about the origin of the problem. 
With many thanks in advance.
Best regards,
S.D.



_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users


_______________________________________________
Gecode users mailing list
users at gecode.org
https://www.gecode.org/mailman/listinfo/gecode-users



From guido.tack at monash.edu  Fri Sep 23 00:58:56 2016
From: guido.tack at monash.edu (Guido Tack)
Date: Fri, 23 Sep 2016 08:58:56 +1000
Subject: [gecode-users] Cost optimization problem
In-Reply-To: <007201d214b7$f3a8c3a0$dafa4ae0$@mad-environnement.com>
References: <003501d20dbd$fd2b9e80$f782db80$@mad-environnement.com>
	<018c01d20f62$43deeb20$cb9cc160$@kth.se>
	<004601d2100a$a2b676b0$e8236410$@mad-environnement.com>
	<000401d2100b$f45c73b0$dd155b10$@kth.se>
	<004d01d2131a$1f5de3d0$5e19ab70$@mad-environnement.com>
	<007201d214b7$f3a8c3a0$dafa4ae0$@mad-environnement.com>
Message-ID: <B05DCB71-70BF-401E-BEBE-A5922A46B15C@monash.edu>

I think the problem here is that you?re not branching over the cost variable.  With float variables, it?s not guaranteed that just because all x[i] are assigned (i.e., restricted to the smallest possible interval!), the result of c[i]*x[i] will also be assigned.  So you need to branch on the result, in this case on t_cost.

Cheers,
Guido

-- 
GUIDO TACK                  
Senior Lecturer

Information Technology
Monash University
Level 6, Room 6.40, Building H, Caulfield Campus
900 Dandenong Road
Caulfield East VIC 3145
Australia

T: +61 3 9903 1214                      
E: guido.tack at monash.edu <mailto:guido.tack at monash.edu>
http://www.csse.monash.edu/~guidot/ <http://www.csse.monash.edu/~guidot/>


> On 22 Sep. 2016, at 7:59 pm, Sebastien Delmotte <delmotte at mad-environnement.com> wrote:
> 
> Dear All,
> 
> I'm back with my issue of cost optimization with float variables.
> 
> I can't solve my problem with integers because : (i) the transformation of
> my model from float to integer makes me using coefficients with high value
> which cause the overtaking of int size; (ii) even with smaller values, the
> time of optimization is around 11h20 for optimizing only 6 coefficients (and
> I have more to optimize).
> 
> So, I've tested another example: (i)  I've taken the Hakank diet code
> (http://www.hakank.org/gecode/) written with integer variables; (ii) I've
> transformed the code to solve the model with float variables instead of
> integer variables.
> 
> The result is similar than with my model: an exception occurs about
> "unassigned variable" which is probably the cost variable. (I put the code
> at the end of this message).
> 
> So it seems that the issue is not a modelling one. Do you have an idea about
> the origin of this exception which occurs with the two models I've tested?
> 
> Do you known some other float optimization examples which are solved with
> gecode?
> 
> Thank you in advance.
> 
> Best regards,
> 
> S. D.
> 
> Adapted Hakank Code:
> 
> #include <gecode/driver.hh>
> #include <gecode/float.hh>
> #include <gecode/minimodel.hh>
> 
> using namespace Gecode;
> 
> 
> class Tests : public FloatMinimizeScript  {
> protected:
>    FloatVarArray x;          // amount of each product
>    FloatVar t_cost;          // total cost to minimize
>    static const int n = 4; // number of products
> 
> public:
> 
>    Tests(const Options& o) :FloatMinimizeScript(o),
>        x(*this, n, 0, 1000),
>        t_cost(*this, 0, 1000)
>    {
> 
>        float _price[]  = { 50.f, 20.f, 30.f, 80.f}; // in cents
>        float limits[]  = {500.f,  6.f, 10.f,  8.f}; // requirements for
> each nutrition type
> 
>        // nutritions for each product
>        float _calories[]  = {400.f, 200.f, 150.f, 500.f};
>        float _chocolate[] = {  3.f,   2.f,   0.f,   0.f};
>        float _sugar[]     = {  2.f,   2.f,   4.f,   4.f};
>        float _fat[]       = {  2.f,   4.f,   1.f,   5.f};
> 
>        FloatVarArgs v_calories;
>        FloatVarArgs v_chocolate;
>        FloatVarArgs v_fat;
>        FloatVarArgs v_sugar;
>        FloatVarArgs v_costs;
>        for(int i = 0;i<4;++i)
>        {
>            v_calories << expr(*this,x[i]*_calories[i]);
>            v_chocolate << expr(*this,x[i]*_chocolate[i]);
>            v_fat << expr(*this,x[i]*_fat[i]);
>            v_sugar << expr(*this,x[i]*_sugar[i]);
>            v_costs << expr(*this,x[i]*_price[i]);
>        }
>        rel(*this,expr(*this,sum(v_calories)),FRT_GQ,limits[0]);
>        rel(*this,expr(*this,sum(v_chocolate)),FRT_GQ,limits[1]);
>        rel(*this,expr(*this,sum(v_sugar)),FRT_GQ,limits[2]);
>        rel(*this,expr(*this,sum(v_fat)),FRT_GQ,limits[3]);
>        t_cost = expr(*this,sum(v_costs));
> 
>        branch(*this, x, FLOAT_VAR_NONE(), FLOAT_VAL_SPLIT_MIN());
> 
>    }
> 
>    // Prfloat solution
>    virtual void
>    prfloat(std::ostream& os) const {
>        os << "\t" << x << " t_cost: " << t_cost << std::endl;
>    }
> 
>    virtual FloatVar cost(void) const{
>        return t_cost;
>    }
> 
>    Tests(bool share, Tests& s) : FloatMinimizeScript(share,s) {
>        x.update(*this, share, s.x);
>        t_cost.update(*this, share, s.t_cost);
>    }
> 
>    virtual Space*
>    copy(bool share) {
>        return new Tests(share,*this);
>    }
> };
> 
> 
> float main(float argc, char* argv[]) {
> 
>    Options opt("Test");
>    opt.solutions(1e9);
>    //opt.threads(8);
>    FloatMinimizeScript::run<Tests,BAB,Options>(opt);
>    return 0;
> }
> 
> 
> -----Message d'origine-----
> De : users-bounces at gecode.org [mailto:users-bounces at gecode.org] De la part
> de Sebastien Delmotte
> Envoy? : mardi 20 septembre 2016 10:37
> ? : cschulte at kth.se
> Cc : users at gecode.org
> Objet : Re: [gecode-users] Cost optimization problem
> 
> Dear Christian,
> 
> I've tried to play with the step value but it doesn't change anything. An
> exception related to an unassigned variable (cost) still occurs and it
> prevents the search to be processed. I really don't understand why it works
> with exactly the same code with floats converted to integers, but I surely
> don't use correctly the gecode options. 
> 
> I think I will continue with integers for the moment.
> 
> Thank you very much.
> 
> S. D.
> 
> -----Message d'origine-----
> De : Christian Schulte [mailto:cschulte at kth.se] Envoy? : vendredi 16
> septembre 2016 13:18 ? : 'Sebastien Delmotte'; users at gecode.org Objet : RE:
> [gecode-users] Cost optimization problem
> 
> Hi,
> 
> That's strange... Did you try to play with the step value as explained in
> MPG 7.3?
> 
> Cheers
> Christian
> 
> --
> Christian Schulte, www.gecode.org/~schulte Professor of Computer Science,
> KTH, cschulte at kth.se Expert Researcher, SICS, cschulte at sics.se
> 
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
> Of Sebastien Delmotte
> Sent: Friday, September 16, 2016 13:08
> To: cschulte at kth.se; users at gecode.org
> Subject: Re: [gecode-users] Cost optimization problem
> 
> Dear Christian,
> 
> Thank you for your answer.
> 
> When I transform all the code from float variables to integer variables (in
> changing the constraints from 1 to 100 for example), that works perfectly.
> So maybe my implementation for float variables is not good. I will try to
> find why.
> 
> Best regards,
> 
> SD
> 
> -----Message d'origine-----
> De : Christian Schulte [mailto:cschulte at kth.se] Envoy? : jeudi 15 septembre
> 2016 17:03 ? : 'Sebastien Delmotte'; users at gecode.org Objet : RE:
> [gecode-users] Cost optimization problem
> 
> Hi,
> 
> Sorry but I think this is really a modelling issue and not a Gecode issue,
> as you have already figured out 3).
> 
> Cheers
> Christian
> 
> --
> Christian Schulte, www.gecode.org/~schulte Professor of Computer Science,
> KTH, cschulte at kth.se Expert Researcher, SICS, cschulte at sics.se
> 
> 
> -----Original Message-----
> From: users-bounces at gecode.org [mailto:users-bounces at gecode.org] On Behalf
> Of Sebastien Delmotte
> Sent: Tuesday, September 13, 2016 14:55
> To: users at gecode.org
> Subject: [gecode-users] Cost optimization problem
> 
> Dear All,
> 
> I have a problem with using Gecode to solve an optimization problem.
> 
> Problem description:
> - I have a recipe with two sub-components. Each component has a coefficient
> corresponding to its amount in the recipe. So the sum of the sub-components
> coefficients must be equal to 1;
> - Each of the two sub-components is composed of several raw materials. Each
> raw material has a coefficient corresponding to its amount in its
> sub-component. So, for each sub-component, the sum of the raw materials
> coefficients is equal to 1;
> - At the recipe level, I have some constraints on the raw materials amount
> (e.g. raw material 1 must be in a given interval). The amount of each raw
> material in the recipe is equal to the product of the coefficient of this
> raw material by the coefficient of its sub-component
> - I have to minimize the cost of the recipe accounting for the cost of each
> raw materials. This cost is equal to the sum of the product of each raw
> material coefficient by its unit cost.
> 
> Code
> 
> #include <gecode/driver.hh>
> #include <gecode/int.hh>
> #include <gecode/minimodel.hh>
> using namespace Gecode;
> class Tests : public FloatMinimizeScript  {
> protected:
>     FloatVarArray _rms_in_sub_c_1; // raw mat in sub-comp1
>     FloatVarArray _rms_in_sub_c_2; // raw mat in sub-comp2
>     FloatVarArray _sub_c; // 2 sub-comp
>     FloatVar _cost; // cost
> public:
>     Tests(const Options& o)
> :FloatMinimizeScript(o),_rms_in_sub_c_1(*this,4,0,1),_rms_in_sub_c_2(*this,3
> ,0,1),_sub_c(*this,2,0,1),_cost(*this,0,1000)
>     {
> //sum of raw mat in sub-comp =1
> FloatVar all_rms_sub1 = expr(*this,sum(_rms_in_sub_c_1));
> rel(*this,all_rms_sub1 ,FRT_EQ,1);
> FloatVar all_rms_sub2 = expr(*this,sum(_rms_in_sub_c_2));
> rel(*this,all_rms_sub2 ,FRT_EQ,1);
> // sum of sub-comp =1
> FloatVar sm = expr(*this,sum(_sub_c));
> rel(*this,sm ,FRT_EQ,1);
> // Global constraints on raw mat in recipe FloatVar rm_0_sub_coef1=
> expr(*this,_rms_in_sub_c_1[0]*_sub_c[0]);
> rel(*this,rm_0_sub_coef1,FRT_GQ,0);
> FloatVar rm_1_sub_coef1= expr(*this,_rms_in_sub_c_1[1]*_sub_c[0]);
> rel(*this,rm_1_sub_coef1,FRT_GQ,0);
> FloatVar rm_2_sub_coef1= expr(*this,_rms_in_sub_c_1[2]*_sub_c[0]);
> rel(*this,rm_2_sub_coef1,FRT_GQ,0);
> FloatVar rm_3_sub_coef1= expr(*this,_rms_in_sub_c_1[3]*_sub_c[0]);
> rel(*this,rm_3_sub_coef1,FRT_GQ,0);
> FloatVar rm_0_sub_coef2= expr(*this,_rms_in_sub_c_2[0]*_sub_c[1]);
> rel(*this,rm_0_sub_coef2,FRT_GQ,0);
> FloatVar rm_1_sub_coef2= expr(*this,_rms_in_sub_c_2[1]*_sub_c[1]);
> rel(*this,rm_1_sub_coef2,FRT_GQ,0);
> FloatVar rm_2_sub_coef2= expr(*this,_rms_in_sub_c_2[2]*_sub_c[1]);
> rel(*this,rm_2_sub_coef2,FRT_GQ,0);
> 
> // Cost
> _cost = expr(*this,_sub_c[0]*(_rms_in_sub_c_1[0]*12 +_rms_in_sub_c_1[1]*14 +
> _rms_in_sub_c_1[2] * 22 +_rms_in_sub_c_1[3] * 17 )
> +_sub_c[1]*(_rms_in_sub_c_2[0]*9 +_rms_in_sub_c_2[1]*2 + 
> +_rms_in_sub_c_2[2]
> * 18 ));
> FloatVarArgs all;
> for(int i = 0; i <4; i++) all << _rms_in_sub_c_1[i]; for(int i = 0; i <3;
> i++) all << _rms_in_sub_c_2[i]; for(int i = 0; i <2; i++) all << 
> i++_sub_c[i];
> 
> branch(*this, all, FLOAT_VAR_NONE(), FLOAT_VAL_SPLIT_MIN());
>     }
> 
> virtual void
> print(std::ostream& os) const {
> os << "sub-component : " << _sub_c << "\nrms 1 : "<< _rms_in_sub_c_1<<
> "\nrms2 : "<< _rms_in_sub_c_2 <<"\ncost : "<< _cost << std::endl;
>     }
> 
> virtual FloatVar cost(void) const{
> return _cost;
>     }
> Tests(bool share, Tests& s) : FloatMinimizeScript(share,s) { _sub_c.update
> (*this, share, s._sub_c); _rms_in_sub_c_1.update(*this, share,
> s._rms_in_sub_c_1); _rms_in_sub_c_2.update(*this, share, s._rms_in_sub_c_2);
> _cost.update(*this, share, s._cost);
>     }
> 
> virtual Space*
> copy(bool share) {
> return new Tests(share,*this);
>     }
> };
> int main(int argc, char* argv[]) {
> Options opt("Test");
> opt.solutions(0);
> FloatMinimizeScript::run<Tests,BAB,Options>(opt);
> return 0;
> }
> 
> When executing this code, the result is :
> sub-component : {0, 1}
> rms in sub-component 1 : {0, 0, 0, 1}
> rms in sub-component 2 : {0, 0, 1}
> cost : [18..18]
> 
> Exception: FloatVar::val: Attempt to access value of unassigned variable.
> 
> Problems:
> 1- The resulting solution is trivial but absolutely not optimal for the
> cost: only the second sub-component has a positive coefficient (=1) with
> only one raw material which is not the cheapest one;
> 2- In this example, all the constraints for the raw materials are: greater
> than 0. But if I change the value of the constraints (e.g. greater than
> 0.1), I don't get any solution;
> 3- There is an exception error: FloatVar::val: Attempt to access value of
> unassigned variable. This error disappears when I add the variable cost in
> the branching, but the solution is still non optimal.
> 
> I think I have a problem with handling gecode because the problem is simple,
> but I have no idea about the origin of the problem. 
> With many thanks in advance.
> Best regards,
> S.D.
> 
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users
> 
> 
> _______________________________________________
> Gecode users mailing list
> users at gecode.org
> https://www.gecode.org/mailman/listinfo/gecode-users

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.gecode.org/pipermail/users/attachments/20160923/f6cf2d50/attachment-0001.html>

