<tt>
Dear&nbsp;all,&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;implement&nbsp;something&nbsp;which&nbsp;at&nbsp;a&nbsp;first&nbsp;sight&nbsp;could&nbsp;look&nbsp;weird&nbsp;and&nbsp;have&nbsp;a&nbsp;memory&nbsp;problem,&nbsp;I&nbsp;will&nbsp;try&nbsp;to&nbsp;be&nbsp;as&nbsp;concise&nbsp;as&nbsp;possible&nbsp;while&nbsp;giving&nbsp;enough&nbsp;details&nbsp;to&nbsp;have&nbsp;some&nbsp;help&nbsp;from&nbsp;you;&nbsp;if&nbsp;you&nbsp;need&nbsp;to&nbsp;know&nbsp;more,&nbsp;I&nbsp;don&amp;#39;t&nbsp;have&nbsp;any&nbsp;problem&nbsp;to&nbsp;explain&nbsp;my&nbsp;situation&nbsp;in&nbsp;a&nbsp;deeper&nbsp;way.&lt;br&gt;<br>
&lt;br&gt;I&nbsp;have&nbsp;some&nbsp;data&nbsp;structures&nbsp;which&nbsp;are&nbsp;external&nbsp;to&nbsp;propagators&nbsp;but&nbsp;that&nbsp;I&nbsp;need&nbsp;to&nbsp;share&nbsp;among&nbsp;computation&nbsp;spaces.&nbsp;Still,&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;have&nbsp;this&nbsp;data&nbsp;structures&nbsp;allocated&nbsp;in&nbsp;some&nbsp;way&nbsp;by&nbsp;gecode&nbsp;itself&nbsp;and&nbsp;not&nbsp;from&nbsp;using&nbsp;new&nbsp;(malloc).&nbsp;Let&amp;#39;s&nbsp;have&nbsp;a&nbsp;look&nbsp;at&nbsp;the&nbsp;following&nbsp;example&nbsp;of&nbsp;a&nbsp;main&nbsp;program&nbsp;creating&nbsp;some&nbsp;instances&nbsp;of&nbsp;Space:&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt; opt.parse(argc,argv);&lt;br&gt; Space&nbsp;*sp&nbsp;=&nbsp;new&nbsp;Simple(opt);&lt;br&gt; sp-&amp;gt;status();&lt;br&gt; Space&nbsp;*csp&nbsp;=&nbsp;sp-&amp;gt;clone(true);&lt;br&gt; csp-&amp;gt;status();&lt;br&gt; //delete&nbsp;sp;&lt;br&gt; Space&nbsp;*csp2&nbsp;=&nbsp;csp-&amp;gt;clone(true);&lt;br&gt; &lt;br&gt;&lt;br&gt;Just&nbsp;assume&nbsp;that&nbsp;there&nbsp;are&nbsp;no&nbsp;propagators&nbsp;posted&nbsp;during&nbsp;the&nbsp;construction&nbsp;of&nbsp;Simple,&nbsp;just&nbsp;a&nbsp;branching.&nbsp;Now,&nbsp;If&nbsp;I&nbsp;am&nbsp;right,&nbsp;by&nbsp;sending&nbsp;true&nbsp;to&nbsp;clone&nbsp;will&nbsp;cause&nbsp;the&nbsp;data&nbsp;structures&nbsp;(variables,&nbsp;etc)&nbsp;to&nbsp;be&nbsp;shared.&nbsp;Then&nbsp;csp&nbsp;will&nbsp;share&nbsp;data&nbsp;structures&nbsp;with&nbsp;sp.&nbsp;Now,&nbsp;I&nbsp;am&nbsp;considering&nbsp;to&nbsp;clone&nbsp;(and&nbsp;share&nbsp;again&nbsp;the&nbsp;data&nbsp;structures)&nbsp;csp&nbsp;into&nbsp;csp2.&nbsp;If&nbsp;at&nbsp;some&nbsp;point,&nbsp;I&nbsp;decided&nbsp;to&nbsp;delete&nbsp;sp&nbsp;I&nbsp;will&nbsp;get&nbsp;a&nbsp;memory&nbsp;problem,&nbsp;this&nbsp;is,&nbsp;there&nbsp;are&nbsp;data&nbsp;structures&nbsp;inside&nbsp;csp2&nbsp;that&nbsp;are&nbsp;supposed&nbsp;to&nbsp;*point*&nbsp;to&nbsp;something&nbsp;that&nbsp;where&nbsp;in&nbsp;sp&nbsp;but&nbsp;now&nbsp;is&nbsp;deallocated.&lt;br&gt;<br>
&lt;br&gt;I&nbsp;am&nbsp;using&nbsp;the&nbsp;space&nbsp;allocator&nbsp;to&nbsp;allocate&nbsp;the&nbsp;data&nbsp;structures,&nbsp;so&nbsp;I&nbsp;think&nbsp;that&nbsp;a&nbsp;space&nbsp;is&nbsp;deallocated&nbsp;by&nbsp;removing&nbsp;its&nbsp;complete&nbsp;heap&nbsp;from&nbsp;memory.&nbsp;If&nbsp;I&nbsp;understand&nbsp;correctly,&nbsp;there&nbsp;is&nbsp;a&nbsp;one&nbsp;to&nbsp;one&nbsp;relation&nbsp;between&nbsp;a&nbsp;space&nbsp;and&nbsp;a&nbsp;space&nbsp;heap.&nbsp;In&nbsp;my&nbsp;case,&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;allocate&nbsp;the&nbsp;data&nbsp;structures&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;such&nbsp;a&nbsp;way&nbsp;that&nbsp;those&nbsp;are&nbsp;no&nbsp;removed&nbsp;when&nbsp;spaces&nbsp;are&nbsp;deallocated.&nbsp;Is&nbsp;it&nbsp;possible&nbsp;to&nbsp;do&nbsp;that&nbsp;in&nbsp;gecode?,&nbsp;is&nbsp;there&nbsp;some&nbsp;&amp;quot;general&nbsp;heap&amp;quot;&nbsp;from&nbsp;which&nbsp;I&nbsp;can&nbsp;allocate&nbsp;memory&nbsp;from?,&nbsp;if&nbsp;yes,&nbsp;is&nbsp;there&nbsp;an&nbsp;allocator&nbsp;to&nbsp;allocate&nbsp;memory&nbsp;from&nbsp;this&nbsp;part?.&lt;br&gt;<br>
&lt;br&gt;I&nbsp;would&nbsp;like&nbsp;the&nbsp;memory&nbsp;to&nbsp;be&nbsp;allocated&nbsp;by&nbsp;gecode&nbsp;because&nbsp;in&nbsp;that&nbsp;way&nbsp;(I&nbsp;think)&nbsp;it&nbsp;will&nbsp;be&nbsp;reported&nbsp;as&nbsp;part&nbsp;of&nbsp;the&nbsp;statistics&nbsp;when&nbsp;running&nbsp;a&nbsp;search&nbsp;engine.&nbsp;Also,&nbsp;the&nbsp;data&nbsp;structures&nbsp;I&nbsp;am&nbsp;using&nbsp;use&nbsp;reference&nbsp;counting&nbsp;for&nbsp;the&nbsp;memory&nbsp;management&nbsp;but&nbsp;are&nbsp;not&nbsp;thread&nbsp;safe&nbsp;so&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;know&nbsp;how&nbsp;this&nbsp;would&nbsp;interact&nbsp;with&nbsp;parallel&nbsp;search&nbsp;engines.&nbsp;I&nbsp;don&amp;#39;t&nbsp;want&nbsp;to&nbsp;cause&nbsp;any&nbsp;heap&nbsp;segmentation&nbsp;(I&nbsp;am&nbsp;not&nbsp;sure&nbsp;how&nbsp;much&nbsp;sensible&nbsp;is&nbsp;gecode&nbsp;to&nbsp;memory&nbsp;alignment &nbsp;in&nbsp;its&nbsp;heap&nbsp;and&nbsp;things&nbsp;like&nbsp;that)&nbsp;that&nbsp;severely&nbsp;affects&nbsp;gecode&nbsp;performance.&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;Any&nbsp;comment&nbsp;is&nbsp;more&nbsp;than&nbsp;welcome&nbsp;and&nbsp;thanks&nbsp;in&nbsp;advance.&lt;br&gt;&lt;br&gt;Gustavo &nbsp;&lt;br&gt;&lt;br&gt;<br>

</tt>
